(function(){var e={9647:function(e,t,n){"use strict";var i=n(8534),r=n(9584),o=(n(6992),n(8674),n(9601),n(7727),n(5666),n(1539),n(7922),n(8783),n(3948),n(1703),n(9963)),a=n(6252);function s(e,t,n,i,r,o){var s=(0,a.up)("StandardLayout"),c=(0,a.up)("GameDialog"),u=(0,a.up)("ResearchDialog"),l=(0,a.up)("USIEngineManagementDialog"),d=(0,a.up)("AppSettingDialog"),p=(0,a.up)("PasteDialog"),h=(0,a.up)("BussyMessage"),f=(0,a.up)("ConfirmDialog"),m=(0,a.up)("InfoMessage"),v=(0,a.up)("ErrorMessage");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(s,{class:"main"}),e.dialogVisibilities.game?((0,a.wg)(),(0,a.j4)(c,{key:0})):(0,a.kq)("",!0),e.dialogVisibilities.research?((0,a.wg)(),(0,a.j4)(u,{key:1})):(0,a.kq)("",!0),e.dialogVisibilities.usiEngineSetting?((0,a.wg)(),(0,a.j4)(l,{key:2})):(0,a.kq)("",!0),e.dialogVisibilities.appSetting?((0,a.wg)(),(0,a.j4)(d,{key:3})):(0,a.kq)("",!0),e.dialogVisibilities.paste?((0,a.wg)(),(0,a.j4)(p,{key:4})):(0,a.kq)("",!0),e.dialogVisibilities.bussy?((0,a.wg)(),(0,a.j4)(h,{key:5})):(0,a.kq)("",!0),e.dialogVisibilities.confirm?((0,a.wg)(),(0,a.j4)(f,{key:6})):(0,a.kq)("",!0),e.hasMessage?((0,a.wg)(),(0,a.j4)(m,{key:7})):(0,a.kq)("",!0),e.hasErrors?((0,a.wg)(),(0,a.j4)(v,{key:8})):(0,a.kq)("",!0)],64)}n(4363),n(9653);var c={class:"main"},u={ref:"topPane",class:"top-pane"};function l(e,t,n,i,r,o){var s=(0,a.up)("BoardPane"),l=(0,a.up)("RecordPane"),d=(0,a.up)("InformationPane");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",c,[(0,a._)("div",u,[(0,a.Wm)(s,{class:"top-left-pane","max-size":e.boardPaneMaxSize},null,8,["max-size"]),(0,a.Wm)(l,{class:"top-right-pane"})],512),(0,a.Wm)(d,{class:"bottom-pane",size:e.bottomPaneSize},null,8,["size"])])])}var d=n(2262),p={class:"control top"},h=(0,a.Uk)(" 対局 "),f=(0,a.Uk)(" 中断 "),m=(0,a.Uk)(" 投了 "),v=(0,a.Uk)(" 検討 "),_=(0,a.Uk)(" 検討終了 "),g=(0,a.Uk)(" 局面編集 "),E=(0,a.Uk)(" 局面編集終了 "),S=(0,a.Uk)(" 手番変更 "),w={class:"control bottom"},I=["disabled"],T=(0,a.Uk)(" アプリ設定 "),R=["disabled"],O=(0,a.Uk)(" エンジン設定 "),A=(0,a.Uk)(" 盤面反転 "),y=["disabled"],N=(0,a.Uk)(" 棋譜貼り付け "),k=(0,a.Uk)(" 棋譜コピー "),b=["disabled"],P=(0,a.Uk)(" 指し手削除 ");function H(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon"),c=(0,a.up)("BoardView");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(c,{"piece-image-type":e.pieceImageType,"board-image-type":e.boardImageType,"max-size":e.maxSize,position:e.position,"last-move":e.lastMove,flip:e.flip,"allow-move":e.allowMove,"allow-edit":e.allowEdit,"black-player-name":e.blackPlayerName,"white-player-name":e.whitePlayerName,"black-player-time-ms":e.blackPlayerTimeMs,"black-player-byoyomi":e.blackPlayerByoyomi,"white-player-time-ms":e.whitePlayerTimeMs,"white-player-byoyomi":e.whitePlayerByoyomi,onMove:e.onMove,onEdit:e.onEdit},{"right-control":(0,a.w5)((function(){return[(0,a._)("div",p,[e.controlStates.game?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t[0]||(t[0]=function(){return e.onGame&&e.onGame.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"game"}),h])):(0,a.kq)("",!0),e.controlStates.stop?((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:t[1]||(t[1]=function(){return e.onStop&&e.onStop.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"stop"}),f])):(0,a.kq)("",!0),e.controlStates.resign?((0,a.wg)(),(0,a.iD)("button",{key:2,onClick:t[2]||(t[2]=function(){return e.onResign&&e.onResign.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"resign"}),m])):(0,a.kq)("",!0),e.controlStates.research?((0,a.wg)(),(0,a.iD)("button",{key:3,onClick:t[3]||(t[3]=function(){return e.onResearch&&e.onResearch.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"research"}),v])):(0,a.kq)("",!0),e.controlStates.endResearch?((0,a.wg)(),(0,a.iD)("button",{key:4,onClick:t[4]||(t[4]=function(){return e.onEndResearch&&e.onEndResearch.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"end"}),_])):(0,a.kq)("",!0),e.controlStates.startEditPosition?((0,a.wg)(),(0,a.iD)("button",{key:5,onClick:t[5]||(t[5]=function(){return e.onStartEditPosition&&e.onStartEditPosition.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"edit"}),g])):(0,a.kq)("",!0),e.controlStates.endEditPosition?((0,a.wg)(),(0,a.iD)("button",{key:6,onClick:t[6]||(t[6]=function(){return e.onEndEditPosition&&e.onEndEditPosition.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"check"}),E])):(0,a.kq)("",!0),e.controlStates.initPosition?((0,a.wg)(),(0,a.iD)("button",{key:7,onClick:t[7]||(t[7]=function(){return e.onChangeTurn&&e.onChangeTurn.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"swap"}),S])):(0,a.kq)("",!0),e.controlStates.initPosition?((0,a.wg)(),(0,a.iD)("button",{key:8,onClick:t[8]||(t[8]=function(){return e.onInitPositionStandard&&e.onInitPositionStandard.apply(e,arguments)})}," 平手 ")):(0,a.kq)("",!0),e.controlStates.initPosition?((0,a.wg)(),(0,a.iD)("button",{key:9,onClick:t[9]||(t[9]=function(){return e.onInitPositionTsumeShogi&&e.onInitPositionTsumeShogi.apply(e,arguments)})}," 詰将棋 ")):(0,a.kq)("",!0)])]})),"left-control":(0,a.w5)((function(){return[(0,a._)("div",w,[(0,a._)("button",{disabled:!e.controlStates.appSettings,onClick:t[10]||(t[10]=function(){return e.onOpenAppSettings&&e.onOpenAppSettings.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"settings"}),T],8,I),(0,a._)("button",{disabled:!e.controlStates.engineSettings,onClick:t[11]||(t[11]=function(){return e.onOpenEngineSettings&&e.onOpenEngineSettings.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"engineSettings"}),O],8,R),(0,a._)("button",{onClick:t[12]||(t[12]=function(){return e.onFlip&&e.onFlip.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"flip"}),A]),(0,a._)("button",{disabled:!e.controlStates.paste,onClick:t[13]||(t[13]=function(){return e.onPaste&&e.onPaste.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"paste"}),N],8,y),(0,a._)("button",{onClick:t[14]||(t[14]=function(){return e.onCopy&&e.onCopy.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"copy"}),k]),(0,a._)("button",{disabled:!e.controlStates.removeAfter,onClick:t[15]||(t[15]=function(){return e.onRemoveAfter&&e.onRemoveAfter.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"delete"}),P],8,b)])]})),_:1},8,["piece-image-type","board-image-type","max-size","position","last-move","flip","allow-move","allow-edit","black-player-name","white-player-name","black-player-time-ms","black-player-byoyomi","white-player-time-ms","white-player-byoyomi","onMove","onEdit"])])}var C=n(3577),D=["src"],L={class:"player-name-text"},M={class:"clock-text"},x={class:"player-name-text"},G={class:"clock-text"},B=["src"],Z=["onClick","onContextmenu"],U=["src"],W=["onClick"],K=["src"],F=["onClick"],q=["src"],V=["src"];function Y(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",{class:"frame",style:(0,C.j5)(e.layout.frame.style),onClick:t[2]||(t[2]=function(t){return e.clickFrame()})},[(0,a._)("div",{class:"board",style:(0,C.j5)(e.layout.board.style)},[(0,a._)("img",{class:"board-image",src:e.layout.board.imagePath},null,8,D)],4),(0,a._)("div",{class:(0,C.C_)(["player-name",{active:"black"==e.position.color}]),style:(0,C.j5)(e.layout.blackPlayerName.style)},[(0,a._)("span",L,"▲"+(0,C.zw)(e.blackPlayerName),1)],6),(0,a._)("div",{class:(0,C.C_)(["clock",e.blackPlayerTimeSeverity]),style:(0,C.j5)(e.layout.blackClock.style)},[(0,a._)("span",M,(0,C.zw)(e.blackPlayerTimeText),1)],6),(0,a._)("div",{class:(0,C.C_)(["player-name",{active:"white"==e.position.color}]),style:(0,C.j5)(e.layout.whitePlayerName.style)},[(0,a._)("span",x,"△"+(0,C.zw)(e.whitePlayerName),1)],6),(0,a._)("div",{class:(0,C.C_)(["clock",e.whitePlayerTimeSeverity]),style:(0,C.j5)(e.layout.whiteClock.style)},[(0,a._)("span",G,(0,C.zw)(e.whitePlayerTimeText),1)],6),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.square,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"square",style:(0,C.j5)(e.backgroundStyle)},null,4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.piece,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"piece",style:(0,C.j5)(e.style)},[(0,a._)("img",{class:"piece-image",src:e.imagePath},null,8,B)],4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.square,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.id,class:"square",style:(0,C.j5)(t.style),onClick:function(n){return e.clickSquare(n,t.file,t.rank)},onContextmenu:function(n){return e.clickSquareR(n,t.file,t.rank)}},null,44,Z)})),128)),(0,a._)("div",{class:"hand",style:(0,C.j5)(e.layout.blackHand.style)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.blackHand.pointers,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"hand-pointer",style:(0,C.j5)(e.backgroundStyle)},null,4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.blackHand.pieces,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"piece",style:(0,C.j5)(e.style)},[(0,a._)("img",{class:"piece-image",src:e.imagePath},null,8,U)],4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.blackHand.pointers,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.id,class:"hand-pointer",style:(0,C.j5)(t.style),onClick:function(n){return e.clickHand(n,"black",t.type)}},null,12,W)})),128))],4),(0,a._)("div",{class:"hand",style:(0,C.j5)(e.layout.whiteHand.style)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.whiteHand.pointers,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"hand-pointer",style:(0,C.j5)(e.backgroundStyle)},null,4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.whiteHand.pieces,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"piece",style:(0,C.j5)(e.style)},[(0,a._)("img",{class:"piece-image",src:e.imagePath},null,8,K)],4)})),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.layout.whiteHand.pointers,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.id,class:"hand-pointer",style:(0,C.j5)(t.style),onClick:function(n){return e.clickHand(n,"white",t.type)}},null,12,F)})),128))],4),e.layout.promotion?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"promotion-selector",style:(0,C.j5)(e.layout.promotion.style)},[(0,a._)("div",{class:"select-button promote",onClick:t[0]||(t[0]=function(t){return e.clickPromote(t)})},[(0,a._)("img",{class:"piece-image",src:e.layout.promotion.promoteImagePath},null,8,q)]),(0,a._)("div",{class:"select-button not-promote",onClick:t[1]||(t[1]=function(t){return e.clickNotPromote(t)})},[(0,a._)("img",{class:"piece-image",src:e.layout.promotion.notPromoteImagePath},null,8,V)])],4)):(0,a.kq)("",!0),(0,a._)("div",{class:"turn",style:(0,C.j5)(e.layout.turn.style)},"手番",4),(0,a._)("div",{style:(0,C.j5)(e.layout.control.left.style)},[(0,a.WI)(e.$slots,"left-control",{},void 0,!0)],4),(0,a._)("div",{style:(0,C.j5)(e.layout.control.right.style)},[(0,a.WI)(e.$slots,"right-control",{},void 0,!0)],4)],4)])}n(7686),n(4506);var j,z,J=n(5082),$=n(3087),X=n(2833),Q=n(2482);n(4747),n(2479),n(1532);function ee(e){return e===j.BLACK?j.WHITE:j.BLACK}function te(e){return e===j.BLACK?"b":"w"}function ne(e){return"b"===e||"w"===e}function ie(e){return"b"===e?j.BLACK:j.WHITE}(function(e){e["BLACK"]="black",e["WHITE"]="white"})(j||(j={})),function(e){e["PAWN"]="pawn",e["LANCE"]="lance",e["KNIGHT"]="knight",e["SILVER"]="silver",e["GOLD"]="gold",e["BISHOP"]="bishop",e["ROOK"]="rook",e["KING"]="king",e["PROM_PAWN"]="promPawn",e["PROM_LANCE"]="promLance",e["PROM_KNIGHT"]="promKnight",e["PROM_SILVER"]="promSilver",e["HORSE"]="horse",e["DRAGON"]="dragon"}(z||(z={}));var re={pawn:"歩",lance:"香",knight:"桂",silver:"銀",gold:"金",bishop:"角",rook:"飛",king:"玉",promPawn:"と",promLance:"成香",promKnight:"成桂",promSilver:"成銀",horse:"馬",dragon:"竜"};function oe(e){var t=re[e];return t||""}z.PAWN,z.LANCE,z.KNIGHT,z.SILVER,z.GOLD,z.BISHOP,z.ROOK,z.KING,z.PROM_PAWN,z.PROM_LANCE,z.PROM_KNIGHT,z.PROM_SILVER,z.HORSE,z.DRAGON;var ae=[z.PAWN,z.LANCE,z.KNIGHT,z.SILVER,z.GOLD,z.BISHOP,z.ROOK],se={pawn:!0,lance:!0,knight:!0,silver:!0,gold:!1,bishop:!0,rook:!0,king:!1,promPawn:!1,promLance:!1,promKnight:!1,promSilver:!1,horse:!1,dragon:!1},ce={pawn:z.PROM_PAWN,lance:z.PROM_LANCE,knight:z.PROM_KNIGHT,silver:z.PROM_SILVER,bishop:z.HORSE,rook:z.DRAGON},ue={promPawn:z.PAWN,promLance:z.LANCE,promKnight:z.KNIGHT,promSilver:z.SILVER,horse:z.BISHOP,dragon:z.ROOK},le={pawn:"P",lance:"L",knight:"N",silver:"S",gold:"G",bishop:"B",rook:"R",king:"K",promPawn:"+P",promLance:"+L",promKnight:"+N",promSilver:"+S",horse:"+B",dragon:"+R"};function de(e){return le[e]}var pe={pawn:"p",lance:"l",knight:"n",silver:"s",gold:"g",bishop:"b",rook:"r",king:"k",promPawn:"+p",promLance:"+l",promKnight:"+n",promSilver:"+s",horse:"+b",dragon:"+r"},he={P:z.PAWN,L:z.LANCE,N:z.KNIGHT,S:z.SILVER,G:z.GOLD,B:z.BISHOP,R:z.ROOK,K:z.KING,"+P":z.PROM_PAWN,"+L":z.PROM_LANCE,"+N":z.PROM_KNIGHT,"+S":z.PROM_SILVER,"+B":z.HORSE,"+R":z.DRAGON,p:z.PAWN,l:z.LANCE,n:z.KNIGHT,s:z.SILVER,g:z.GOLD,b:z.BISHOP,r:z.ROOK,k:z.KING,"+p":z.PROM_PAWN,"+l":z.PROM_LANCE,"+n":z.PROM_KNIGHT,"+s":z.PROM_SILVER,"+b":z.HORSE,"+r":z.DRAGON},fe={P:j.BLACK,L:j.BLACK,N:j.BLACK,S:j.BLACK,G:j.BLACK,B:j.BLACK,R:j.BLACK,K:j.BLACK,"+P":j.BLACK,"+L":j.BLACK,"+N":j.BLACK,"+S":j.BLACK,"+B":j.BLACK,"+R":j.BLACK,p:j.WHITE,l:j.WHITE,n:j.WHITE,s:j.WHITE,g:j.WHITE,b:j.WHITE,r:j.WHITE,k:j.WHITE,"+p":j.WHITE,"+l":j.WHITE,"+n":j.WHITE,"+s":j.WHITE,"+b":j.WHITE,"+r":j.WHITE},me=new Map;me.set(z.PAWN,{type:z.PROM_PAWN,reverseColor:!1}),me.set(z.LANCE,{type:z.PROM_LANCE,reverseColor:!1}),me.set(z.KNIGHT,{type:z.PROM_KNIGHT,reverseColor:!1}),me.set(z.SILVER,{type:z.PROM_SILVER,reverseColor:!1}),me.set(z.GOLD,{type:z.GOLD,reverseColor:!0}),me.set(z.BISHOP,{type:z.HORSE,reverseColor:!1}),me.set(z.ROOK,{type:z.DRAGON,reverseColor:!1}),me.set(z.KING,{type:z.KING,reverseColor:!0}),me.set(z.PROM_PAWN,{type:z.PAWN,reverseColor:!0}),me.set(z.PROM_LANCE,{type:z.LANCE,reverseColor:!0}),me.set(z.PROM_KNIGHT,{type:z.KNIGHT,reverseColor:!0}),me.set(z.PROM_SILVER,{type:z.SILVER,reverseColor:!0}),me.set(z.HORSE,{type:z.BISHOP,reverseColor:!0}),me.set(z.DRAGON,{type:z.ROOK,reverseColor:!0});var ve,_e=function(){function e(t,n){(0,$.Z)(this,e),(0,Q.Z)(this,"color",void 0),(0,Q.Z)(this,"type",void 0),this.type=n,this.color=t}return(0,X.Z)(e,[{key:"black",value:function(){return this.withColor(j.BLACK)}},{key:"white",value:function(){return this.withColor(j.WHITE)}},{key:"withColor",value:function(t){return new e(t,this.type)}},{key:"equals",value:function(e){return this.type===e.type&&this.color===e.color}},{key:"promoted",value:function(){var t=ce[this.type];return new e(this.color,t||this.type)}},{key:"unpromoted",value:function(){var t=ue[this.type];return new e(this.color,t||this.type)}},{key:"isPromotable",value:function(){return!!se[this.type]}},{key:"rotate",value:function(){var t=me.get(this.type),n=new e(this.color,t?t.type:this.type);return t&&t.reverseColor&&(n.color=ee(this.color)),n}},{key:"id",get:function(){return this.color+"_"+this.type}},{key:"sfen",get:function(){switch(this.color){default:case j.BLACK:return le[this.type];case j.WHITE:return pe[this.type]}}}],[{key:"isValidSFEN",value:function(e){return!!he[e]}},{key:"newBySFEN",value:function(t){var n=he[t];if(!n)return null;var i=fe[t];return i?new e(i,n):null}}]),e}();n(3689),n(7941);(function(e){e["UP"]="up",e["DOWN"]="down",e["LEFT"]="left",e["RIGHT"]="right",e["LEFT_UP"]="left_up",e["RIGHT_UP"]="right_up",e["LEFT_DOWN"]="left_down",e["RIGHT_DOWN"]="right_down",e["LEFT_UP_KNIGHT"]="left_up_knight",e["RIGHT_UP_KNIGHT"]="right_up_knight",e["LEFT_DOWN_KNIGHT"]="left_down_knight",e["RIGHT_DOWN_KNIGHT"]="right_down_knight"})(ve||(ve={}));var ge={up:ve.DOWN,down:ve.UP,left:ve.RIGHT,right:ve.LEFT,left_up:ve.RIGHT_DOWN,right_up:ve.LEFT_DOWN,left_down:ve.RIGHT_UP,right_down:ve.LEFT_UP,left_up_knight:ve.RIGHT_DOWN_KNIGHT,right_up_knight:ve.LEFT_DOWN_KNIGHT,left_down_knight:ve.RIGHT_UP_KNIGHT,right_down_knight:ve.LEFT_UP_KNIGHT};function Ee(e){return ge[e]}var Se,we=[ve.UP,ve.DOWN,ve.LEFT,ve.RIGHT,ve.LEFT_UP,ve.RIGHT_UP,ve.LEFT_DOWN,ve.RIGHT_DOWN,ve.LEFT_UP_KNIGHT,ve.RIGHT_UP_KNIGHT,ve.LEFT_DOWN_KNIGHT,ve.RIGHT_DOWN_KNIGHT];(function(e){e["SHORT"]="short",e["LONG"]="long"})(Se||(Se={}));var Ie={black:{pawn:{up:Se.SHORT},lance:{up:Se.LONG},knight:{left_up_knight:Se.SHORT,right_up_knight:Se.SHORT},silver:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left_down:Se.SHORT,right_down:Se.SHORT},gold:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},bishop:{left_up:Se.LONG,right_up:Se.LONG,left_down:Se.LONG,right_down:Se.LONG},rook:{up:Se.LONG,left:Se.LONG,right:Se.LONG,down:Se.LONG},king:{left_down:Se.SHORT,right_down:Se.SHORT,left_up:Se.SHORT,right_up:Se.SHORT,down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},promPawn:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},promLance:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},promKnight:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},promSilver:{left_up:Se.SHORT,up:Se.SHORT,right_up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},horse:{left_up:Se.LONG,right_up:Se.LONG,left_down:Se.LONG,right_down:Se.LONG,up:Se.SHORT,left:Se.SHORT,right:Se.SHORT,down:Se.SHORT},dragon:{up:Se.LONG,left:Se.LONG,right:Se.LONG,down:Se.LONG,left_up:Se.SHORT,right_up:Se.SHORT,left_down:Se.SHORT,right_down:Se.SHORT}},white:{pawn:{down:Se.SHORT},lance:{down:Se.LONG},knight:{left_down_knight:Se.SHORT,right_down_knight:Se.SHORT},silver:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left_up:Se.SHORT,right_up:Se.SHORT},gold:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},bishop:{left_down:Se.LONG,right_down:Se.LONG,left_up:Se.LONG,right_up:Se.LONG},rook:{down:Se.LONG,left:Se.LONG,right:Se.LONG,up:Se.LONG},king:{left_down:Se.SHORT,right_down:Se.SHORT,left_up:Se.SHORT,right_up:Se.SHORT,down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},promPawn:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},promLance:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},promKnight:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},promSilver:{left_down:Se.SHORT,down:Se.SHORT,right_down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},horse:{left_down:Se.LONG,right_down:Se.LONG,left_up:Se.LONG,right_up:Se.LONG,down:Se.SHORT,left:Se.SHORT,right:Se.SHORT,up:Se.SHORT},dragon:{down:Se.LONG,left:Se.LONG,right:Se.LONG,up:Se.LONG,left_down:Se.SHORT,right_down:Se.SHORT,left_up:Se.SHORT,right_up:Se.SHORT}}};function Te(e){return Object.keys(Ie[e.color][e.type])}function Re(e,t){return Ie[e.color][e.type][t]}var Oe={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},left_up:{x:-1,y:-1},right_up:{x:1,y:-1},left_down:{x:-1,y:1},right_down:{x:1,y:1},left_up_knight:{x:-1,y:-2},right_up_knight:{x:1,y:-2},left_down_knight:{x:-1,y:2},right_down_knight:{x:1,y:2}};function Ae(e,t){if(1===e&&-2===t)return{direction:ve.RIGHT_UP_KNIGHT,distance:1,ok:!0};if(-1===e&&-2===t)return{direction:ve.LEFT_UP_KNIGHT,distance:1,ok:!0};if(1===e&&2===t)return{direction:ve.RIGHT_DOWN_KNIGHT,distance:1,ok:!0};if(-1===e&&2===t)return{direction:ve.LEFT_DOWN_KNIGHT,distance:1,ok:!0};if(0!==e&&0!==t&&Math.abs(e)!==Math.abs(t))return{direction:"",distance:0,ok:!1};var n=e,i=t,r=0;return 0!==n&&(r=Math.abs(n),n/=r),0!==i&&(r=Math.abs(i),i/=r),-1===n&&-1===i?{direction:ve.LEFT_UP,distance:r,ok:!0}:0===n&&-1===i?{direction:ve.UP,distance:r,ok:!0}:1===n&&-1===i?{direction:ve.RIGHT_UP,distance:r,ok:!0}:-1===n&&0===i?{direction:ve.LEFT,distance:r,ok:!0}:1===n&&0===i?{direction:ve.RIGHT,distance:r,ok:!0}:-1===n&&1===i?{direction:ve.LEFT_DOWN,distance:r,ok:!0}:0===n&&1===i?{direction:ve.DOWN,distance:r,ok:!0}:1===n&&1===i?{direction:ve.RIGHT_DOWN,distance:r,ok:!0}:{direction:"",distance:0,ok:!1}}function ye(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}function Ne(e){switch(e){case"a":return 1;case"b":return 2;case"c":return 3;case"d":return 4;case"e":return 5;case"f":return 6;case"g":return 7;case"h":return 8;case"i":return 9;default:return null}}var ke=["a","b","c","d","e","f","g","h","i"],be=function(){function e(t,n){(0,$.Z)(this,e),(0,Q.Z)(this,"file",void 0),(0,Q.Z)(this,"rank",void 0),this.file=t,this.rank=n}return(0,X.Z)(e,[{key:"x",get:function(){return 9-this.file}},{key:"y",get:function(){return this.rank-1}},{key:"index",get:function(){return 9*this.y+this.x}},{key:"opposite",get:function(){return new e(10-this.file,10-this.rank)}},{key:"neighbor",value:function(t,n){switch(t){case ve.UP:return new e(this.file,this.rank-1);case ve.DOWN:return new e(this.file,this.rank+1);case ve.LEFT:return new e(this.file+1,this.rank);case ve.RIGHT:return new e(this.file-1,this.rank);case ve.LEFT_UP:return new e(this.file+1,this.rank-1);case ve.RIGHT_UP:return new e(this.file-1,this.rank-1);case ve.LEFT_DOWN:return new e(this.file+1,this.rank+1);case ve.RIGHT_DOWN:return new e(this.file-1,this.rank+1);case ve.LEFT_UP_KNIGHT:return new e(this.file+1,this.rank-2);case ve.RIGHT_UP_KNIGHT:return new e(this.file-1,this.rank-2);case ve.LEFT_DOWN_KNIGHT:return new e(this.file+1,this.rank+2);case ve.RIGHT_DOWN_KNIGHT:return new e(this.file-1,this.rank+2)}var i=t,r=n;return new e(this.file-i,this.rank+r)}},{key:"valid",get:function(){return this.file>=1&&this.file<=9&&this.rank>=1&&this.rank<=9}},{key:"equals",value:function(e){return!!e&&this.file===e.file&&this.rank===e.rank}},{key:"sfen",get:function(){return this.file+ke[this.rank-1]}}],[{key:"newByXY",value:function(t,n){return new e(9-t,n+1)}},{key:"newByIndex",value:function(t){return new e(9-t%9,Math.trunc(t/9)+1)}},{key:"parseSFENSquare",value:function(t){var n=ye(t[0]),i=Ne(t[1]);return n&&i?new e(n,i):null}}]),e}();(0,Q.Z)(be,"all",[]);for(var Pe=0;Pe<81;Pe+=1)be.all.push(be.newByIndex(Pe));n(2222);var He=["１","２","３","４","５","６","７","８","９"],Ce=["一","二","三","四","五","六","七","八","九"],De=function(){function e(t,n,i,r,o,a){(0,$.Z)(this,e),(0,Q.Z)(this,"from",void 0),(0,Q.Z)(this,"to",void 0),(0,Q.Z)(this,"promote",void 0),(0,Q.Z)(this,"color",void 0),(0,Q.Z)(this,"pieceType",void 0),(0,Q.Z)(this,"capturedPieceType",void 0),this.from=t,this.to=n,this.promote=i,this.color=r,this.pieceType=o,this.capturedPieceType=a}return(0,X.Z)(e,[{key:"equals",value:function(e){return!!e&&((this.from instanceof be&&e.from instanceof be&&this.from.equals(e.from)||!(this.from instanceof be)&&!(e.from instanceof be)&&this.from===e.from)&&this.to.equals(e.to)&&this.promote===e.promote&&this.color===e.color&&this.pieceType===e.pieceType&&this.capturedPieceType===e.capturedPieceType)}},{key:"withPromote",value:function(){return new e(this.from,this.to,!0,this.color,this.pieceType,this.capturedPieceType)}},{key:"getDisplayText",value:function(e){var t="";if(t+=this.color===j.BLACK?"▲":"△",e&&e.to.equals(this.to)?t+="同":(t+=He[this.to.file-1],t+=Ce[this.to.rank-1]),t+=oe(this.pieceType),this.promote&&(t+="成"),this.from instanceof be){var n=this.from;t+=" (".concat(n.file).concat(n.rank,")")}else t+="打";return t}},{key:"sfen",get:function(){var e="";return this.from instanceof be?e+=this.from.sfen:e+=de(this.from)+"*",e+=this.to.sfen,this.promote&&(e+="+"),e}}]),e}();function Le(e){var t;if("*"===e[1]){var n=_e.newBySFEN(e[0]);if(!n)return null;t=n.type}else{var i=be.parseSFENSquare(e);if(!i)return null;t=i}var r=be.parseSFENSquare(e.substring(2));if(!r)return null;var o=e.length>=5&&"+"===e[4];return{from:t,to:r,promote:o}}var Me;n(4916),n(3123),n(9826);function xe(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}(function(e){e["STANDARD"]="standard",e["EMPTY"]="empty",e["HANDICAP_LANCE"]="handicapLance",e["HANDICAP_RIGHT_LANCE"]="handicapRightLance",e["HANDICAP_BISHOP"]="handicapBishop",e["HANDICAP_ROOK"]="handicapRook",e["HANDICAP_ROOK_LANCE"]="handicapRookLance",e["HANDICAP_2PIECES"]="handicap2Pieces",e["HANDICAP_4PIECES"]="handicap4Pieces",e["HANDICAP_6PIECES"]="handicap6Pieces",e["HANDICAP_8PIECES"]="handicap8Pieces",e["TSUME_SHOGI"]="tsumeShogi"})(Me||(Me={}));var Ge=function(){function e(){(0,$.Z)(this,e),(0,Q.Z)(this,"squares",void 0),this.squares=new Array;for(var t=0;t<81;t+=1)this.squares.push(null);this.reset(Me.STANDARD)}return(0,X.Z)(e,[{key:"at",value:function(e){return this.squares[e.index]}},{key:"set",value:function(e,t){this.squares[e.index]=t}},{key:"swap",value:function(e,t){var n=this.squares[e.index];this.squares[e.index]=this.squares[t.index],this.squares[t.index]=n}},{key:"remove",value:function(e){var t=this.squares[e.index];return this.squares[e.index]=null,t}},{key:"listNonEmptySquares",value:function(){var e=this,t=new Array;return be.all.forEach((function(n){e.squares[n.index]&&t.push(n)})),t}},{key:"listSquaresByColor",value:function(e){var t=this,n=new Array;return be.all.forEach((function(i){var r=t.squares[i.index];r&&r.color===e&&n.push(i)})),n}},{key:"clear",value:function(){var e=this;be.all.forEach((function(t){e.squares[t.index]=null}))}},{key:"reset",value:function(e){if(this.clear(),e!==Me.EMPTY&&(this.squares[new be(5,1).index]=new _e(j.WHITE,z.KING),e!==Me.TSUME_SHOGI))switch(this.squares[new be(5,9).index]=new _e(j.BLACK,z.KING),this.squares[new be(2,8).index]=new _e(j.BLACK,z.ROOK),this.squares[new be(8,2).index]=new _e(j.WHITE,z.ROOK),this.squares[new be(8,8).index]=new _e(j.BLACK,z.BISHOP),this.squares[new be(2,2).index]=new _e(j.WHITE,z.BISHOP),this.squares[new be(4,9).index]=new _e(j.BLACK,z.GOLD),this.squares[new be(6,9).index]=new _e(j.BLACK,z.GOLD),this.squares[new be(6,1).index]=new _e(j.WHITE,z.GOLD),this.squares[new be(4,1).index]=new _e(j.WHITE,z.GOLD),this.squares[new be(3,9).index]=new _e(j.BLACK,z.SILVER),this.squares[new be(7,9).index]=new _e(j.BLACK,z.SILVER),this.squares[new be(7,1).index]=new _e(j.WHITE,z.SILVER),this.squares[new be(3,1).index]=new _e(j.WHITE,z.SILVER),this.squares[new be(2,9).index]=new _e(j.BLACK,z.KNIGHT),this.squares[new be(8,9).index]=new _e(j.BLACK,z.KNIGHT),this.squares[new be(8,1).index]=new _e(j.WHITE,z.KNIGHT),this.squares[new be(2,1).index]=new _e(j.WHITE,z.KNIGHT),this.squares[new be(1,9).index]=new _e(j.BLACK,z.LANCE),this.squares[new be(9,9).index]=new _e(j.BLACK,z.LANCE),this.squares[new be(9,1).index]=new _e(j.WHITE,z.LANCE),this.squares[new be(1,1).index]=new _e(j.WHITE,z.LANCE),this.squares[new be(1,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(2,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(3,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(4,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(5,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(6,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(7,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(8,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(9,7).index]=new _e(j.BLACK,z.PAWN),this.squares[new be(1,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(2,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(3,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(4,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(5,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(6,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(7,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(8,3).index]=new _e(j.WHITE,z.PAWN),this.squares[new be(9,3).index]=new _e(j.WHITE,z.PAWN),e){default:case Me.STANDARD:return;case Me.HANDICAP_LANCE:return void(this.squares[new be(1,1).index]=null);case Me.HANDICAP_RIGHT_LANCE:return void(this.squares[new be(9,1).index]=null);case Me.HANDICAP_BISHOP:return void(this.squares[new be(2,2).index]=null);case Me.HANDICAP_ROOK:return void(this.squares[new be(8,2).index]=null);case Me.HANDICAP_ROOK_LANCE:return this.squares[new be(8,2).index]=null,void(this.squares[new be(1,1).index]=null);case Me.HANDICAP_2PIECES:return this.squares[new be(8,2).index]=null,void(this.squares[new be(2,2).index]=null);case Me.HANDICAP_4PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,void(this.squares[new be(9,1).index]=null);case Me.HANDICAP_6PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,this.squares[new be(2,1).index]=null,this.squares[new be(8,1).index]=null,void(this.squares[new be(9,1).index]=null);case Me.HANDICAP_8PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,this.squares[new be(2,1).index]=null,this.squares[new be(3,1).index]=null,this.squares[new be(7,1).index]=null,this.squares[new be(8,1).index]=null,void(this.squares[new be(9,1).index]=null)}}},{key:"sfen",get:function(){for(var e="",t=0,n=0;n<9;n+=1){for(var i=0;i<9;i+=1){var r=this.at(be.newByXY(i,n));r?(t&&(e+=t,t=0),e+=r.sfen):t+=1}t&&(e+=t,t=0),8!==n&&(e+="/")}return e}},{key:"resetBySFEN",value:function(t){if(!e.isValidSFEN(t))return!1;this.clear();for(var n=t.split("/"),i=0;i<9;i+=1)for(var r=0,o=0;o<n[i].length;o+=1){var a=n[i][o];"+"===a&&(o+=1,a+=n[i][o]);var s=xe(a);s?r+=s:(this.set(be.newByXY(r,i),_e.newBySFEN(a)),r+=1)}return!0}},{key:"findKing",value:function(e){var t=this,n=new _e(e,z.KING);return be.all.find((function(e){var i=t.at(e);if(i&&n.equals(i))return!0}))}},{key:"hasPower",value:function(e,t,n){var i=this;return!!we.find((function(r){for(var o=0,a=e.neighbor(r);a.valid;a=a.neighbor(r)){if(o+=1,n&&n.filled&&a.equals(n.filled))break;if(!(n&&n.ignore&&a.equals(n.ignore))){var s=i.at(a);if(s){if(s.color!==t)return!1;var c=Ee(r),u=Re(s,c);return u===Se.LONG||u===Se.SHORT&&1===o}}}return!1}))}},{key:"isChecked",value:function(e,t){var n=this.findKing(e);return!!n&&this.hasPower(n,ee(e),{filled:t&&t.filled,ignore:t&&t.ignore})}},{key:"copyFrom",value:function(e){var t=this;be.all.forEach((function(n){t.squares[n.index]=e.at(n)}))}}],[{key:"isValidSFEN",value:function(e){var t=e.split("/");if(9!==t.length)return!1;for(var n=0;n<9;n+=1){for(var i=0,r=0;r<t[n].length;r+=1){var o=t[n][r];"+"===o&&(r+=1,o+=t[n][r]);var a=xe(o);if(a)i+=a;else{if(!_e.isValidSFEN(o))return!1;i+=1}}if(9!==i)return!1}return!0}}]),e}();n(4723);function Be(e,t){return 0===e?"":(1!==e?e:"")+t.sfen}var Ze=function(){function e(){(0,$.Z)(this,e),(0,Q.Z)(this,"pieces",void 0),this.pieces=new Map,this.pieces.set(z.PAWN,0),this.pieces.set(z.LANCE,0),this.pieces.set(z.KNIGHT,0),this.pieces.set(z.SILVER,0),this.pieces.set(z.GOLD,0),this.pieces.set(z.BISHOP,0),this.pieces.set(z.ROOK,0)}return(0,X.Z)(e,[{key:"count",value:function(e){return this.pieces.get(e)}},{key:"set",value:function(e,t){this.pieces.set(e,t)}},{key:"add",value:function(e,t){var n=this.pieces.get(e);return n+=t,this.pieces.set(e,n),n}},{key:"reduce",value:function(e,t){var n=this.pieces.get(e);return n-=t,this.pieces.set(e,n),n}},{key:"forEach",value:function(e){e(z.PAWN,this.pieces.get(z.PAWN)),e(z.LANCE,this.pieces.get(z.LANCE)),e(z.KNIGHT,this.pieces.get(z.KNIGHT)),e(z.SILVER,this.pieces.get(z.SILVER)),e(z.GOLD,this.pieces.get(z.GOLD)),e(z.BISHOP,this.pieces.get(z.BISHOP)),e(z.ROOK,this.pieces.get(z.ROOK))}},{key:"sfenBlack",get:function(){return this.formatSFEN(j.BLACK)}},{key:"sfenWhite",get:function(){return this.formatSFEN(j.WHITE)}},{key:"formatSFEN",value:function(e){var t="";return t+=Be(this.count(z.ROOK),new _e(e,z.ROOK)),t+=Be(this.count(z.BISHOP),new _e(e,z.BISHOP)),t+=Be(this.count(z.GOLD),new _e(e,z.GOLD)),t+=Be(this.count(z.SILVER),new _e(e,z.SILVER)),t+=Be(this.count(z.KNIGHT),new _e(e,z.KNIGHT)),t+=Be(this.count(z.LANCE),new _e(e,z.LANCE)),t+=Be(this.count(z.PAWN),new _e(e,z.PAWN)),""===t?"-":t}},{key:"copyFrom",value:function(e){var t=this;e.pieces.forEach((function(e,n){t.pieces.set(n,e)}))}}],[{key:"formatSFEN",value:function(e,t){var n=e.sfenBlack,i=t.sfenWhite;return"-"===n&&"-"===i?"-":"-"===i?n:"-"===n?i:n+i}},{key:"isValidSFEN",value:function(e){return"-"===e||!!e.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/)}},{key:"parseSFEN",value:function(t){if("-"===t)return{black:new e,white:new e};if(!t.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/))return null;for(var n=t.match(/([0-9]*[PLNSGBRplnsgbr])/g),i=new e,r=new e,o=0;o<n.length;o+=1){var a=n[o],s=1;a.length>=2&&(s=Number(a.substring(0,a.length-1)));var c=_e.newBySFEN(a[a.length-1]);c.color===j.BLACK?i.add(c.type,s):r.add(c.type,s)}return{black:i,white:r}}}]),e}(),Ue={black:{pawn:{1:!0},lance:{1:!0},knight:{1:!0,2:!0}},white:{pawn:{9:!0},lance:{9:!0},knight:{9:!0,8:!0}}};function We(e,t,n){var i=Ue[e][t];return!!i&&i[n]}function Ke(e,t){return e===j.BLACK?t<=3:t>=7}function Fe(e,t,n){for(var i=1;i<=9;i+=1){var r=t.at(new be(n,i));if(r&&r.type===z.PAWN&&r.color===e)return!0}return!1}var qe,Ve=function(){function e(){(0,$.Z)(this,e),(0,Q.Z)(this,"_board",void 0),(0,Q.Z)(this,"_color",void 0),(0,Q.Z)(this,"_blackHand",void 0),(0,Q.Z)(this,"_whiteHand",void 0),this._board=new Ge,this._color=j.BLACK,this._blackHand=new Ze,this._whiteHand=new Ze}return(0,X.Z)(e,[{key:"board",get:function(){return this._board}},{key:"color",get:function(){return this._color}},{key:"blackHand",get:function(){return this._blackHand}},{key:"whiteHand",get:function(){return this._whiteHand}},{key:"reset",value:function(e){switch(this._board.reset(e),this._blackHand=new Ze,this._whiteHand=new Ze,e){case Me.STANDARD:case Me.EMPTY:case Me.TSUME_SHOGI:this._color=j.BLACK;break;case Me.HANDICAP_LANCE:case Me.HANDICAP_RIGHT_LANCE:case Me.HANDICAP_BISHOP:case Me.HANDICAP_ROOK:case Me.HANDICAP_ROOK_LANCE:case Me.HANDICAP_2PIECES:case Me.HANDICAP_4PIECES:case Me.HANDICAP_6PIECES:case Me.HANDICAP_8PIECES:this._color=j.WHITE;break}e===Me.TSUME_SHOGI&&(this._whiteHand.set(z.PAWN,18),this._whiteHand.set(z.LANCE,4),this._whiteHand.set(z.KNIGHT,4),this._whiteHand.set(z.SILVER,4),this._whiteHand.set(z.GOLD,4),this._whiteHand.set(z.BISHOP,2),this._whiteHand.set(z.ROOK,2))}},{key:"hand",value:function(e){return this._hand(e)}},{key:"_hand",value:function(e){return e===j.BLACK?this._blackHand:this._whiteHand}},{key:"checked",get:function(){return this._board.isChecked(this.color)}},{key:"createMove",value:function(e,t){var n;if(e instanceof be){var i=this._board.at(e);if(!i)return null;n=i.type}else n=e;var r=this._board.at(t);return new De(e,t,!1,this.color,n,r?r.type:null)}},{key:"createMoveBySFEN",value:function(e){var t=Le(e);if(!t)return null;var n=this.createMove(t.from,t.to);return n?(t.promote&&(n=n.withPromote()),n):null}},{key:"isPawnDropMate",value:function(e){var t=this;if(e.from instanceof be)return!1;if(e.pieceType!==z.PAWN)return!1;var n=e.to.neighbor(e.color===j.BLACK?ve.UP:ve.DOWN),i=this.board.at(n);if(!i||i.type!==z.KING||i.color===e.color)return!1;var r=Te(i).find((function(r){var o=n.neighbor(r);if(!o.valid)return!1;var a=t.board.at(o);return(!a||a.color!=i.color)&&!t.board.hasPower(o,e.color)}));return!r&&!this.board.listSquaresByColor(i.color).find((function(r){return!r.equals(n)&&t.isMovable(r,e.to)&&!t.board.isChecked(i.color,{filled:e.to,ignore:r})}))}},{key:"isValidMove",value:function(e){if(e.from instanceof be){var t=this._board.at(e.from);if(!t||t.color!==this.color)return!1;if(!this.isMovable(e.from,e.to))return!1;var n=this._board.at(e.to);if(n&&n.color===this.color)return!1;if(e.promote){if(!t.isPromotable())return!1;if(!Ke(this.color,e.from.rank)&&!Ke(this.color,e.to.rank))return!1}else if(We(this.color,t.type,e.to.rank))return!1;if(e.pieceType!==z.KING?this._board.isChecked(this.color,{filled:e.to,ignore:e.from}):this._board.hasPower(e.to,ee(this.color),{ignore:e.from}))return!1}else{if(e.promote)return!1;if(e.color!==this.color)return!1;if(0===this.hand(this.color).count(e.from))return!1;if(this._board.at(e.to))return!1;if(We(this.color,e.from,e.to.rank))return!1;if(e.from===z.PAWN&&Fe(this.color,this._board,e.to.file))return!1;if(this._board.isChecked(this.color,{filled:e.to}))return!1;if(this.isPawnDropMate(e))return!1}return!0}},{key:"doMove",value:function(e,t){if((!t||!t.ignoreValidation)&&!this.isValidMove(e))return!1;if(e.from instanceof be){var n=this._board.at(e.from),i=this._board.at(e.to);this._board.remove(e.from),this._board.set(e.to,e.promote?n.promoted():n),i&&i.type!==z.KING&&this._hand(this.color).add(i.unpromoted().type,1)}else this._hand(this.color).reduce(e.from,1),this._board.set(e.to,new _e(this.color,e.from));return this._color=ee(this.color),!0}},{key:"undoMove",value:function(e){if(this._color=ee(this.color),e.from instanceof be)if(this._board.set(e.from,new _e(this.color,e.pieceType)),e.capturedPieceType){var t=new _e(ee(this.color),e.capturedPieceType);this._board.set(e.to,t),t.type!==z.KING&&this._hand(this.color).reduce(t.unpromoted().type,1)}else this._board.remove(e.to);else this._hand(this.color).add(e.from,1),this._board.remove(e.to)}},{key:"isValidEditing",value:function(e,t){if(e instanceof be){var n=this._board.at(e);if(!n)return!1;if(t instanceof be){if(e.equals(t))return!1}else if(n.type===z.KING)return!1}else{if(!e.color)return!1;if(0===this.hand(e.color).count(e.type))return!1;if(t instanceof be){if(this._board.at(t))return!1}else if(e.color===t)return!1}return!0}},{key:"edit",value:function(e){if(e.move){if(!this.isValidEditing(e.move.from,e.move.to))return!1;if(e.move.from instanceof be)if(e.move.to instanceof be)this._board.swap(e.move.from,e.move.to);else{var t=this._board.remove(e.move.from);this._hand(e.move.to).add(t.unpromoted().type,1)}else this._hand(e.move.from.color).reduce(e.move.from.type,1),e.move.to instanceof be?this._board.set(e.move.to,e.move.from):this._hand(e.move.to).add(e.move.from.type,1)}if(e.rotate){var n=this._board.at(e.rotate);n&&this._board.set(e.rotate,n.rotate())}return!0}},{key:"sfen",get:function(){return this.getSfen(1)}},{key:"getSfen",value:function(e){var t="sfen ".concat(this._board.sfen," ").concat(te(this.color)," ");return t+=Ze.formatSFEN(this._blackHand,this._whiteHand),t+=" "+e,t}},{key:"resetBySFEN",value:function(t){if(!e.isValidSFEN(t))return!1;var n=t.split(" ");this._board.resetBySFEN(n[1]),this._color=ie(n[2]);var i=Ze.parseSFEN(n[3]);return this._blackHand=i.black,this._whiteHand=i.white,!0}},{key:"setColor",value:function(e){this._color=e}},{key:"isMovable",value:function(e,t){var n=t.x-e.x,i=t.y-e.y,r=Ae(n,i),o=r.direction,a=r.distance,s=r.ok;if(!s)return!1;var c=this._board.at(e);if(!c)return!1;switch(Re(c,o)){default:return!1;case Se.SHORT:return 1===a;case Se.LONG:for(var u=Oe[o],l=e.neighbor(u.x,u.y);l.valid;l=l.neighbor(u.x,u.y)){if(l.equals(t))return!0;if(this._board.at(l))return!1}return!1}}},{key:"copyFrom",value:function(e){this._board.copyFrom(e._board),this._color=e.color,this._blackHand.copyFrom(e._blackHand),this._whiteHand.copyFrom(e._whiteHand)}},{key:"clone",value:function(){var t=new e;return t.copyFrom(this),t}}],[{key:"isValidSFEN",value:function(e){var t=e.split(" ");return!(t.length<5)&&("sfen"===t[0]&&(!!Ge.isValidSFEN(t[1])&&(!!ne(t[2])&&!!Ze.isValidSFEN(t[3]))))}},{key:"newBySFEN",value:function(t){var n=new e;return n.resetBySFEN(t)?n:null}}]),e}();n(3210),n(3112);function Ye(e){return ze(Math.floor(e/1e3))}function je(e){return Je(Math.floor(e/1e3))}function ze(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),i=e%60;return t+":"+String(n).padStart(2,"0")+":"+String(i).padStart(2,"0")}function Je(e){var t=Math.floor(e/60),n=e%60;return String(t).padStart(2," ")+":"+String(n).padStart(2,"0")}function $e(e){switch(e){case qe.BLACK_NAME:return"先手";case qe.WHITE_NAME:return"後手";case qe.START_DATETIME:return"開始日時";case qe.END_DATETIME:return"終了日時";case qe.DATE:return"対局日";case qe.TOURNAMENT:return"棋戦";case qe.STRATEGY:return"戦型";case qe.TITLE:return"表題";case qe.TIME_LIMIT:return"持ち時間";case qe.TIME_SPENT:return"消費時間";case qe.PLACE:return"場所";case qe.POSTED_ON:return"掲載";case qe.NOTE:return"備考";case qe.BLACK_SHORT_NAME:return"先手省略名";case qe.WHITE_SHORT_NAME:return"後手省略名";case qe.OPUS_NO:return"作品番号";case qe.OPUS_NAME:return"作品名";case qe.AUTHOR:return"作者";case qe.PUBLISHED_ON:return"発表誌";case qe.PUBLISHED_AT:return"発表年月";case qe.SOURCE:return"出典";case qe.LENGTH:return"手数";case qe.INTEGRITY:return"完全性";case qe.CATEGORY:return"分類";case qe.AWARD:return"受賞"}}(function(e){e["BLACK_NAME"]="blackName",e["WHITE_NAME"]="whiteName",e["START_DATETIME"]="startDatetime",e["END_DATETIME"]="endDatetime",e["DATE"]="date",e["TOURNAMENT"]="tournament",e["STRATEGY"]="strategy",e["TITLE"]="title",e["TIME_LIMIT"]="timeLimit",e["TIME_SPENT"]="timeSpent",e["PLACE"]="place",e["POSTED_ON"]="postedOn",e["NOTE"]="note",e["BLACK_SHORT_NAME"]="blackShortName",e["WHITE_SHORT_NAME"]="whiteShortName",e["OPUS_NO"]="opusNo",e["OPUS_NAME"]="opusName",e["AUTHOR"]="author",e["PUBLISHED_ON"]="publishedOn",e["PUBLISHED_AT"]="publishedAt",e["SOURCE"]="source",e["LENGTH"]="length",e["INTEGRITY"]="integrity",e["CATEGORY"]="category",e["AWARD"]="award"})(qe||(qe={}));var Xe,Qe=function(){function e(){(0,$.Z)(this,e),(0,Q.Z)(this,"metadata",void 0),(0,Q.Z)(this,"customMetadata",void 0),this.metadata=new Map,this.customMetadata=new Map}return(0,X.Z)(e,[{key:"standardMetadataKeys",get:function(){return this.metadata.keys()}},{key:"getStandardMetadata",value:function(e){return this.metadata.get(e)}},{key:"setStandardMetadata",value:function(e,t){t?this.metadata.set(e,t):this.metadata.delete(e)}},{key:"customMetadataKeys",get:function(){return this.customMetadata.keys()}},{key:"getCustomMetadata",value:function(e){return this.customMetadata.get(e)}},{key:"setCustomMetadata",value:function(e,t){t?this.customMetadata.set(e,t):this.customMetadata.delete(e)}}]),e}();(function(e){e["START"]="start",e["INTERRUPT"]="interrupt",e["RESIGN"]="resign",e["DRAW"]="draw",e["REPETITION_DRAW"]="repetitionDraw",e["MATE"]="mate",e["TIMEOUT"]="timeout",e["FOUL_WIN"]="foulWin",e["FOUL_LOSE"]="foulLose",e["ENTERING_OF_KING"]="enteringOfKing",e["WIN_BY_DEFAULT"]="winByDefault",e["LOSS_BY_DEFAULT"]="lossByDefault"})(Xe||(Xe={}));var et={start:"開始局面",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function tt(e){return et[e]}var nt=function(){function e(t,n,i,r,o,a){(0,$.Z)(this,e),(0,Q.Z)(this,"number",void 0),(0,Q.Z)(this,"prev",void 0),(0,Q.Z)(this,"branchIndex",void 0),(0,Q.Z)(this,"activeBranch",void 0),(0,Q.Z)(this,"move",void 0),(0,Q.Z)(this,"isCheck",void 0),(0,Q.Z)(this,"next",void 0),(0,Q.Z)(this,"branch",void 0),(0,Q.Z)(this,"comment",void 0),(0,Q.Z)(this,"customData",void 0),(0,Q.Z)(this,"elapsedMs",void 0),(0,Q.Z)(this,"totalElapsedMs",void 0),this.number=t,this.prev=n,this.branchIndex=i,this.activeBranch=r,this.move=o,this.isCheck=a,this.next=null,this.branch=null,this.comment="",this.elapsedMs=0,this.totalElapsedMs=0}return(0,X.Z)(e,[{key:"displayMoveText",get:function(){var e=this.prev&&this.prev.move instanceof De?this.prev.move:null;return this.move instanceof De?this.move.getDisplayText(e):tt(this.move)}},{key:"displayText",get:function(){var e=this.displayMoveText;if(0!==this.number){var t=je(this.elapsedMs),n=Ye(this.totalElapsedMs);e+=" (".concat(t," / ").concat(n,")")}return e}},{key:"hasBranch",get:function(){return!!this.prev&&!!this.prev.next&&!!this.prev.next.branch}},{key:"isFirstBranch",get:function(){return!this.prev||this.prev.next===this}},{key:"updateTotalElapsedMs",value:function(){this.totalElapsedMs=this.elapsedMs,this.prev&&this.prev.prev&&(this.totalElapsedMs+=this.prev.prev.totalElapsedMs)}},{key:"setElapsedMs",value:function(e){this.elapsedMs=e,this.updateTotalElapsedMs();var t=this.next,n=[];while(t)t.updateTotalElapsedMs(),t.branch&&n.push(t.branch),t=t.next?t.next:n.pop()||null}}]),e}(),it=function(){function e(t){(0,$.Z)(this,e),(0,Q.Z)(this,"_metadata",void 0),(0,Q.Z)(this,"_initialPosition",void 0),(0,Q.Z)(this,"_position",void 0),(0,Q.Z)(this,"_first",void 0),(0,Q.Z)(this,"_current",void 0),(0,Q.Z)(this,"repetitionCounts",void 0),(0,Q.Z)(this,"repetitionStart",void 0),this._metadata=new Qe,this._initialPosition=t?t.clone():new Ve,this._position=this.initialPosition.clone(),this._first=new nt(0,null,0,!0,Xe.START,!1),this._current=this._first,this.repetitionCounts={},this.repetitionStart={},this.incrementRepetition()}return(0,X.Z)(e,[{key:"metadata",get:function(){return this._metadata}},{key:"initialPosition",get:function(){return this._initialPosition}},{key:"position",get:function(){return this._position}},{key:"first",get:function(){return this._first}},{key:"current",get:function(){return this._current}},{key:"moves",get:function(){for(var e=this.movesBefore,t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e.push(t)}return e}},{key:"movesBefore",get:function(){return this._movesBefore}},{key:"_movesBefore",get:function(){var e=new Array;e.unshift(this._current);for(var t=this._current.prev;t;t=t.prev)e.unshift(t);return e}},{key:"length",get:function(){for(var e=this._current.number,t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e=t.number}return e}},{key:"branchBegin",get:function(){return this._current.prev?this._current.prev.next:this._current}},{key:"clear",value:function(e){e&&(this._initialPosition=e.clone()),this._position=this.initialPosition.clone(),this.repetitionCounts={},this.incrementRepetition(),this._first.next=null,this._current=this._first}},{key:"goBack",value:function(){return!!this._current.prev&&(this._current.move instanceof De&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=this._current.prev,!0)}},{key:"goForward",value:function(){if(this._current.next){this._current=this._current.next;while(!this._current.activeBranch)this._current=this._current.branch;return this._current.move instanceof De&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),!0}return!1}},{key:"goto",value:function(e){while(e<this._current.number)if(!this.goBack())break;while(e>this._current.number)if(!this.goForward())break}},{key:"resetAllBranchSelection",value:function(){this._forEach((function(e){e.activeBranch=e.isFirstBranch}))}},{key:"switchBranchByIndex",value:function(e){if(!this._current.prev)return!1;for(var t=!1,n=this._current.prev.next;n;n=n.branch)n.branchIndex===e?(n.activeBranch=!0,this._current.move instanceof De&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=n,this._current.move instanceof De&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),t=!0):n.activeBranch=!1;return t}},{key:"append",value:function(e,t){var n,i=!1;if(e instanceof De){if(!this._position.doMove(e,t))return!1;this.incrementRepetition(),i=this.position.checked}if(this._current===this.first||this._current.move instanceof De||this.goBack(),!this._current.next)return this._current.next=new nt(this._current.number+1,this._current,0,!0,e,i),this._current=this._current.next,!0;for(n=this._current.next;n;n=n.branch)n.activeBranch=!1;var r=this._current.next;for(n=this._current.next;n;n=n.branch){if(n.move instanceof De&&e instanceof De&&e.equals(n.move)||e===n.move)return this._current=n,this._current.activeBranch=!0,!0;r=n}return this._current=new nt(this._current.number+1,this._current,r.branchIndex+1,!0,e,i),r.branch=this._current,!0}},{key:"removeAfter",value:function(){var e=this._current;if(this.goBack()){if(this._current.next===e)this._current.next=e.branch;else for(var t=this._current.next;t;t=t.branch)if(t.branch===e){t.branch=e.branch;break}for(var n=0,i=this._current.next;i;i=i.branch)i.branchIndex=n,n+=1;this._current.next&&(this._current.next.activeBranch=!0)}else this._current.next=null}},{key:"incrementRepetition",value:function(){var e=this.position.sfen;this.repetitionCounts[e]?this.repetitionCounts[e]+=1:(this.repetitionCounts[e]=1,this.repetitionStart[e]=this.current.number)}},{key:"decrementRepetition",value:function(){var e=this.position.sfen;this.repetitionCounts[e]-=1,0===this.repetitionCounts[e]&&(delete this.repetitionCounts[e],delete this.repetitionStart[e])}},{key:"repetition",get:function(){return this.repetitionCounts[this.position.sfen]>=4}},{key:"perpetualCheck",get:function(){if(!this.repetition)return null;for(var e=this.position.sfen,t=this.repetitionStart[e],n=!0,i=!0,r=this.position.color,o=this.current;o.number>=t;o=o.prev)r=ee(r),o.isCheck||(r===j.BLACK?n=!1:i=!1);return n?j.BLACK:i?j.WHITE:null}},{key:"usi",get:function(){var e="position "+this.initialPosition.sfen+" moves";return this._movesBefore.forEach((function(t){t.move instanceof De&&(e+=" "+t.move.sfen)})),e}},{key:"sfen",get:function(){return"position "+this.position.getSfen(this._current.number+1)}},{key:"forEach",value:function(e){this._forEach(e)}},{key:"_forEach",value:function(e){var t=this._first,n=[];while(t)e(t),t.branch&&n.push(t.branch),t=t.next?t.next:n.pop()||null}}]),e}();var rt,ot=n(6347),at=(n(9494),n(5306),n(8757),{"先手":qe.BLACK_NAME,"後手":qe.WHITE_NAME,"開始日時":qe.START_DATETIME,"終了日時":qe.END_DATETIME,"対局日":qe.DATE,"棋戦":qe.TOURNAMENT,"戦型":qe.STRATEGY,"表題":qe.TITLE,"持ち時間":qe.TIME_LIMIT,"消費時間":qe.TIME_SPENT,"場所":qe.PLACE,"掲載":qe.POSTED_ON,"備考":qe.NOTE,"先手省略名":qe.BLACK_SHORT_NAME,"後手省略名":qe.WHITE_SHORT_NAME,"作品番号":qe.OPUS_NO,"作品名":qe.OPUS_NAME,"作者":qe.AUTHOR,"発表誌":qe.PUBLISHED_ON,"発表年月":qe.PUBLISHED_AT,"出典":qe.SOURCE,"手数":qe.LENGTH,"完全性":qe.INTEGRITY,"分類":qe.CATEGORY,"受賞":qe.AWARD}),st={blackName:"先手",whiteName:"後手",startDatetime:"開始日時",endDatetime:"終了日時",date:"対局日",tournament:"棋戦",strategy:"戦型",title:"表題",timeLimit:"持ち時間",timeSpent:"消費時間",place:"場所",postedOn:"掲載",note:"備考",blackShortName:"先手省略名",whiteShortName:"後手省略名",opusNo:"作品番号",opusName:"作品名",author:"作者",publishedOn:"発表誌",publishedAt:"発表年月",source:"出典",length:"手数",integrity:"完全性",category:"分類",award:"受賞"};(function(e){e[e["METADATA"]=0]="METADATA",e[e["HANDICAP"]=1]="HANDICAP",e[e["BLACK_HAND"]=2]="BLACK_HAND",e[e["WHITE_HAND"]=3]="WHITE_HAND",e[e["BOARD"]=4]="BOARD",e[e["BLACK_TURN"]=5]="BLACK_TURN",e[e["WHITE_TURN"]=6]="WHITE_TURN",e[e["MOVE"]=7]="MOVE",e[e["COMMENT"]=8]="COMMENT",e[e["UNKNOWN"]=9]="UNKNOWN"})(rt||(rt={}));var ct=[{prefix:/^手合割：/,type:rt.HANDICAP,removePrefix:!0,isPosition:!0},{prefix:/^先手の持駒：/,type:rt.BLACK_HAND,removePrefix:!0,isPosition:!0},{prefix:/^後手の持駒：/,type:rt.WHITE_HAND,removePrefix:!0,isPosition:!0},{prefix:/^\|/,type:rt.BOARD,removePrefix:!1,isPosition:!0},{prefix:/^先手番/,type:rt.BLACK_TURN,removePrefix:!1,isPosition:!0},{prefix:/^後手番/,type:rt.WHITE_TURN,removePrefix:!1,isPosition:!0},{prefix:/^ *[0-9]+ +/,type:rt.MOVE,removePrefix:!1,isPosition:!1},{prefix:/^\*/,type:rt.COMMENT,removePrefix:!0,isPosition:!1}];function ut(e){var t=e.indexOf("#");-1===t&&(t=e.length);for(var n=0;n<ct.length;n++){var i=ct[n],r=e.match(i.prefix);if(r){var o=i.removePrefix?r[0].length:0;return{type:i.type,data:e.substring(o,t),isPosition:i.isPosition,metadataKey:""}}}var a=e.match(/^[^ ]+：/);if(a){var s=a[0];return{type:rt.METADATA,data:e.substring(s.length,t),isPosition:!1,metadataKey:s.substring(0,s.length-1)}}return{type:rt.UNKNOWN,data:e.substring(0,t),isPosition:!1,metadataKey:""}}function lt(e,t){switch(t.trim()){case"平手":return void e.reset(Me.STANDARD);case"香落ち":return void e.reset(Me.HANDICAP_LANCE);case"右香落ち":return void e.reset(Me.HANDICAP_RIGHT_LANCE);case"角落ち":return void e.reset(Me.HANDICAP_BISHOP);case"飛車落ち":return void e.reset(Me.HANDICAP_ROOK);case"飛香落ち":return void e.reset(Me.HANDICAP_ROOK_LANCE);case"二枚落ち":return void e.reset(Me.HANDICAP_2PIECES);case"四枚落ち":return void e.reset(Me.HANDICAP_4PIECES);case"六枚落ち":return void e.reset(Me.HANDICAP_6PIECES);case"八枚落ち":return void e.reset(Me.HANDICAP_8PIECES);case"その他":return void e.reset(Me.EMPTY)}return new Error("不正なデータ:"+t)}var dt={"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9},pt={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},ht={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"十":10,"十一":11,"十二":12,"十三":13,"十四":14,"十五":15,"十六":16,"十七":17,"十八":18},ft={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9},mt={"王":z.KING,"玉":z.KING,"飛":z.ROOK,"龍":z.DRAGON,"竜":z.DRAGON,"角":z.BISHOP,"馬":z.HORSE,"金":z.GOLD,"銀":z.SILVER,"成銀":z.PROM_SILVER,"全":z.PROM_SILVER,"桂":z.KNIGHT,"成桂":z.PROM_KNIGHT,"圭":z.PROM_KNIGHT,"香":z.LANCE,"成香":z.PROM_LANCE,"杏":z.PROM_LANCE,"歩":z.PAWN,"と":z.PROM_PAWN},vt={"中断":Xe.INTERRUPT,"投了":Xe.RESIGN,"持将棋":Xe.DRAW,"千日手":Xe.REPETITION_DRAW,"詰み":Xe.MATE,"切れ負け":Xe.TIMEOUT,"反則勝ち":Xe.FOUL_WIN,"反則負け":Xe.FOUL_LOSE,"入玉勝ち":Xe.ENTERING_OF_KING,"不戦勝":Xe.WIN_BY_DEFAULT,"不戦敗":Xe.LOSS_BY_DEFAULT},_t=/^ *([0-9]+) +[▲△]?([１２３４５６７８９][一二三四五六七八九]|同\u3000)(玉|飛|龍|竜|角|馬|金|銀|成銀|全|桂|成桂|圭|香|成香|杏|歩|と)(成?)(打|\([1-9][1-9]\)) *(.*)$/,gt=/\( *([0-9]+):([0-9]+)\/[0-9: ]*\)/,Et=/^ *([0-9]+) +(中断|投了|持将棋|千日手|詰み|切れ負け|反則勝ち|反則負け|入玉勝ち|不戦勝|不戦敗) *(.*)$/;function St(e,t){if(t.length<21)return new Error("不正な盤面:"+t);var n=t[20],i=pt[n];if(!i)return new Error("不正な盤面:"+t);for(var r=0;r<9;r+=1){var o=9-r,a=new be(o,i),s=2*r+1,c=t[s+1],u=mt[c];if(u){var l="v"!==t[s]?j.BLACK:j.WHITE;e.set(a,new _e(l,u))}else e.remove(a)}}function wt(e,t){var n,i=t.split(/[ 　]/),r=(0,ot.Z)(i);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o&&"なし"!==o){var a=o[0],s=o.substring(1),c=mt[a],u=ht[s]||1;if(!c)return new Error("不正な持ち駒: "+o);e.add(c,u)}}}catch(l){r.e(l)}finally{r.f()}}function It(e,t){var n=gt.exec(t);if(n){var i=n[1],r=n[2],o=60*Number.parseInt(i)+Number.parseInt(r);e.current.setElapsedMs(1e3*o)}}function Tt(e,t){var n=Et.exec(t);if(n){var i=Number(n[1]),r=vt[n[2]],o=n[3];return e.goto(i-1),e.append(r,{ignoreValidation:!0}),void It(e,o)}if(n=_t.exec(t),!n)return new Error("不正な指し手形式:"+t);var a,s,c=Number(n[1]),u=n[2],l=n[3],d=n[4],p=n[5],h=n[6];if(0===c)return new Error("不正な手数:"+t);if(e.goto(c-1),"同　"===u){if(!(e.current.move instanceof De))return new Error("不明な移動先: "+t);a=e.current.move.to}else{var f=dt[u[0]],m=pt[u[1]];a=new be(f,m)}if("打"===p)s=mt[l];else{var v=ft[p[1]],_=ft[p[2]];s=new be(v,_)}var g=e.position.createMove(s,a);if(!g)return new Error("不正な指し手: "+t);"成"===d&&(g=g.withPromote()),e.append(g,{ignoreValidation:!0}),It(e,h)}function Rt(e){var t,n=new it,i=e.split(/\r?\n/),r=new Ve,o=!1,a=(0,ot.Z)(i);try{for(a.s();!(t=a.n()).done;){var s=t.value;if(""!==s){var c=ut(s);if(o&&c.isPosition)return new Error("不正なデータ: "+s);var u=void 0;switch(c.type){case rt.METADATA:var l=at[c.metadataKey];l?n.metadata.setStandardMetadata(l,c.data):n.metadata.setCustomMetadata(c.metadataKey,c.data);break;case rt.HANDICAP:u=lt(r,c.data);break;case rt.BLACK_HAND:u=wt(r.blackHand,c.data);break;case rt.WHITE_HAND:u=wt(r.whiteHand,c.data);break;case rt.BOARD:u=St(r.board,c.data);break;case rt.BLACK_TURN:r.setColor(j.BLACK);break;case rt.WHITE_TURN:r.setColor(j.WHITE);break;case rt.MOVE:o||(n.clear(r),o=!0),u=Tt(n,c.data);break;case rt.COMMENT:n.current.comment+=(0!==n.current.comment.length?"\n":"")+c.data;break;case rt.UNKNOWN:console.log("skip",s);break}if(u)return u}}}catch(d){a.e(d)}finally{a.f()}return o||n.clear(r),n.goto(0),n.resetAllBranchSelection(),n}var Ot=["一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八"],At=["１","２","３","４","５","６","７","８","９"],yt=Ot,Nt={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"成銀",knight:"桂",promKnight:"成桂",lance:"香",promLance:"成香",pawn:"歩",promPawn:"と"},kt={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"全",knight:"桂",promKnight:"圭",lance:"香",promLance:"杏",pawn:"歩",promPawn:"と"},bt={start:"",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉勝ち",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function Pt(e,t){var n,i="",r=t.returnCode?t.returnCode:"\n",o=(0,ot.Z)(e.standardMetadataKeys);try{for(o.s();!(n=o.n()).done;){var a=n.value;i+=st[a]+"："+e.getStandardMetadata(a)+r}}catch(l){o.e(l)}finally{o.f()}var s,c=(0,ot.Z)(e.customMetadataKeys);try{for(c.s();!(s=c.n()).done;){var u=s.value;i+=u+"："+e.getCustomMetadata(u)+r}}catch(l){c.e(l)}finally{c.f()}return i}function Ht(e,t){var n="",i=t.returnCode?t.returnCode:"\n";n+="後手の持駒："+Dt(e.whiteHand)+i,n+="  ９ ８ ７ ６ ５ ４ ３ ２ １"+i,n+="+---------------------------+"+i;for(var r=0;r<9;r++){n+="|";for(var o=0;o<9;o++){var a=be.newByXY(o,r),s=e.board.at(a);s?s.color===j.BLACK?n+=" "+kt[s.type]:n+="v"+kt[s.type]:n+=" ・"}n+="|"+yt[r]+i}return n+="+---------------------------+"+i,n+="先手の持駒："+Dt(e.blackHand)+i,e.color===j.BLACK?n+="先手番"+i:n+="後手番"+i,n}function Ct(e){var t="";return t+=At[e.to.file-1],t+=yt[e.to.rank-1],t+=Nt[e.pieceType],e.promote&&(t+="成"),e.from instanceof be?t+="("+e.from.file+e.from.rank+")":t+="打",t}function Dt(e){var t="";return e.forEach((function(e,n){n>=1&&(t+=kt[e],n>=2&&(t+=Ot[n-1]),t+="　")})),t}function Lt(e,t){var n="",i=t.returnCode?t.returnCode:"\n";return n+="# KIF形式棋譜ファイル Generated by Electron Shogi"+i,n+=Pt(e.metadata,t),n+=Ht(e.initialPosition,t),n+="手数----指手---------消費時間--"+i,e.forEach((function(e){if(0!==e.number){e.isFirstBranch||(n+=i,n+="変化："+e.number+"手"+i),n+=e.number+" ",e.move instanceof De?n+=Ct(e.move):n+=bt[e.move];var t=je(e.elapsedMs),r=Ye(e.totalElapsedMs);n+=" (".concat(t,"/").concat(r,")"),e.isFirstBranch&&e.hasBranch&&(n+="+"),n+=i}0!==e.comment.length&&(n+="*"+e.comment.replaceAll("\n",i+"*")+i)})),n}var Mt,xt,Gt,Bt,Zt={};function Ut(e){if(!Zt[e]){var t=document.createElement("img");t.src=e,Zt[e]=t}}(function(e){e["HITOMOJI"]="hitomoji",e["HITOMOJI_GOTHIC"]="hitomojiGothic"})(Gt||(Gt={})),function(e){e["LIGHT"]="light",e["WARM"]="warm",e["RESIN"]="resin"}(Bt||(Bt={}));var Wt={frame:{width:1471,height:959},board:{x:296.5,y:0,width:878,height:960,squreWidth:94.8,squreHeight:104,leftSquarePadding:12,topSquarePadding:12.2,leftPiecePadding:17.5,topPiecePadding:18.5,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"},lastMove:{"background-color":"#00ddff",opacity:"0.5"}}},piece:{width:88,height:93},hand:{color:"#8b4513",black:{x:1184,y:600},white:{x:0,y:0},width:288,height:360,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"}}},turn:{black:{x:1184,y:425},white:{x:0,y:492},width:288,height:45,fontSize:32},playerName:{black:{x:1184,y:480},white:{x:0,y:370},width:288,height:45,fontSize:25},clock:{black:{x:1184,y:535},white:{x:0,y:425},width:288,height:55,fontSize:40},control:{left:{x:0,y:547,width:288,height:412,fontSize:26},right:{x:1184,y:0,width:288,height:412,fontSize:26}}},Kt=(Mt={},(0,Q.Z)(Mt,Gt.HITOMOJI,{black:{pawn:"./piece/hitomoji/black_pawn.png",lance:"./piece/hitomoji/black_lance.png",knight:"./piece/hitomoji/black_knight.png",silver:"./piece/hitomoji/black_silver.png",gold:"./piece/hitomoji/black_gold.png",bishop:"./piece/hitomoji/black_bishop.png",rook:"./piece/hitomoji/black_rook.png",king:"./piece/hitomoji/black_king.png",king2:"./piece/hitomoji/black_king2.png",promPawn:"./piece/hitomoji/black_prom_pawn.png",promLance:"./piece/hitomoji/black_prom_lance.png",promKnight:"./piece/hitomoji/black_prom_knight.png",promSilver:"./piece/hitomoji/black_prom_silver.png",horse:"./piece/hitomoji/black_horse.png",dragon:"./piece/hitomoji/black_dragon.png"},white:{pawn:"./piece/hitomoji/white_pawn.png",lance:"./piece/hitomoji/white_lance.png",knight:"./piece/hitomoji/white_knight.png",silver:"./piece/hitomoji/white_silver.png",gold:"./piece/hitomoji/white_gold.png",bishop:"./piece/hitomoji/white_bishop.png",rook:"./piece/hitomoji/white_rook.png",king:"./piece/hitomoji/white_king.png",king2:"./piece/hitomoji/white_king2.png",promPawn:"./piece/hitomoji/white_prom_pawn.png",promLance:"./piece/hitomoji/white_prom_lance.png",promKnight:"./piece/hitomoji/white_prom_knight.png",promSilver:"./piece/hitomoji/white_prom_silver.png",horse:"./piece/hitomoji/white_horse.png",dragon:"./piece/hitomoji/white_dragon.png"}}),(0,Q.Z)(Mt,Gt.HITOMOJI_GOTHIC,{black:{pawn:"./piece/hitomoji_gothic/black_pawn.png",lance:"./piece/hitomoji_gothic/black_lance.png",knight:"./piece/hitomoji_gothic/black_knight.png",silver:"./piece/hitomoji_gothic/black_silver.png",gold:"./piece/hitomoji_gothic/black_gold.png",bishop:"./piece/hitomoji_gothic/black_bishop.png",rook:"./piece/hitomoji_gothic/black_rook.png",king:"./piece/hitomoji_gothic/black_king.png",king2:"./piece/hitomoji_gothic/black_king2.png",promPawn:"./piece/hitomoji_gothic/black_prom_pawn.png",promLance:"./piece/hitomoji_gothic/black_prom_lance.png",promKnight:"./piece/hitomoji_gothic/black_prom_knight.png",promSilver:"./piece/hitomoji_gothic/black_prom_silver.png",horse:"./piece/hitomoji_gothic/black_horse.png",dragon:"./piece/hitomoji_gothic/black_dragon.png"},white:{pawn:"./piece/hitomoji_gothic/white_pawn.png",lance:"./piece/hitomoji_gothic/white_lance.png",knight:"./piece/hitomoji_gothic/white_knight.png",silver:"./piece/hitomoji_gothic/white_silver.png",gold:"./piece/hitomoji_gothic/white_gold.png",bishop:"./piece/hitomoji_gothic/white_bishop.png",rook:"./piece/hitomoji_gothic/white_rook.png",king:"./piece/hitomoji_gothic/white_king.png",king2:"./piece/hitomoji_gothic/white_king2.png",promPawn:"./piece/hitomoji_gothic/white_prom_pawn.png",promLance:"./piece/hitomoji_gothic/white_prom_lance.png",promKnight:"./piece/hitomoji_gothic/white_prom_knight.png",promSilver:"./piece/hitomoji_gothic/white_prom_silver.png",horse:"./piece/hitomoji_gothic/white_horse.png",dragon:"./piece/hitomoji_gothic/white_dragon.png"}}),Mt),Ft=(xt={},(0,Q.Z)(xt,Bt.LIGHT,"./board/light.png"),(0,Q.Z)(xt,Bt.WARM,"./board/warm.png"),(0,Q.Z)(xt,Bt.RESIN,"./board/resin.png"),xt),qt={black:{pawn:{row:3,column:0,width:2},lance:{row:2,column:0,width:1},knight:{row:2,column:1,width:1},silver:{row:1,column:0,width:1},gold:{row:1,column:1,width:1},bishop:{row:0,column:0,width:1},rook:{row:0,column:1,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}},white:{pawn:{row:0,column:0,width:2},lance:{row:1,column:1,width:1},knight:{row:1,column:0,width:1},silver:{row:2,column:1,width:1},gold:{row:2,column:0,width:1},bishop:{row:3,column:1,width:1},rook:{row:3,column:0,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}}},Vt=function(){function e(t,n){(0,$.Z)(this,e),(0,Q.Z)(this,"pieceImages",void 0),(0,Q.Z)(this,"boardImage",void 0),this.pieceImages=Kt[t]||Kt[Gt.HITOMOJI],this.boardImage=Ft[n]}return(0,X.Z)(e,[{key:"preload",value:function(){Ut(this.boardImage),Object.values(this.pieceImages.black).forEach(Ut),Object.values(this.pieceImages.white).forEach(Ut)}},{key:"build",value:function(e,t,n,i,r,o){var a=this,s=e.width/Wt.frame.width;Wt.frame.height*s>e.height&&(s=e.height/Wt.frame.height);var c=function(){return{style:{height:Wt.frame.height*s+"px",width:Wt.frame.width*s+"px"}}},u=function(){var e=a.boardImage,t=Wt.board.x*s,n=Wt.board.y*s,i=Wt.board.width*s,r=Wt.board.height*s,o={left:t+"px",top:n+"px",height:r+"px",width:i+"px"};return{imagePath:e,x:t,y:n,style:o}},l=function(e){var n=[];return t.board.listNonEmptySquares().forEach((function(i){var r=t.board.at(i),c=r.id+i.index,u=o?ee(r.color):r.color,l=r.type==z.KING&&r.color==j.BLACK?"king2":r.type,d=a.pieceImages[u][l],p=e.x+(Wt.board.leftPiecePadding+Wt.board.squreWidth*(o?i.opposite:i).x)*s,h=e.y+(Wt.board.topPiecePadding+Wt.board.squreHeight*(o?i.opposite:i).y)*s,f=Wt.piece.width*s,m=Wt.piece.height*s;n.push({id:c,imagePath:d,style:{left:p+"px",top:h+"px",width:f+"px",height:m+"px"}})})),n},d=function(e){var t=[];return be.all.forEach((function(r){var a=r.index,c=r.file,u=r.rank,l=e.x+(Wt.board.leftSquarePadding+Wt.board.squreWidth*(o?r.opposite:r).x)*s,d=e.y+(Wt.board.topSquarePadding+Wt.board.squreHeight*(o?r.opposite:r).y)*s,p=Wt.board.squreWidth*s,h=Wt.board.squreHeight*s,f={left:l+"px",top:d+"px",width:p+"px",height:h+"px"},m=f;n&&r.equals(n.to)&&(m=(0,J.Z)((0,J.Z)({},m),Wt.board.highlight.lastMove)),i instanceof be&&i.equals(r)&&(m=(0,J.Z)((0,J.Z)({},m),Wt.board.highlight.selected)),t.push({id:a,file:c,rank:u,style:f,backgroundStyle:m})})),t},p=function(e,t){var n=o?ee(e):e,r=Wt.hand[n].x*s,c=Wt.hand[n].y*s,u=Wt.hand.width*s,l=Wt.hand.height*s,d={"background-color":Wt.hand.color,left:r+"px",top:c+"px",width:u+"px",height:l+"px"},p=[],h=[];return ae.forEach((function(r){for(var o=t.count(r),c=qt[n][r],u=Wt.hand.width/2*c.width*s,l=Wt.hand.height/4*s,d=u*c.column,f=l*c.row,m=Wt.piece.width*s,v=Wt.piece.height*s,_=Math.max(u-m*o,0)/(2*o),g=(u-m-2*_)/Math.max(o-1,1),E=o-1;E>=0;E-=1){var S=r+E,w=a.pieceImages[n][r],I=d+_+g*E,T=f;p.push({id:S,imagePath:w,style:{left:I+"px",top:T+"px",width:m+"px",height:v+"px"}})}var R=r,O={left:d+"px",top:f+"px",width:u+"px",height:l+"px"},A=O;i&&i instanceof _e&&i.color===e&&i.type===r&&(A=(0,J.Z)((0,J.Z)({},A),Wt.hand.highlight.selected)),h.push({id:R,type:r,style:O,backgroundStyle:A})})),{style:d,pieces:p,pointers:h}},h=function(e,t){if(!t)return null;var n=o?ee(t.color):t.color,i=o?t.to.opposite:t.to,r=new _e(n,t.pieceType),c=r.promoted(),u=r.unpromoted(),l=a.pieceImages[n][c.type],d=a.pieceImages[n][u.type],p=e.x+(Wt.board.leftSquarePadding+Wt.board.squreWidth*(i.x-.5))*s,h=e.y+(Wt.board.topSquarePadding+Wt.board.squreHeight*i.y)*s,f=2*Wt.board.squreWidth*s,m=Wt.board.squreHeight*s,v={left:p+"px",top:h+"px",width:f+"px",height:m+"px","font-size":m/4+"px"};return{promoteImagePath:l,notPromoteImagePath:d,style:v}},f=function(){var e=t.color,n=o?ee(e):e,i=2;return{style:{left:Wt.turn[n].x*s-i+"px",top:Wt.turn[n].y*s-i+"px",width:Wt.turn.width*s-i+"px",height:Wt.turn.height*s-i+"px","font-size":Wt.turn.fontSize*s+"px","border-radius":Wt.turn.height*s*.4+"px","border-width":i+"px","border-style":"solid"}}},m=function(e){var t=o?ee(e):e;return{style:{left:Wt.playerName[t].x*s+"px",top:Wt.playerName[t].y*s+"px",width:Wt.playerName.width*s+"px",height:Wt.playerName.height*s+"px","font-size":Wt.playerName.fontSize*s+"px"}}},v=function(e){var t=o?ee(e):e;return{style:{left:Wt.clock[t].x*s+"px",top:Wt.clock[t].y*s+"px",width:Wt.clock.width*s+"px",height:Wt.clock.height*s+"px","font-size":Wt.clock.fontSize*s+"px"}}},_=function(){return{left:{style:{left:Wt.control.left.x*s+"px",top:Wt.control.left.y*s+"px",width:Wt.control.left.width*s+"px",height:Wt.control.left.height*s+"px","font-size":Wt.control.left.fontSize*s+"px"}},right:{style:{left:Wt.control.right.x*s+"px",top:Wt.control.right.y*s+"px",width:Wt.control.right.width*s+"px",height:Wt.control.right.height*s+"px","font-size":Wt.control.right.fontSize*s+"px"}}}},g=c(),E=u(),S=l(E),w=d(E),I=p(j.BLACK,t.hand(j.BLACK)),T=p(j.WHITE,t.hand(j.WHITE)),R=h(E,r),O=f(),A=m(j.BLACK),y=m(j.WHITE),N=v(j.BLACK),k=v(j.WHITE),b=_();return{frame:g,board:E,piece:S,square:w,blackHand:I,whiteHand:T,promotion:R,turn:O,blackPlayerName:A,whitePlayerName:y,blackClock:N,whiteClock:k,control:b}}}]),e}(),Yt=function(){function e(t,n){(0,$.Z)(this,e),(0,Q.Z)(this,"width",void 0),(0,Q.Z)(this,"height",void 0),this.width=t,this.height=n}return(0,X.Z)(e,[{key:"add",value:function(t){return new e(this.width+t.width,this.height+t.height)}},{key:"reduce",value:function(t){return new e(this.width-t.width,this.height-t.height)}}]),e}(),jt=(0,a.aZ)({name:"BoardView",props:{pieceImageType:{type:String,required:!0},boardImageType:{type:String,required:!0},maxSize:{type:Yt,required:!0},position:{type:Object,required:!0},lastMove:{type:De,required:!1,default:null},flip:{type:Boolean,required:!1},allowEdit:{type:Boolean,required:!1},allowMove:{type:Boolean,required:!1},blackPlayerName:{type:String,required:!1,default:"先手"},whitePlayerName:{type:String,required:!1,default:"後手"},blackPlayerTimeMs:{type:Number,required:!1,default:void 0},blackPlayerByoyomi:{type:Number,required:!1,default:void 0},whitePlayerTimeMs:{type:Number,required:!1,default:void 0},whitePlayerByoyomi:{type:Number,required:!1,default:void 0}},emits:["move","edit"],setup:function(e,t){var n=(0,d.qj)({pointer:null,reservedMove:null}),i=function(){n.pointer=null,n.reservedMove=null};(0,a.YP)([function(){return e.position},function(){return e.allowEdit},function(){return e.allowMove}],(function(){i()}));var r=function(){i()},o=function(r,o,a){var s=n.pointer;if(i(),!(r instanceof be&&s instanceof be&&r.equals(s))&&!(r instanceof _e&&s instanceof _e&&r.equals(s))){if(s){var c=s,u=r instanceof be?r:r.color;if(e.allowEdit&&e.position.isValidEditing(c,u))return void t.emit("edit",{move:{from:s,to:u}});if(e.allowMove&&r instanceof be){var l=s instanceof be?s:s.type,d=r,p=e.position.createMove(l,d);if(!p)return;var h=e.position.isValidMove(p),f=e.position.isValidMove(p.withPromote());if(h&&f)return void(n.reservedMove=p);if(h)return void t.emit("move",p);if(f)return void t.emit("move",p.withPromote())}}!e.allowMove&&!e.allowEdit||o||(e.allowEdit||a===e.position.color)&&(n.pointer=r)}},s=function(t,n,i){t.stopPropagation(),t.preventDefault();var r=new be(n,i),a=e.position.board.at(r),s=!a;o(r,s,null===a||void 0===a?void 0:a.color)},c=function(t,n,i){t.stopPropagation(),t.preventDefault();var r=0===e.position.hand(n).count(i);o(new _e(n,i),r,n)},u=function(n,r,o){n.stopPropagation(),n.preventDefault(),i();var a=new be(r,o);e.allowEdit&&e.position.board.at(a)&&t.emit("edit",{rotate:a})},l=function(r){r.stopPropagation(),r.preventDefault();var o=n.reservedMove;i(),o&&e.position.isValidMove(o.withPromote())&&t.emit("move",o.withPromote())},p=function(r){r.stopPropagation(),r.preventDefault();var o=n.reservedMove;i(),o&&e.position.isValidMove(o)&&t.emit("move",o)},h=(0,a.Fl)((function(){var t=new Vt(e.pieceImageType,e.boardImageType);return t.preload(),t})),f=(0,a.Fl)((function(){return h.value.build(e.maxSize.reduce(new Yt(20,20)),e.position,e.lastMove,n.pointer,n.reservedMove,e.flip)})),m=function(e,t){return e?ze(Math.ceil(e/1e3)):void 0!==t?""+t:"0:00:00"},v=function(e,t){if(!e&&!t)return"normal";var n=(e||0)/1e3+(t||0);return n<=5?"danger":n<=10?"warning":"normal"},_=(0,a.Fl)((function(){return m(e.blackPlayerTimeMs,e.blackPlayerByoyomi)})),g=(0,a.Fl)((function(){return v(e.blackPlayerTimeMs,e.blackPlayerByoyomi)})),E=(0,a.Fl)((function(){return m(e.whitePlayerTimeMs,e.whitePlayerByoyomi)})),S=(0,a.Fl)((function(){return v(e.whitePlayerTimeMs,e.whitePlayerByoyomi)}));return{clickFrame:r,clickSquare:s,clickHand:c,clickSquareR:u,clickPromote:l,clickNotPromote:p,layout:f,blackPlayerTimeText:_,blackPlayerTimeSeverity:g,whitePlayerTimeText:E,whitePlayerTimeSeverity:S}}}),zt=n(3744);const Jt=(0,zt.Z)(jt,[["render",Y],["__scopeId","data-v-46c90ba8"]]);var $t=Jt,Xt=(n(2526),n(1817),n(9714),n(8309),n(6084));n(8862),n(2707);function Qt(e){return void 0!==e.value?e.value:void 0!==e.default?"string"===e.type&&"<empty>"===e.default?"":e.default:void 0}function en(e,t){e.uri=t.uri,e.name=t.name,Object.keys(t.options).forEach((function(n){e.options[n]&&(e.options[n].value=t.options[n].value)}))}var tn,nn,rn,on=function(){function e(t){if((0,$.Z)(this,e),(0,Q.Z)(this,"engines",void 0),this.engines={},t){var n=JSON.parse(t);n.engines instanceof Object&&(this.engines=n.engines)}}return(0,X.Z)(e,[{key:"hasEngine",value:function(e){return!!this.engines[e]}},{key:"addEngine",value:function(e){this.engines[e.uri]=e}},{key:"updateEngine",value:function(e){return!!this.engines[e.uri]&&(this.engines[e.uri]=e,!0)}},{key:"removeEngine",value:function(e){return!!this.engines[e]&&(delete this.engines[e],!0)}},{key:"getEngine",value:function(e){return this.engines[e]}},{key:"engineList",get:function(){return Object.values(this.engines).sort((function(e,t){return e.name>t.name?1:-1}))}},{key:"json",get:function(){return JSON.stringify(this)}},{key:"jsonWithIndent",get:function(){return JSON.stringify(this,void 0,2)}}]),e}();function an(e){return{pieceImage:Gt.HITOMOJI,boardImage:Bt.LIGHT,pieceVolume:30,clockVolume:30,clockPitch:500,clockSoundTarget:rn.ONLY_USER,boardFlipping:!1,informationTab:nn.RECORD_INFO,returnCode:e||"\r\n"}}(function(e){e["NEW_RECORD"]="newRecord",e["OPEN_RECORD"]="openRecord",e["SAVE_RECORD"]="saveRecord",e["SAVE_RECORD_AS"]="saveRecordAs",e["COPY_RECORD"]="copyRecord",e["PASTE_RECORD"]="pasteRecord",e["REMOVE_RECORD_AFTER"]="remvoeRecordAfter",e["START_POSITION_EDITING"]="startPositionEditing",e["END_POSITION_EDITING"]="endPositionEditing",e["CHANGE_TURN"]="changeTurn",e["INIT_POSITION_STANDARD"]="initPositionStandard",e["INIT_POSITION_HANDICAP_LANCE"]="initPositionHandicapLance",e["INIT_POSITION_HANDICAP_RIGHT_LANCE"]="initPositionHandicapRightLance",e["INIT_POSITION_HANDICAP_BISHOP"]="initPositionHandicapBishop",e["INIT_POSITION_HANDICAP_ROOK"]="initPositionHandicapRook",e["INIT_POSITION_HANDICAP_ROOK_LANCE"]="initPositionHandicapRookLance",e["INIT_POSITION_HANDICAP_2PIECES"]="initPositionHandicap2Pieces",e["INIT_POSITION_HANDICAP_4PIECES"]="initPositionHandicap4Pieces",e["INIT_POSITION_HANDICAP_6PIECES"]="initPositionHandicap6Pieces",e["INIT_POSITION_HANDICAP_8PIECES"]="initPositionHandicap8Pieces",e["INIT_POSITION_TSUME_SHOGI"]="initPositionTsumeShogi",e["START_RESEARCH"]="startResearch",e["STOP_RESEARCH"]="stopResearch",e["START_GAME"]="startGame",e["STOP_GAME"]="stopGame",e["RESIGN"]="resign",e["FLIP_BOARD"]="flipBoard",e["APP_SETTING_DIALOG"]="appSetting",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSetting"})(tn||(tn={})),function(e){e["RECORD_INFO"]="recordInfo",e["COMMENT"]="comment",e["SEARCH"]="search",e["CHART"]="chart",e["INVISIBLE"]="invisible"}(nn||(nn={})),function(e){e["ALL"]="all",e["ONLY_USER"]="onlyUser"}(rn||(rn={}));n(6755);var sn,cn="es://human",un="es://usi-engine/";function ln(e){return e.startsWith(un)}function dn(){return{black:{name:"人",uri:cn},white:{name:"人",uri:cn},timeLimit:{timeSeconds:0,byoyomi:30,increment:0},enableEngineTimeout:!1,humanIsFront:!0}}function pn(e){return 0===e.timeLimit.timeSeconds&&0===e.timeLimit.byoyomi?new Error("持ち時間と秒読みが両方とも0です。"):0!==e.timeLimit.byoyomi&&0!==e.timeLimit.increment?new Error("秒読みとフィッシャールールは併用できません。"):void 0}function hn(){return{}}(function(e){e["APP_SETTING"]="appSetting",e["RESEARCH_SETTING"]="researchSetting",e["GAME_SETTING"]="gameSetting"})(sn||(sn={}));var fn={getRecordPathFromProcArg:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})))()},updateMenuState:function(){},showOpenRecordDialog:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},openRecord:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},showSaveRecordDialog:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},saveRecord:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},showSelectFileDialog:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},loadAppSetting:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(sn.APP_SETTING),t){e.next=3;break}return e.abrupt("return",JSON.stringify(an()));case 3:return e.abrupt("return",JSON.stringify((0,J.Z)((0,J.Z)({},an()),JSON.parse(t))));case 4:case"end":return e.stop()}}),e)})))()},saveAppSetting:function(e){return(0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:localStorage.setItem(sn.APP_SETTING,e);case 1:case"end":return t.stop()}}),t)})))()},loadResearchSetting:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(sn.RESEARCH_SETTING),t){e.next=3;break}return e.abrupt("return",JSON.stringify(hn()));case 3:return e.abrupt("return",JSON.stringify((0,J.Z)((0,J.Z)({},hn()),JSON.parse(t))));case 4:case"end":return e.stop()}}),e)})))()},saveResearchSetting:function(e){return(0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:localStorage.setItem(sn.RESEARCH_SETTING,e);case 1:case"end":return t.stop()}}),t)})))()},loadGameSetting:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(sn.GAME_SETTING),t){e.next=3;break}return e.abrupt("return",JSON.stringify(dn()));case 3:return e.abrupt("return",JSON.stringify((0,J.Z)((0,J.Z)({},dn()),JSON.parse(t))));case 4:case"end":return e.stop()}}),e)})))()},saveGameSetting:function(e){return(0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:localStorage.setItem(sn.GAME_SETTING,e);case 1:case"end":return t.stop()}}),t)})))()},loadUSIEngineSetting:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(new on).json);case 1:case"end":return e.stop()}}),e)})))()},saveUSIEngineSetting:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},showSelectUSIEngineDialog:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},getUSIEngineInfo:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},startResearch:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},endResearch:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw"Web版では利用できない機能です。";case 1:case"end":return e.stop()}}),e)})))()},startGame:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},endGame:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},updateUSIPosition:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},stopUSI:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},sendUSISetOption:function(){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},onSendError:function(){},onMenuEvent:function(){},onUSIBestMove:function(){},onUSIInfo:function(){}};function mn(){return window}function vn(){return!!mn().electronShogiAPI}function _n(){return mn().electronShogiAPI||fn}function gn(){return En.apply(this,arguments)}function En(){return En=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().getRecordPathFromProcArg();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),En.apply(this,arguments)}function Sn(){return wn.apply(this,arguments)}function wn(){return wn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().showOpenRecordDialog();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),wn.apply(this,arguments)}function In(e){return Tn.apply(this,arguments)}function Tn(){return Tn=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().openRecord(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Tn.apply(this,arguments)}function Rn(e){return On.apply(this,arguments)}function On(){return On=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().showSaveRecordDialog(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),On.apply(this,arguments)}function An(e,t){return yn.apply(this,arguments)}function yn(){return yn=(0,i.Z)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().saveRecord(t,n);case 2:case"end":return e.stop()}}),e)}))),yn.apply(this,arguments)}function Nn(){return kn.apply(this,arguments)}function kn(){return kn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().showSelectFileDialog();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),kn.apply(this,arguments)}function bn(){return Pn.apply(this,arguments)}function Pn(){return Pn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,_n().loadAppSetting();case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)}))),Pn.apply(this,arguments)}function Hn(e){return Cn.apply(this,arguments)}function Cn(){return Cn=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().saveAppSetting(JSON.stringify(t));case 2:case"end":return e.stop()}}),e)}))),Cn.apply(this,arguments)}function Dn(){return Ln.apply(this,arguments)}function Ln(){return Ln=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,_n().loadResearchSetting();case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)}))),Ln.apply(this,arguments)}function Mn(e){return xn.apply(this,arguments)}function xn(){return xn=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().saveResearchSetting(JSON.stringify(t));case 2:case"end":return e.stop()}}),e)}))),xn.apply(this,arguments)}function Gn(){return Bn.apply(this,arguments)}function Bn(){return Bn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,_n().loadGameSetting();case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)}))),Bn.apply(this,arguments)}function Zn(e){return Un.apply(this,arguments)}function Un(){return Un=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().saveGameSetting(JSON.stringify(t));case 2:case"end":return e.stop()}}),e)}))),Un.apply(this,arguments)}function Wn(){return Kn.apply(this,arguments)}function Kn(){return Kn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=on,e.next=3,_n().loadUSIEngineSetting();case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)}))),Kn.apply(this,arguments)}function Fn(e){return qn.apply(this,arguments)}function qn(){return qn=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().saveUSIEngineSetting(t.jsonWithIndent);case 2:case"end":return e.stop()}}),e)}))),qn.apply(this,arguments)}function Vn(){return Yn.apply(this,arguments)}function Yn(){return Yn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().showSelectUSIEngineDialog();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Yn.apply(this,arguments)}function jn(e){return zn.apply(this,arguments)}function zn(){return zn=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,_n().getUSIEngineInfo(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)}))),zn.apply(this,arguments)}function Jn(e,t){return $n.apply(this,arguments)}function $n(){return $n=(0,i.Z)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().startResearch(JSON.stringify(t),n);case 2:case"end":return e.stop()}}),e)}))),$n.apply(this,arguments)}function Xn(){return Qn.apply(this,arguments)}function Qn(){return Qn=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().endResearch();case 2:case"end":return e.stop()}}),e)}))),Qn.apply(this,arguments)}function ei(e,t){return ti.apply(this,arguments)}function ti(){return ti=(0,i.Z)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().startGame(JSON.stringify(t),n);case 2:case"end":return e.stop()}}),e)}))),ti.apply(this,arguments)}function ni(e,t){return ii.apply(this,arguments)}function ii(){return ii=(0,i.Z)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().endGame(t,n);case 2:case"end":return e.stop()}}),e)}))),ii.apply(this,arguments)}function ri(e,t,n,i){return oi.apply(this,arguments)}function oi(){return oi=(0,i.Z)(regeneratorRuntime.mark((function e(t,n,i,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().updateUSIPosition(t,JSON.stringify(n),i,r);case 2:case"end":return e.stop()}}),e)}))),oi.apply(this,arguments)}function ai(e){return si.apply(this,arguments)}function si(){return si=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().stopUSI(t);case 2:case"end":return e.stop()}}),e)}))),si.apply(this,arguments)}function ci(e,t){return ui.apply(this,arguments)}function ui(){return ui=(0,i.Z)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_n().sendUSISetOption(t,n);case 2:case"end":return e.stop()}}),e)}))),ui.apply(this,arguments)}function li(e){var t=_n();t.onSendError((function(t){e.commit(wi.PUSH_ERROR,t)})),t.onMenuEvent((function(t){if(!e.getters.isBussy)switch(t){case tn.NEW_RECORD:e.commit(wi.NEW_RECORD);break;case tn.OPEN_RECORD:e.dispatch(Ii.OPEN_RECORD);break;case tn.SAVE_RECORD:e.dispatch(Ii.SAVE_RECORD,{overwrite:!0});break;case tn.SAVE_RECORD_AS:e.dispatch(Ii.SAVE_RECORD);break;case tn.COPY_RECORD:e.dispatch(Ii.COPY_RECORD);break;case tn.PASTE_RECORD:e.commit(wi.SHOW_PASTE_DIALOG);break;case tn.REMOVE_RECORD_AFTER:e.dispatch(Ii.REMOVE_RECORD_AFTER);break;case tn.START_POSITION_EDITING:e.dispatch(Ii.START_POSITION_EDITING);break;case tn.END_POSITION_EDITING:e.dispatch(Ii.END_POSITION_EDITING);break;case tn.CHANGE_TURN:e.commit(wi.CHANGE_TURN);break;case tn.INIT_POSITION_STANDARD:e.dispatch(Ii.INITIALIZE_POSITION,Me.STANDARD);break;case tn.INIT_POSITION_HANDICAP_LANCE:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_LANCE);break;case tn.INIT_POSITION_HANDICAP_RIGHT_LANCE:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_RIGHT_LANCE);break;case tn.INIT_POSITION_HANDICAP_BISHOP:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_BISHOP);break;case tn.INIT_POSITION_HANDICAP_ROOK:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_ROOK);break;case tn.INIT_POSITION_HANDICAP_ROOK_LANCE:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_ROOK_LANCE);break;case tn.INIT_POSITION_HANDICAP_2PIECES:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_2PIECES);break;case tn.INIT_POSITION_HANDICAP_4PIECES:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_4PIECES);break;case tn.INIT_POSITION_HANDICAP_6PIECES:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_6PIECES);break;case tn.INIT_POSITION_HANDICAP_8PIECES:e.dispatch(Ii.INITIALIZE_POSITION,Me.HANDICAP_8PIECES);break;case tn.INIT_POSITION_TSUME_SHOGI:e.dispatch(Ii.INITIALIZE_POSITION,Me.TSUME_SHOGI);break;case tn.START_GAME:e.commit(wi.SHOW_GAME_DIALOG);break;case tn.STOP_GAME:e.dispatch(Ii.STOP_GAME);break;case tn.RESIGN:e.dispatch(Ii.RESIGN_BY_USER);break;case tn.START_RESEARCH:e.commit(wi.SHOW_RESEARCH_DIALOG);break;case tn.STOP_RESEARCH:e.dispatch(Ii.STOP_RESEARCH);break;case tn.FLIP_BOARD:e.commit(wi.FLIP_BOARD);break;case tn.APP_SETTING_DIALOG:e.commit(wi.OPEN_APP_SETTING_DIALOG);break;case tn.USI_ENGINE_SETTING_DIALOG:e.commit(wi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG);break}})),t.onUSIBestMove((function(t,n,i,r){e.dispatch(Ii.DO_MOVE_BY_USI_ENGINE,{sessionID:t,usi:n,color:i,sfen:r})})),t.onUSIInfo((function(t,n,i,r,o){e.dispatch(Ii.UPDATE_USI_INFO,{sessionID:t,usi:n,sender:i,name:r,info:JSON.parse(o)})})),(0,a.YP)((function(){return[e.state.mode,e.getters.isBussy]}),(function(e){var n=(0,Xt.Z)(e,2),i=n[0],r=n[1];t.updateMenuState(i,r)})),t.updateMenuState(e.state.mode,e.getters.isBussy)}var di,pi,hi=n(3907),fi=n(4914),mi=n.n(fi);function vi(e){var t=(null===e||void 0===e?void 0:e.type)||"sine",n=(null===e||void 0===e?void 0:e.frequency)||440,i=(null===e||void 0===e?void 0:e.volume)||2,r=new AudioContext,o=r.createOscillator(),a=r.createGain();return o.connect(a),a.connect(r.destination),o.type=t,o.frequency.value=n,a.gain.value=.005*i,o.onended=function(){a.disconnect(r.destination),o.disconnect(a)},o.start(r.currentTime),null!==e&&void 0!==e&&e.time&&o.stop(r.currentTime+e.time),{stop:function(){null!==e&&void 0!==e&&e.time||o.stop()}}}function _i(e){vi({type:"sine",frequency:e.frequency,time:.1,volume:e.volume})}function gi(e){return vi({type:"sine",frequency:e.frequency,volume:e.volume})}function Ei(e){var t=Date.now();if(!(di&&t<di+200)){var n=new Audio("sound/piece.mp3");n.volume=.01*e,n.play(),di=t}}function Si(e){switch(e){case pi.BLACK_PLAYER:return"先手";case pi.WHITE_PLAYER:return"後手";case pi.RESEARCHER:return"検討"}}(function(e){e["BLACK_PLAYER"]="blackPlayer",e["WHITE_PLAYER"]="whitePlayer",e["RESEARCHER"]="researcher"})(pi||(pi={}));var wi,Ii,Ti,Ri=2e3,Oi=-Ri,Ai=function(){function e(t){if((0,$.Z)(this,e),(0,Q.Z)(this,"evaluation",void 0),t){var n=JSON.parse(t);this.evaluation=n.evaluation}}return(0,X.Z)(e,[{key:"updateScore",value:function(e,t,n){switch(this.evaluation||(this.evaluation={}),t){case pi.BLACK_PLAYER:this.evaluation[pi.BLACK_PLAYER]=n;break;case pi.WHITE_PLAYER:this.evaluation[pi.WHITE_PLAYER]=-n;break;case pi.RESEARCHER:this.evaluation[pi.RESEARCHER]=e===j.BLACK?n:-n;break}}},{key:"updateUSIInfo",value:function(e,t,n){n.scoreCP?this.updateScore(e,t,Math.min(Math.max(n.scoreCP,Oi),Ri)):n.scoreMate&&this.updateScore(e,t,n.scoreMate>=0?Ri:Oi)}},{key:"stringify",value:function(){return JSON.stringify(this)}}]),e}(),yi=function(){function e(){(0,$.Z)(this,e),(0,Q.Z)(this,"black",void 0),(0,Q.Z)(this,"white",void 0),(0,Q.Z)(this,"timerHandle",void 0),(0,Q.Z)(this,"timerStart",void 0),(0,Q.Z)(this,"lastTimeMs",void 0),(0,Q.Z)(this,"_elapsedMs",void 0),(0,Q.Z)(this,"_setting",void 0),this.black={timeMs:0,byoyomi:0},this.white={timeMs:0,byoyomi:0},this.timerHandle=0,this.timerStart=new Date,this.lastTimeMs=0,this._elapsedMs=0,this._setting=dn()}return(0,X.Z)(e,[{key:"blackTimeMs",get:function(){return this.black.timeMs}},{key:"blackByoyomi",get:function(){return this.black.byoyomi}},{key:"whiteTimeMs",get:function(){return this.white.timeMs}},{key:"whiteByoyomi",get:function(){return this.white.byoyomi}},{key:"elapsedMs",get:function(){return this._elapsedMs}},{key:"setting",get:function(){return this._setting}},{key:"setup",value:function(e){this.black.timeMs=1e3*e.timeLimit.timeSeconds,this.black.byoyomi=e.timeLimit.byoyomi,this.white.timeMs=1e3*e.timeLimit.timeSeconds,this.white.byoyomi=e.timeLimit.byoyomi,this._setting=e}},{key:"getPlayerState",value:function(e){switch(e){case j.BLACK:return this.black;case j.WHITE:return this.white}}},{key:"startTimer",value:function(e,t){var n=this,i=this.getPlayerState(e);this.timerStart=new Date,this.lastTimeMs=i.timeMs,i.byoyomi=this.setting.timeLimit.byoyomi,this.timerHandle=window.setInterval((function(){var e=i.timeMs,r=i.byoyomi,o=new Date;n._elapsedMs=o.getTime()-n.timerStart.getTime();var a=n.lastTimeMs-n._elapsedMs;if(a>=0?i.timeMs=a:(i.timeMs=0,i.byoyomi=Math.max(Math.ceil(n.setting.timeLimit.byoyomi+a/1e3),0)),0!==i.timeMs||0!==i.byoyomi){var s=Math.ceil(e/1e3),c=Math.ceil(i.timeMs/1e3),u=i.byoyomi;0===c&&(e>0||u!==r)?u<=5?t.onBeepUnlimited():(u<=10||u%10===0)&&t.onBeepShort():n.setting.timeLimit.byoyomi||c===s||(c<=5?t.onBeepUnlimited():(c<=10||20===c||30===c||60===c)&&t.onBeepShort())}else t.timeout()}),100)}},{key:"increment",value:function(e){this.getPlayerState(e).timeMs+=1e3*this.setting.timeLimit.increment}},{key:"clearTimer",value:function(){this.timerHandle&&(window.clearInterval(this.timerHandle),this.timerHandle=0),this._elapsedMs=0}}]),e}();function Ni(e){var t=ki(e),n=e.metadata.getStandardMetadata(qe.TITLE)||e.metadata.getStandardMetadata(qe.TOURNAMENT)||e.metadata.getStandardMetadata(qe.OPUS_NAME)||e.metadata.getStandardMetadata(qe.OPUS_NO)||e.metadata.getStandardMetadata(qe.PLACE)||e.metadata.getStandardMetadata(qe.POSTED_ON)||e.metadata.getStandardMetadata(qe.AUTHOR);n&&(t+="_"+n);var i=e.metadata.getStandardMetadata(qe.BLACK_NAME)||e.metadata.getStandardMetadata(qe.BLACK_SHORT_NAME);i&&(t+="_"+i);var r=e.metadata.getStandardMetadata(qe.WHITE_NAME)||e.metadata.getStandardMetadata(qe.WHITE_SHORT_NAME);return r&&(t+="_"+r),t+".kif"}function ki(e){var t=e.metadata.getStandardMetadata(qe.DATE);return t?t.trim().replaceAll(" ","_").replaceAll("/","").replaceAll(":",""):(new Date).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}).replaceAll("/","")}(function(e){e["UPDATE_APP_SETTING"]="updateAppSetting",e["FLIP_BOARD"]="flipBoard",e["SHOW_PASTE_DIALOG"]="showPasteDialog",e["CLOSE_PASTE_DIALOG"]="closePasteDialog",e["SHOW_GAME_DIALOG"]="showGameDialog",e["SHOW_RESEARCH_DIALOG"]="showResearchDialog",e["OPEN_APP_SETTING_DIALOG"]="openAppSettingDialog",e["OPEN_USI_ENGINE_MANAGEMENT_DIALOG"]="openUSIEngineManagementDialog",e["CLOSE_DIALOG"]="closeDialog",e["NEW_RECORD"]="newRecord",e["UPDATE_RECORD_COMMENT"]="updateRecordComment",e["UPDATE_STANDARD_RECORD_METADATA"]="updateStandardRecordMetadata",e["CHANGE_TURN"]="changeTurn",e["EDIT_POSITION"]="editPosition",e["CHANGE_MOVE_NUMBER"]="changeMoveNumber",e["CHANGE_BRANCH"]="changeBranch",e["CLEAR_GAME_TIMER"]="clearGameTimer",e["UPDATE_USI_INFO"]="updateUSIInfo",e["PUSH_MESSAGE"]="pushMessage",e["SHIFT_MESSAGE"]="shiftMessage",e["PUSH_ERROR"]="pushError",e["CLEAR_ERRORS"]="clearErrors",e["RETAIN_BUSSY_STATE"]="retainBussyState",e["RELEASE_BUSSY_STATE"]="releaseBussyState"})(wi||(wi={})),function(e){e["UPDATE_APP_SETTING"]="updateAppSetting",e["OPEN_RECORD"]="openRecord",e["SAVE_RECORD"]="saveRecord",e["COPY_RECORD"]="copyRecord",e["PASTE_RECORD"]="pasteRecord",e["REMOVE_RECORD_AFTER"]="removeRecordAfter",e["START_POSITION_EDITING"]="startPositionEditing",e["END_POSITION_EDITING"]="endPositionEditing",e["INITIALIZE_POSITION"]="initializePosition",e["UPDATE_USI_INFO"]="updateUsiInfo",e["START_RESEARCH"]="startResearch",e["STOP_RESEARCH"]="stopResearch",e["START_GAME"]="startGame",e["STOP_GAME"]="stopGame",e["RESIGN_BY_USER"]="resign",e["DO_MOVE_BY_USER"]="doMoveByUser",e["DO_MOVE_BY_USI_ENGINE"]="doMoveByUSIEngine",e["DO_MOVE"]="doMove",e["RESET_GAME_TIMER"]="resetGameTimer",e["BEEP_UNLIMITED"]="beepUnlimited",e["BEEP_SHORT"]="beepShort",e["SHOW_CONFIRMATION"]="showConfirmation",e["CONFIRMATION_OK"]="confirmationOk",e["CONFIRMATION_CANCEL"]="confirmationCancel"}(Ii||(Ii={}));var bi={state:{count:0},getters:{isBussy:function(e){return 0!==e.count}},mutations:(Ti={},(0,Q.Z)(Ti,wi.RETAIN_BUSSY_STATE,(function(e){e.count+=1})),(0,Q.Z)(Ti,wi.RELEASE_BUSSY_STATE,(function(e){e.count-=1})),Ti)};function Pi(e,t){var n,i,r=e.clone(),o="",a=(0,ot.Z)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,c=r.createMoveBySFEN(s);if(!c)break;r.doMove(c,{ignoreValidation:!0}),o+=c.getDisplayText(n),n=c}}catch(u){a.e(u)}finally{a.f()}return o}var Hi,Ci,Di=function(){function e(t){(0,$.Z)(this,e),(0,Q.Z)(this,"name",void 0),(0,Q.Z)(this,"nodes",void 0),(0,Q.Z)(this,"nps",void 0),(0,Q.Z)(this,"iterates",void 0),(0,Q.Z)(this,"hashfull",void 0),(0,Q.Z)(this,"currentMove",void 0),(0,Q.Z)(this,"currentMoveText",void 0),this.name=t,this.iterates=[]}return(0,X.Z)(e,[{key:"update",value:function(e,t){var n={};if(void 0!==t.depth&&(n.depth=t.depth),void 0!==t.seldepth&&(n.selectiveDepth=t.seldepth),void 0!==t.timeMs&&(n.timeMs=t.timeMs),void 0!==t.nodes&&(this.nodes=t.nodes),t.pv&&(n.pv=t.pv,n.text=Pi(e,t.pv)),void 0!==t.multipv&&(n.multiPV=t.multipv),void 0!==t.scoreCP&&(n.score=t.scoreCP),void 0!==t.scoreMate&&(n.scoreMate=t.scoreMate),void 0!==t.lowerbound&&(n.lowerBound=t.lowerbound),void 0!==t.upperbound&&(n.upperBound=t.upperbound),void 0!==t.currmove){this.currentMove=t.currmove;var i=e.createMoveBySFEN(t.currmove);i&&(this.currentMoveText=i.getDisplayText())}void 0!==t.hashfullPerMill&&(this.hashfull=t.hashfullPerMill/1e3),void 0!==t.nps&&(this.nps=t.nps),t.string&&(n.text=t.string),0!==Object.keys(n).length&&this.iterates.unshift(n)}}]),e}(),Li={mutations:(0,Q.Z)({},wi.UPDATE_USI_INFO,(function(e,t){switch(e.sessionID!=t.sessionID&&(e.blackPlayer=void 0,e.whitePlayer=void 0,e.researcher=void 0,e.sessionID=t.sessionID),t.sender){case pi.BLACK_PLAYER:e.blackPlayer&&e.blackPosition===t.position.sfen||(e.blackPlayer=new Di(t.name),e.blackPosition=t.position.sfen),e.blackPlayer.update(t.position,t.info);break;case pi.WHITE_PLAYER:e.whitePlayer&&e.whitePosition===t.position.sfen||(e.whitePlayer=new Di(t.name),e.whitePosition=t.position.sfen),e.whitePlayer.update(t.position,t.info);break;case pi.RESEARCHER:e.researcher&&e.researchPosition===t.position.sfen||(e.researcher=new Di(t.name),e.researchPosition=t.position.sfen),e.researcher.update(t.position,t.info);break}}))};(function(e){e["NORMAL"]="normal",e["PASTE_DIALOG"]="pasteDialog",e["POSITION_EDITING"]="positionEditing",e["GAME"]="game",e["GAME_DIALOG"]="gameDialog",e["RESEARCH"]="research",e["RESEARCH_DIALOG"]="researchDialog",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSettingDialog",e["APP_SETTING_DIALOG"]="appSettingDialog",e["TEMPORARY"]="temporary"})(Hi||(Hi={}));var Mi,xi,Gi,Bi,Zi={state:{queue:[]},getters:{hasMessage:function(e){return 0!==e.queue.length},message:function(e){return e.queue[0]}},mutations:(Ci={},(0,Q.Z)(Ci,wi.PUSH_MESSAGE,(function(e,t){e.queue.push(t)})),(0,Q.Z)(Ci,wi.SHIFT_MESSAGE,(function(e){e.queue.shift()})),Ci)},Ui={state:{queue:[]},getters:{hasError:function(e){return 0!==e.queue.length}},mutations:(Mi={},(0,Q.Z)(Mi,wi.PUSH_ERROR,(function(e,t){t instanceof Error?e.queue.push(t):e.queue.push(new Error(t))})),(0,Q.Z)(Mi,wi.CLEAR_ERRORS,(function(e){e.queue=[]})),Mi)},Wi={state:{},actions:(xi={},(0,Q.Z)(xi,Ii.SHOW_CONFIRMATION,(function(e,t){var n=e.state,i=e.rootState;n.confirmation=t,n.lastMode=i.mode,i.mode=Hi.TEMPORARY})),(0,Q.Z)(xi,Ii.CONFIRMATION_OK,(function(e){var t,n=e.state,i=e.rootState,r=null===(t=n.confirmation)||void 0===t?void 0:t.onOk;n.confirmation=void 0,n.lastMode&&(i.mode=n.lastMode,n.lastMode=void 0),r&&r()})),(0,Q.Z)(xi,Ii.CONFIRMATION_CANCEL,(function(e){var t,n=e.state,i=e.rootState,r=null===(t=n.confirmation)||void 0===t?void 0:t.onCancel;n.confirmation=void 0,n.lastMode&&(i.mode=n.lastMode,n.lastMode=void 0),r&&r()})),xi)},Ki=Symbol();function Fi(){return(0,hi.oR)(Ki)}var qi=(0,hi.MT)({state:{appSetting:an(),record:new it,mode:Hi.NORMAL,usiSessionID:0,game:new yi},modules:{usi:Li,message:Zi,error:Ui,bussy:bi,confirmation:Wi},getters:{isMovableByUser:function(e){switch(e.mode){case Hi.NORMAL:case Hi.RESEARCH:return!0;case Hi.GAME:return(e.record.position.color===j.BLACK?e.game.setting.black.uri:e.game.setting.white.uri)===cn}return!1}},mutations:(Gi={},(0,Q.Z)(Gi,wi.UPDATE_APP_SETTING,(function(e,t){e.appSetting=(0,J.Z)((0,J.Z)({},e.appSetting),t)})),(0,Q.Z)(Gi,wi.FLIP_BOARD,(function(e){e.appSetting.boardFlipping=!e.appSetting.boardFlipping,Hn(e.appSetting)})),(0,Q.Z)(Gi,wi.SHOW_PASTE_DIALOG,(function(e){e.mode===Hi.NORMAL&&(e.mode=Hi.PASTE_DIALOG)})),(0,Q.Z)(Gi,wi.CLOSE_PASTE_DIALOG,(function(e){e.mode===Hi.PASTE_DIALOG&&(e.mode=Hi.NORMAL)})),(0,Q.Z)(Gi,wi.SHOW_GAME_DIALOG,(function(e){e.mode===Hi.NORMAL&&(e.mode=Hi.GAME_DIALOG)})),(0,Q.Z)(Gi,wi.SHOW_RESEARCH_DIALOG,(function(e){e.mode===Hi.NORMAL&&(e.mode=Hi.RESEARCH_DIALOG)})),(0,Q.Z)(Gi,wi.OPEN_APP_SETTING_DIALOG,(function(e){e.mode===Hi.NORMAL&&(e.mode=Hi.APP_SETTING_DIALOG)})),(0,Q.Z)(Gi,wi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG,(function(e){e.mode===Hi.NORMAL&&(e.mode=Hi.USI_ENGINE_SETTING_DIALOG)})),(0,Q.Z)(Gi,wi.CLOSE_DIALOG,(function(e){e.mode!==Hi.USI_ENGINE_SETTING_DIALOG&&e.mode!==Hi.APP_SETTING_DIALOG&&e.mode!==Hi.GAME_DIALOG&&e.mode!==Hi.RESEARCH_DIALOG||(e.mode=Hi.NORMAL)})),(0,Q.Z)(Gi,wi.NEW_RECORD,(function(e){e.mode==Hi.NORMAL&&(e.record.clear(new Ve),e.recordFilePath=void 0)})),(0,Q.Z)(Gi,wi.UPDATE_RECORD_COMMENT,(function(e,t){e.record.current.comment=t})),(0,Q.Z)(Gi,wi.UPDATE_STANDARD_RECORD_METADATA,(function(e,t){e.record.metadata.setStandardMetadata(t.key,t.value)})),(0,Q.Z)(Gi,wi.CHANGE_TURN,(function(e){if(e.mode==Hi.POSITION_EDITING){var t=e.record.position.clone();t.setColor(ee(t.color)),e.record.clear(t)}})),(0,Q.Z)(Gi,wi.EDIT_POSITION,(function(e,t){if(e.mode===Hi.POSITION_EDITING){var n=e.record.position.clone();n.edit(t),e.record.clear(n)}})),(0,Q.Z)(Gi,wi.CHANGE_MOVE_NUMBER,(function(e,t){e.mode!==Hi.NORMAL&&e.mode!==Hi.RESEARCH||e.record.goto(t)})),(0,Q.Z)(Gi,wi.CHANGE_BRANCH,(function(e,t){e.mode!==Hi.NORMAL&&e.mode!==Hi.RESEARCH||e.record.current.branchIndex!==t&&e.record.switchBranchByIndex(t)})),(0,Q.Z)(Gi,wi.CLEAR_GAME_TIMER,(function(e){e.game.clearTimer(),e.beep5sHandler&&(e.beep5sHandler.stop(),e.beep5sHandler=void 0)})),Gi),actions:(Bi={},(0,Q.Z)(Bi,Ii.UPDATE_APP_SETTING,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.commit,r=e.state,n.next=3,Hn((0,J.Z)((0,J.Z)({},r.appSetting),t));case 3:i(wi.UPDATE_APP_SETTING,t);case 4:case"end":return n.stop()}}),n)})))()})),(0,Q.Z)(Bi,Ii.OPEN_RECORD,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r,o,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.commit,r=e.state,r.mode===Hi.NORMAL){n.next=3;break}return n.abrupt("return",!1);case 3:if(i(wi.RETAIN_BUSSY_STATE),n.prev=4,t){n.next=11;break}return n.next=8,Sn();case 8:if(t=n.sent,t){n.next=11;break}return n.abrupt("return",!1);case 11:return n.next=13,In(t);case 13:if(o=n.sent,!t.match(/\.kif$/)&&!t.match(/\.kifu$/)){n.next=21;break}return a=t.match(/\.kif$/)?mi().decode(o,"Shift_JIS"):o.toString(),s=Rt(a),s instanceof it?(r.recordFilePath=t,r.record=s):i(wi.PUSH_ERROR,s),n.abrupt("return",!0);case 21:return i(wi.PUSH_ERROR,"不明なファイル形式: "+t),n.abrupt("return",!1);case 23:n.next=29;break;case 25:return n.prev=25,n.t0=n["catch"](4),i(wi.PUSH_ERROR,"棋譜の読み込み中にエラーが出ました: "+n.t0),n.abrupt("return",!1);case 29:return n.prev=29,i(wi.RELEASE_BUSSY_STATE),n.finish(29);case 32:case"end":return n.stop()}}),n,null,[[4,25,29,32]])})))()})),(0,Q.Z)(Bi,Ii.SAVE_RECORD,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r,o,a,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.commit,r=e.state,r.mode===Hi.NORMAL){n.next=3;break}return n.abrupt("return",!1);case 3:if(i(wi.RETAIN_BUSSY_STATE),n.prev=4,o=r.recordFilePath,null!==t&&void 0!==t&&t.overwrite&&o){n.next=13;break}return a=Ni(r.record),n.next=10,Rn(a);case 10:if(o=n.sent,o){n.next=13;break}return n.abrupt("return",!1);case 13:if(!o.match(/\.kif$/)&&!o.match(/\.kifu$/)){n.next=22;break}return s=Lt(r.record,{returnCode:r.appSetting.returnCode}),c=o.match(/\.kif$/)?mi().encode(s,"Shift_JIS"):Buffer.from(s),n.next=18,An(o,c);case 18:return r.recordFilePath=o,n.abrupt("return",!0);case 22:return i(wi.PUSH_ERROR,"不明なファイル形式: "+o),n.abrupt("return",!1);case 24:n.next=30;break;case 26:return n.prev=26,n.t0=n["catch"](4),i(wi.PUSH_ERROR,"棋譜の保存中にエラーが出ました: "+n.t0),n.abrupt("return",!1);case 30:return n.prev=30,i(wi.RELEASE_BUSSY_STATE),n.finish(30);case 33:case"end":return n.stop()}}),n,null,[[4,26,30,33]])})))()})),(0,Q.Z)(Bi,Ii.COPY_RECORD,(function(e){var t=e.state,n=Lt(t.record,{returnCode:t.appSetting.returnCode});navigator.clipboard.writeText(n)})),(0,Q.Z)(Bi,Ii.PASTE_RECORD,(function(e,t){var n=e.state,i=e.commit;if(n.mode===Hi.NORMAL){var r=Rt(t);r instanceof it?(n.recordFilePath=void 0,n.record=r):i(wi.PUSH_ERROR,r)}})),(0,Q.Z)(Bi,Ii.REMOVE_RECORD_AFTER,(function(e){var t=e.state,n=e.dispatch;if(t.mode===Hi.NORMAL||t.mode===Hi.RESEARCH){var i=t.record.current.next;i&&i.move instanceof De?n(Ii.SHOW_CONFIRMATION,{message:"".concat(t.record.current.number,"手目以降を削除します。よろしいですか？"),onOk:function(){t.record.removeAfter()}}):t.record.removeAfter()}})),(0,Q.Z)(Bi,Ii.START_POSITION_EDITING,(function(e){var t=e.state,n=e.dispatch;t.mode===Hi.NORMAL&&n(Ii.SHOW_CONFIRMATION,{message:"現在の棋譜は削除されます。よろしいですか？",onOk:function(){t.mode=Hi.POSITION_EDITING,t.record.clear(t.record.position),t.recordFilePath=void 0}})})),(0,Q.Z)(Bi,Ii.END_POSITION_EDITING,(function(e){var t=e.state;t.mode===Hi.POSITION_EDITING&&(t.mode=Hi.NORMAL)})),(0,Q.Z)(Bi,Ii.INITIALIZE_POSITION,(function(e,t){var n=e.state,i=e.dispatch;n.mode==Hi.POSITION_EDITING&&i(Ii.SHOW_CONFIRMATION,{message:"現在の局面は破棄されます。よろしいですか？",onOk:function(){var e=new Ve;e.reset(t),n.record.clear(e)}})})),(0,Q.Z)(Bi,Ii.UPDATE_USI_INFO,(function(e,t){var n=e.state,i=e.commit;if(n.usiSessionID===t.sessionID&&n.record.usi==t.usi){i(wi.UPDATE_USI_INFO,{sessionID:t.sessionID,position:n.record.position,sender:t.sender,name:t.name,info:t.info});var r=new Ai(n.record.current.customData);r.updateUSIInfo(n.record.position.color,t.sender,t.info),n.record.current.customData=r.stringify()}})),(0,Q.Z)(Bi,Ii.START_RESEARCH,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.commit,r=e.state,r.mode===Hi.RESEARCH_DIALOG){n.next=3;break}return n.abrupt("return",!1);case 3:return i(wi.RETAIN_BUSSY_STATE),n.prev=4,n.next=7,Mn(t);case 7:return r.usiSessionID+=1,n.next=10,Jn(t,r.usiSessionID);case 10:return r.mode=Hi.RESEARCH,n.abrupt("return",!0);case 14:return n.prev=14,n.t0=n["catch"](4),i(wi.PUSH_ERROR,"検討の初期化中にエラーが出ました: "+n.t0),n.abrupt("return",!1);case 18:return n.prev=18,i(wi.RELEASE_BUSSY_STATE),n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[4,14,18,21]])})))()})),(0,Q.Z)(Bi,Ii.STOP_RESEARCH,(function(e){return(0,i.Z)(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,i=e.state,i.mode===Hi.RESEARCH){t.next=3;break}return t.abrupt("return",!1);case 3:return n(wi.RETAIN_BUSSY_STATE),t.prev=4,t.next=7,Xn();case 7:return i.mode=Hi.NORMAL,t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t["catch"](4),n(wi.PUSH_ERROR,"検討の終了中にエラーが出ました: "+t.t0),t.abrupt("return",!1);case 15:return t.prev=15,n(wi.RELEASE_BUSSY_STATE),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[4,11,15,18]])})))()})),(0,Q.Z)(Bi,Ii.START_GAME,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.commit,r=e.state,r.mode===Hi.GAME_DIALOG){n.next=3;break}return n.abrupt("return",!1);case 3:return i(wi.RETAIN_BUSSY_STATE),n.prev=4,n.next=7,Zn(t);case 7:return t.startPosition&&(o=new Ve,o.reset(t.startPosition),r.record.clear(o),r.recordFilePath=void 0),r.usiSessionID+=1,n.next=11,ei(t,r.usiSessionID);case 11:return r.game.setup(t),r.mode=Hi.GAME,r.record.metadata.setStandardMetadata(qe.BLACK_NAME,t.black.name),r.record.metadata.setStandardMetadata(qe.WHITE_NAME,t.white.name),t.humanIsFront&&(a=r.appSetting.boardFlipping,t.black.uri===cn&&t.white.uri!==cn?a=!1:t.black.uri!==cn&&t.white.uri===cn&&(a=!0),a!==r.appSetting.boardFlipping&&i(wi.FLIP_BOARD)),n.abrupt("return",!0);case 19:return n.prev=19,n.t0=n["catch"](4),i(wi.PUSH_ERROR,"対局の初期化中にエラーが出ました: "+n.t0),n.abrupt("return",!1);case 23:return n.prev=23,i(wi.RELEASE_BUSSY_STATE),n.finish(23);case 26:case"end":return n.stop()}}),n,null,[[4,19,23,26]])})))()})),(0,Q.Z)(Bi,Ii.STOP_GAME,(function(e,t){return(0,i.Z)(regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.commit,r=e.state,r.mode===Hi.GAME){n.next=3;break}return n.abrupt("return",!1);case 3:return t&&i(wi.PUSH_MESSAGE,"対局終了（".concat(tt(t),")")),i(wi.RETAIN_BUSSY_STATE),n.prev=5,n.next=8,ni(r.record.usi,t);case 8:return r.record.append(t||Xe.INTERRUPT),r.record.current.setElapsedMs(r.game.elapsedMs),r.mode=Hi.NORMAL,n.abrupt("return",!0);case 14:return n.prev=14,n.t0=n["catch"](5),i(wi.PUSH_ERROR,"対局の終了中にエラーが出ました: "+n.t0),n.abrupt("return",!1);case 18:return n.prev=18,i(wi.RELEASE_BUSSY_STATE),n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[5,14,18,21]])})))()})),(0,Q.Z)(Bi,Ii.RESIGN_BY_USER,(function(e){var t=e.state,n=e.getters,i=e.dispatch;return t.mode===Hi.GAME&&(n.isMovableByUser?i(Ii.STOP_GAME,Xe.RESIGN):void 0)})),(0,Q.Z)(Bi,Ii.DO_MOVE_BY_USER,(function(e,t){var n=e.dispatch,i=e.state,r=e.getters;return!!r.isMovableByUser&&(i.mode===Hi.GAME&&i.game.increment(i.record.position.color),n(Ii.DO_MOVE,t),!0)})),(0,Q.Z)(Bi,Ii.DO_MOVE_BY_USI_ENGINE,(function(e,t){var n=e.commit,i=e.dispatch,r=e.state;if(r.mode!==Hi.GAME)return!1;if(r.usiSessionID!==t.sessionID)return!1;if(r.record.usi!==t.usi)return!1;if(t.color!==r.record.position.color)return n(wi.PUSH_ERROR,"手番ではないエンジンから指し手を受信しました:"+t.sfen),i(Ii.STOP_GAME,Xe.FOUL_LOSE),!1;if("resign"===t.sfen)return i(Ii.STOP_GAME,Xe.RESIGN),!0;if("win"===t.sfen)return i(Ii.STOP_GAME,Xe.ENTERING_OF_KING),!0;var o=r.record.position.createMoveBySFEN(t.sfen);return o&&r.record.position.isValidMove(o)?(r.game.increment(r.record.position.color),i(Ii.DO_MOVE,o),!0):(n(wi.PUSH_ERROR,"エンジンから不明な指し手を受信しました:"+t.sfen),i(Ii.STOP_GAME,Xe.FOUL_LOSE),!1)})),(0,Q.Z)(Bi,Ii.DO_MOVE,(function(e,t){var n=e.state,i=e.dispatch;if(n.record.append(t,{ignoreValidation:!0}),n.record.current.setElapsedMs(n.game.elapsedMs),Ei(n.appSetting.pieceVolume),n.mode===Hi.GAME){var r=n.record.perpetualCheck;r?r===n.record.position.color?i(Ii.STOP_GAME,Xe.FOUL_LOSE):i(Ii.STOP_GAME,Xe.FOUL_WIN):n.record.repetition&&i(Ii.STOP_GAME,Xe.REPETITION_DRAW)}})),(0,Q.Z)(Bi,Ii.RESET_GAME_TIMER,(function(e){var t=e.dispatch,n=e.getters,i=e.state,r=i.record.position.color;i.game.startTimer(r,{timeout:function(){n.isMovableByUser||i.game.setting.enableEngineTimeout?t(Ii.STOP_GAME,Xe.TIMEOUT):ai(r)},onBeepShort:function(){t(Ii.BEEP_SHORT)},onBeepUnlimited:function(){t(Ii.BEEP_UNLIMITED)}})})),(0,Q.Z)(Bi,Ii.BEEP_UNLIMITED,(function(e){var t=e.state,n=e.getters;(t.appSetting.clockSoundTarget!==rn.ONLY_USER||n.isMovableByUser)&&(t.beep5sHandler||(t.beep5sHandler=gi({frequency:t.appSetting.clockPitch,volume:t.appSetting.clockVolume})))})),(0,Q.Z)(Bi,Ii.BEEP_SHORT,(function(e){var t=e.state,n=e.getters;(t.appSetting.clockSoundTarget!==rn.ONLY_USER||n.isMovableByUser)&&(t.beep5sHandler||_i({frequency:t.appSetting.clockPitch,volume:t.appSetting.clockVolume}))})),Bi)});(0,a.YP)([function(){return qi.state.mode},function(){return qi.state.record.position}],(function(){qi.commit(wi.CLEAR_GAME_TIMER),qi.state.mode===Hi.GAME&&qi.dispatch(Ii.RESET_GAME_TIMER),qi.state.mode!==Hi.GAME&&qi.state.mode!==Hi.RESEARCH||ri(qi.state.record.usi,qi.state.game.setting,qi.state.game.blackTimeMs,qi.state.game.whiteTimeMs)}),{deep:!0});var Vi,Yi,ji=["src"];function zi(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("img",{class:"icon",src:e.source},null,8,ji)}(function(e){e["BUSSY"]="bussy",e["ERROR"]="error",e["INFO"]="info",e["GAME"]="game",e["STOP"]="stop",e["RESIGN"]="resign",e["RESEARCH"]="research",e["END"]="end",e["EDIT"]="edit",e["CHECK"]="check",e["SWAP"]="swap",e["SWAP_H"]="swap_h",e["SETTINGS"]="settings",e["ENGINE_SETTINGS"]="engineSettings",e["FLIP"]="flip",e["PASTE"]="paste",e["COPY"]="copy",e["DELETE"]="delete",e["COMMENT"]="comment",e["BRAIN"]="brain",e["CHART"]="chart",e["ARROW_DROP"]="arrowDrop",e["FIRST"]="first",e["BACK"]="back",e["NEXT"]="next",e["LAST"]="last",e["QUESTION"]="question"})(Yi||(Yi={}));var Ji=(Vi={},(0,Q.Z)(Vi,Yi.BUSSY,"icon/hourglass_empty_white_24dp.svg"),(0,Q.Z)(Vi,Yi.ERROR,"icon/error_outline_white_24dp.svg"),(0,Q.Z)(Vi,Yi.INFO,"icon/info_white_24dp.svg"),(0,Q.Z)(Vi,Yi.GAME,"icon/sports_esports_white_24dp.svg"),(0,Q.Z)(Vi,Yi.STOP,"icon/block_white_24dp.svg"),(0,Q.Z)(Vi,Yi.RESIGN,"icon/flag_white_24dp.svg"),(0,Q.Z)(Vi,Yi.RESEARCH,"icon/science_white_24dp.svg"),(0,Q.Z)(Vi,Yi.END,"icon/do_disturb_on_white_24dp.svg"),(0,Q.Z)(Vi,Yi.EDIT,"icon/app_registration_white_24dp.svg"),(0,Q.Z)(Vi,Yi.CHECK,"icon/check_circle_white_24dp.svg"),(0,Q.Z)(Vi,Yi.SWAP,"icon/swap_vert_white_24dp.svg"),(0,Q.Z)(Vi,Yi.SWAP_H,"icon/swap_horiz_white_24dp.svg"),(0,Q.Z)(Vi,Yi.SETTINGS,"icon/settings_white_24dp.svg"),(0,Q.Z)(Vi,Yi.ENGINE_SETTINGS,"icon/settings_input_component_white_24dp.svg"),(0,Q.Z)(Vi,Yi.FLIP,"icon/flip_camera_android_white_24dp.svg"),(0,Q.Z)(Vi,Yi.PASTE,"icon/content_paste_white_24dp.svg"),(0,Q.Z)(Vi,Yi.COPY,"icon/content_copy_white_24dp.svg"),(0,Q.Z)(Vi,Yi.DELETE,"icon/backspace_white_24dp.svg"),(0,Q.Z)(Vi,Yi.COMMENT,"icon/edit_note_white_24dp.svg"),(0,Q.Z)(Vi,Yi.BRAIN,"icon/psychology_white_24dp.svg"),(0,Q.Z)(Vi,Yi.CHART,"icon/show_chart_white_24dp.svg"),(0,Q.Z)(Vi,Yi.ARROW_DROP,"icon/arrow_drop_down_white_24dp.svg"),(0,Q.Z)(Vi,Yi.FIRST,"icon/first_page_white_24dp.svg"),(0,Q.Z)(Vi,Yi.BACK,"icon/chevron_left_white_24dp.svg"),(0,Q.Z)(Vi,Yi.NEXT,"icon/chevron_right_white_24dp.svg"),(0,Q.Z)(Vi,Yi.LAST,"icon/last_page_white_24dp.svg"),(0,Q.Z)(Vi,Yi.QUESTION,"icon/help_white_24dp.svg"),Vi);Object.values(Ji).forEach((function(e){Ut(e)}));var $i=(0,a.aZ)({name:"ButtonIcon",props:{icon:{type:String,required:!0}},setup:function(e){return{source:Ji[e.icon]}}});const Xi=(0,zt.Z)($i,[["render",zi]]);var Qi=Xi,er=(0,a.aZ)({name:"BoardPane",components:{BoardView:$t,ButtonIcon:Qi},props:{maxSize:{type:Yt,required:!0}},setup:function(){var e=Fi(),t=function(t){e.dispatch(Ii.DO_MOVE_BY_USER,t)},n=function(t){e.commit(wi.EDIT_POSITION,t)},i=function(){e.commit(wi.SHOW_GAME_DIALOG)},r=function(){e.dispatch(Ii.STOP_GAME)},o=function(){e.dispatch(Ii.RESIGN_BY_USER)},s=function(){e.commit(wi.SHOW_RESEARCH_DIALOG)},c=function(){e.dispatch(Ii.STOP_RESEARCH)},u=function(){e.dispatch(Ii.START_POSITION_EDITING)},l=function(){e.dispatch(Ii.END_POSITION_EDITING)},d=function(){e.dispatch(Ii.INITIALIZE_POSITION,Me.STANDARD)},p=function(){e.dispatch(Ii.INITIALIZE_POSITION,Me.TSUME_SHOGI)},h=function(){e.commit(wi.CHANGE_TURN)},f=function(){e.commit(wi.OPEN_APP_SETTING_DIALOG)},m=function(){e.commit(wi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG)},v=function(){e.commit(wi.FLIP_BOARD)},_=function(){e.commit(wi.SHOW_PASTE_DIALOG)},g=function(){e.dispatch(Ii.COPY_RECORD)},E=function(){e.dispatch(Ii.REMOVE_RECORD_AFTER)},S=(0,a.Fl)((function(){return e.state.mode===Hi.POSITION_EDITING})),w=(0,a.Fl)((function(){return e.getters.isMovableByUser})),I=(0,a.Fl)((function(){return e.state.record.position})),T=(0,a.Fl)((function(){var t=e.state.record.current.move;return t instanceof De?t:null})),R=(0,a.Fl)((function(){return e.state.appSetting.pieceImage})),O=(0,a.Fl)((function(){return e.state.appSetting.boardImage})),A=(0,a.Fl)((function(){return e.state.appSetting.boardFlipping})),y=(0,a.Fl)((function(){return e.state.record.metadata.getStandardMetadata(qe.BLACK_NAME)})),N=(0,a.Fl)((function(){return e.state.record.metadata.getStandardMetadata(qe.WHITE_NAME)})),k=(0,a.Fl)((function(){return e.state.mode===Hi.GAME?e.state.game.blackTimeMs:void 0})),b=(0,a.Fl)((function(){return e.state.mode===Hi.GAME?e.state.game.blackByoyomi:void 0})),P=(0,a.Fl)((function(){return e.state.mode===Hi.GAME?e.state.game.whiteTimeMs:void 0})),H=(0,a.Fl)((function(){return e.state.mode===Hi.GAME?e.state.game.whiteByoyomi:void 0})),C=(0,a.Fl)((function(){return{game:e.state.mode===Hi.NORMAL,stop:e.state.mode===Hi.GAME,resign:e.state.mode===Hi.GAME&&e.getters.isMovableByUser,research:e.state.mode===Hi.NORMAL,endResearch:e.state.mode===Hi.RESEARCH,startEditPosition:e.state.mode===Hi.NORMAL,endEditPosition:e.state.mode===Hi.POSITION_EDITING,initPosition:e.state.mode===Hi.POSITION_EDITING,removeAfter:e.state.mode===Hi.NORMAL,paste:e.state.mode===Hi.NORMAL,appSettings:e.state.mode===Hi.NORMAL,engineSettings:e.state.mode===Hi.NORMAL}}));return{pieceImageType:R,boardImageType:O,position:I,lastMove:T,flip:A,blackPlayerName:y,whitePlayerName:N,blackPlayerTimeMs:k,blackPlayerByoyomi:b,whitePlayerTimeMs:P,whitePlayerByoyomi:H,controlStates:C,onMove:t,onEdit:n,onGame:i,onStop:r,onResign:o,onResearch:s,onEndResearch:c,onStartEditPosition:u,onEndEditPosition:l,onInitPositionStandard:d,onInitPositionTsumeShogi:p,onChangeTurn:h,onOpenAppSettings:f,onOpenEngineSettings:m,onFlip:v,onPaste:_,onCopy:g,onRemoveAfter:E,allowEdit:S,allowMove:w}}});const tr=(0,zt.Z)(er,[["render",H],["__scopeId","data-v-7af885f0"]]);var nr=tr;function ir(e,t,n,i,r,o){var s=(0,a.up)("RecordView");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(s,{class:"record",record:e.record,operational:e.isRecordOperational,onGoBegin:e.goBegin,onGoBack:e.goBack,onGoForward:e.goForward,onGoEnd:e.goEnd,onSelectMove:e.selectMove,onSelectBranch:e.selectBranch},null,8,["record","operational","onGoBegin","onGoBack","onGoForward","onGoEnd","onSelectMove","onSelectBranch"])])}var rr={class:"frame"},or={class:"controller"},ar=["disabled"],sr=["disabled"],cr=["disabled"],ur=["disabled"],lr=["disabled"],dr=["selected","value"],pr=["disabled"],hr=["selected","value"];function fr(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",rr,[(0,a._)("div",or,[(0,a._)("button",{class:"control-button",disabled:!e.operational,onClick:t[0]||(t[0]=function(t){return e.goBegin()})},[(0,a.Wm)(s,{class:"icon",icon:"first"})],8,ar),(0,a._)("button",{class:"control-button",disabled:!e.operational,onClick:t[1]||(t[1]=function(t){return e.goBack()})},[(0,a.Wm)(s,{class:"icon",icon:"back"})],8,sr),(0,a._)("button",{class:"control-button",disabled:!e.operational,onClick:t[2]||(t[2]=function(t){return e.goForward()})},[(0,a.Wm)(s,{class:"icon",icon:"next"})],8,cr),(0,a._)("button",{class:"control-button",disabled:!e.operational,onClick:t[3]||(t[3]=function(t){return e.goEnd()})},[(0,a.Wm)(s,{class:"icon",icon:"last"})],8,ur)]),(0,a._)("select",{ref:"moveList",class:"move-list",size:"2",disabled:!e.operational,onChange:t[4]||(t[4]=function(t){return e.changeNumber()})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.moves,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e.number,selected:e.selected,value:e.number},(0,C.zw)(0!==e.number?e.number+" ":"")+" "+(0,C.zw)(e.text)+" "+(0,C.zw)(e.hasBranch?" 分岐":""),9,dr)})),128))],40,lr),(0,a._)("select",{ref:"branchList",class:"branch-list",size:"2",disabled:!e.operational,onChange:t[5]||(t[5]=function(t){return e.changeBranch()})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.branches,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e.index,selected:e.selected,value:e.index},(0,C.zw)(e.text),9,hr)})),128))],40,pr)])])}var mr=(0,a.aZ)({name:"RecordView",components:{ButtonIcon:Qi},props:{record:{type:it,required:!0},operational:{type:Boolean,required:!1}},emits:["goBegin","goBack","goForward","goEnd","selectMove","selectBranch"],setup:function(e,t){var n=(0,d.iH)(null),i=(0,d.iH)(null),r=function(){t.emit("goBegin")},o=function(){t.emit("goBack")},s=function(){t.emit("goForward")},c=function(){t.emit("goEnd")},u=function(){t.emit("selectMove",Number(n.value.value))},l=function(){t.emit("selectBranch",Number(i.value.value))},p=(0,a.Fl)((function(){return 0===e.record.current.number})),h=(0,a.Fl)((function(){var t=[];return e.record.moves.forEach((function(n){t.push({number:n.number,text:n.displayText,hasBranch:n.hasBranch,selected:n===e.record.current})})),t})),f=(0,a.Fl)((function(){if(!e.record.branchBegin.branch)return null;var t,n=[];for(t=e.record.branchBegin;t&&t.move;t=t.branch)n.push({index:n.length,text:t.displayMoveText,selected:t.activeBranch});return n}));return{beginPosSelected:p,moves:h,branches:f,moveList:n,branchList:i,goBegin:r,goBack:o,goForward:s,goEnd:c,changeNumber:u,changeBranch:l}}});const vr=(0,zt.Z)(mr,[["render",fr],["__scopeId","data-v-251a274f"]]);var _r=vr,gr=200,Er=(0,a.aZ)({name:"RecordPane",components:{RecordView:_r},setup:function(){var e=Fi(),t=function(t){e.commit(wi.CHANGE_MOVE_NUMBER,t)},n=function(){t(0)},i=function(){t(e.state.record.current.number-1)},r=function(){t(e.state.record.current.number+1)},o=function(){t(Number.MAX_SAFE_INTEGER)},s=function(e){t(e)},c=function(t){e.commit(wi.CHANGE_BRANCH,t)},u=(0,a.Fl)((function(){return e.state.mode===Hi.NORMAL||e.state.mode===Hi.RESEARCH})),l=(0,a.Fl)((function(){return e.state.record}));return{isRecordOperational:u,record:l,goBegin:n,goBack:i,goForward:r,goEnd:o,selectMove:s,selectBranch:c}}});const Sr=(0,zt.Z)(Er,[["render",ir],["__scopeId","data-v-6a2b9b67"]]);var wr=Sr,Ir=function(e){return(0,a.dD)("data-v-597a21bc"),e=e(),(0,a.Cn)(),e},Tr={class:"root"},Rr={class:"tabs"},Or=(0,a.Uk)(" 棋譜情報 "),Ar=(0,a.Uk)(" 指し手コメント "),yr=(0,a.Uk)(" 思考 "),Nr=(0,a.Uk)(" 形勢グラフ "),kr=(0,a.Uk)(" 最小化 "),br=Ir((function(){return(0,a._)("div",{class:"tab-border"},null,-1)})),Pr={class:"tab-contents"};function Hr(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon"),c=(0,a.up)("RecordInfo"),u=(0,a.up)("RecordComment"),l=(0,a.up)("EngineAnalytics"),d=(0,a.up)("EvaluationChart");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",Tr,[(0,a._)("div",{class:(0,C.C_)(["minimize-padding",{enabled:"invisible"===e.activeTab}])},null,2),(0,a._)("div",Rr,[(0,a._)("span",{class:(0,C.C_)(["tab",{selected:"recordInfo"===e.activeTab}]),onClick:t[0]||(t[0]=function(t){return e.changeSelect("recordInfo")})},[(0,a.Wm)(s,{class:"icon",icon:"recordInfo"}),Or],2),(0,a._)("span",{class:(0,C.C_)(["tab",{selected:"comment"===e.activeTab}]),onClick:t[1]||(t[1]=function(t){return e.changeSelect("comment")})},[(0,a.Wm)(s,{class:"icon",icon:"comment"}),Ar],2),(0,a._)("span",{class:(0,C.C_)(["tab",{selected:"search"===e.activeTab}]),onClick:t[2]||(t[2]=function(t){return e.changeSelect("search")})},[(0,a.Wm)(s,{class:"icon",icon:"brain"}),yr],2),(0,a._)("span",{class:(0,C.C_)(["tab",{selected:"chart"===e.activeTab}]),onClick:t[3]||(t[3]=function(t){return e.changeSelect("chart")})},[(0,a.Wm)(s,{class:"icon",icon:"chart"}),Nr],2),(0,a._)("span",{class:(0,C.C_)(["tab",{selected:"invisible"===e.activeTab}]),onClick:t[4]||(t[4]=function(t){return e.changeSelect("invisible")})},[(0,a.Wm)(s,{class:"icon",icon:"arrowDrop"}),kr],2)]),br,(0,a._)("div",Pr,[(0,a.Wm)(c,{class:(0,C.C_)(["tab-content",{selected:"recordInfo"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,a.Wm)(u,{class:(0,C.C_)(["tab-content",{selected:"comment"===e.activeTab}])},null,8,["class"]),(0,a.Wm)(l,{class:(0,C.C_)(["tab-content",{selected:"search"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,a.Wm)(d,{class:(0,C.C_)(["tab-content",{selected:"chart"===e.activeTab}]),size:e.contentSize},null,8,["class","size"])])])])}var Cr={class:"root"},Dr=["value","readonly"];function Lr(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",Cr,[(0,a._)("textarea",{ref:"textarea",class:"text",value:e.comment,readonly:!!e.readonly,onInput:t[0]||(t[0]=function(){return e.change&&e.change.apply(e,arguments)})},null,40,Dr)])])}var Mr=(0,a.aZ)({name:"RecordComment",setup:function(){var e=Fi(),t=(0,a.Fl)((function(){return e.state.record.current.comment})),n=(0,a.Fl)((function(){return e.state.mode!=Hi.NORMAL})),i=(0,d.iH)(null),r=function(t){var n=t.target.value;e.commit(wi.UPDATE_RECORD_COMMENT,n)};return(0,a.bv)((function(){i.value.addEventListener("copy",(function(e){e.stopPropagation()})),i.value.addEventListener("paste",(function(e){e.stopPropagation()}))})),{textarea:i,comment:t,readonly:n,change:r}}});const xr=(0,zt.Z)(Mr,[["render",Lr],["__scopeId","data-v-eb8b10d8"]]);var Gr=xr,Br={class:"root"};function Zr(e,t,n,i,r,o){var s=(0,a.up)("EngineAnalyticsElement");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",Br,[e.infos.blackPlayer?((0,a.wg)(),(0,a.j4)(s,{key:0,name:e.infos.blackPlayer.name,info:e.infos.blackPlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,a.kq)("",!0),e.infos.whitePlayer?((0,a.wg)(),(0,a.j4)(s,{key:1,name:e.infos.whitePlayer.name,info:e.infos.whitePlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,a.kq)("",!0),e.infos.researcher?((0,a.wg)(),(0,a.j4)(s,{key:2,name:e.infos.researcher.name,info:e.infos.researcher,height:e.elementHeight},null,8,["name","info","height"])):(0,a.kq)("",!0)])])}n(6977);var Ur=function(e){return(0,a.dD)("data-v-787dd2b1"),e=e(),(0,a.Cn)(),e},Wr={class:"root"},Kr={class:"headers"},Fr={class:"header"},qr=Ur((function(){return(0,a._)("span",{class:"label"},"エンジン名: ",-1)})),Vr={class:"value"},Yr={class:"header"},jr=Ur((function(){return(0,a._)("span",{class:"label"},"最善手: ",-1)})),zr={class:"value"},Jr={class:"header"},$r=Ur((function(){return(0,a._)("span",{class:"label"},"秒間探索ノード(NPS): ",-1)})),Xr={class:"value"},Qr={class:"header"},eo=Ur((function(){return(0,a._)("span",{class:"label"},"探索ノード数: ",-1)})),to={class:"value"},no={class:"header"},io=Ur((function(){return(0,a._)("span",{class:"label"},"ハッシュ使用率: ",-1)})),ro={class:"value"},oo=(0,a.uE)('<div class="list-header" data-v-787dd2b1><div class="list-column time" data-v-787dd2b1>経過時間</div><div class="list-column multipv-index" data-v-787dd2b1>順位</div><div class="list-column depth" data-v-787dd2b1>深さ</div><div class="list-column score" data-v-787dd2b1>評価値</div></div>',1),ao={class:"list-column time"},so={class:"list-column multipv-index"},co={class:"list-column depth"},uo={class:"list-column score"},lo={class:"list-column score-flag"},po={class:"list-column text"};function ho(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",Wr,[(0,a._)("div",Kr,[(0,a._)("div",Fr,[qr,(0,a._)("span",Vr,(0,C.zw)(e.name),1)]),(0,a._)("div",Yr,[jr,(0,a._)("span",zr,(0,C.zw)(e.info.currentMoveText||"---"),1)]),(0,a._)("div",Jr,[$r,(0,a._)("span",Xr,(0,C.zw)(e.info.nps||"---"),1)]),(0,a._)("div",Qr,[eo,(0,a._)("span",to,(0,C.zw)(e.info.nodes||"---"),1)]),(0,a._)("div",no,[io,(0,a._)("span",ro,(0,C.zw)(e.info.hashfull?(100*e.info.hashfull).toFixed(1):"---")+" % ",1)])]),oo,(0,a._)("div",{class:"list",style:(0,C.j5)("height:".concat(e.height-36,"px"))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.info.iterates,(function(e,t){return(0,a.wg)(),(0,a.iD)("div",{key:t,class:"list-item"},[(0,a._)("div",ao,(0,C.zw)(e.timeMs?(e.timeMs/1e3).toFixed(1)+"s":""),1),(0,a._)("div",so,(0,C.zw)(e.multiPV||""),1),(0,a._)("div",co,(0,C.zw)(e.depth)+(0,C.zw)(e.selectiveDepth&&e.depth?"/":"")+(0,C.zw)(e.selectiveDepth),1),(0,a._)("div",uo,(0,C.zw)(e.score)+" "+(0,C.zw)(e.scoreMate?e.scoreMate:""),1),(0,a._)("div",lo,(0,C.zw)(e.lowerBound?"++":"")+" "+(0,C.zw)(e.upperBound?"--":"")+" "+(0,C.zw)(e.scoreMate?"詰":""),1),(0,a._)("div",po,(0,C.zw)(e.text),1)])})),128))],4)])])}var fo=(0,a.aZ)({name:"EngineAnalyticsElement",props:{name:{type:String,required:!0},info:{type:Di,required:!0},height:{type:Number,required:!0}}});const mo=(0,zt.Z)(fo,[["render",ho],["__scopeId","data-v-787dd2b1"]]);var vo=mo,_o=(0,a.aZ)({name:"EngineAnalytics",components:{EngineAnalyticsElement:vo},props:{size:{type:Yt,required:!0}},setup:function(e){var t=Fi(),n=(0,a.Fl)((function(){return t.state.usi})),i=(0,a.Fl)((function(){var n=(t.state.usi.blackPlayer?1:0)+(t.state.usi.whitePlayer?1:0)+(t.state.usi.researcher?1:0);return 0!==n?e.size.height/n:0}));return{infos:n,elementHeight:i}}});const go=(0,zt.Z)(_o,[["render",Zr],["__scopeId","data-v-7f58d4c6"]]);var Eo=go,So={class:"root"},wo=["width","height"];function Io(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",So,[(0,a._)("canvas",{ref:"canvas",width:e.size.width.toFixed(0),height:e.size.height.toFixed(0)},null,8,wo)])])}var To=n(2728),Ro=(0,a.aZ)({name:"EvaluationChart",props:{size:{type:Yt,required:!0}},setup:function(e){var t,n=(0,d.iH)(null),i=Fi(),r=function(e,t,n){var i=[];return n.moves.forEach((function(e){var n=new Ai(e.customData),r=n.evaluation&&n.evaluation[t];r&&i.push({x:e.number,y:r})})),{label:Si(t),borderColor:e,data:i,showLine:!0}},o=function(e){return{label:"現在の局面",borderColor:"red",data:[{x:e.current.number,y:Ri},{x:e.current.number,y:Oi}],showLine:!0,pointBorderWidth:0,pointRadius:0}},s=function(e){return[o(e),r("royalblue",pi.BLACK_PLAYER,e),r("darkorange",pi.WHITE_PLAYER,e),r("darkgreen",pi.RESEARCHER,e)]},c=function(e){return{x:{min:0,max:e.length+10},y:{min:Oi,max:Ri}}},u=function(e,t,n){if(null!==e.x){var r=n.scales.x.max-n.scales.x.min,o=n.scales.x.right-n.scales.x.left,a=(e.x-n.scales.x.left)/o*r+n.scales.x.min,s=Math.round(a);i.commit(wi.CHANGE_MOVE_NUMBER,s)}};return(0,a.bv)((function(){var e=n.value,r=e.getContext("2d");t=new To.kL(r,{type:"scatter",data:{datasets:s(i.state.record)},options:{color:"black",animation:{duration:0},maintainAspectRatio:!1,events:["click"],onClick:u}}),t.draw()})),(0,a.Ah)((function(){t.destroy()})),(0,a.YP)((function(){return[i.state.record]}),(function(e){var n=(0,Xt.Z)(e,1),i=n[0];t.data.datasets=s(i),t.options.scales=c(i),t.update()}),{deep:!0}),(0,a.YP)((function(){return[e.size]}),(function(e){var n=(0,Xt.Z)(e,1),i=n[0];t.resize(i.width,i.height)}),{deep:!0}),{canvas:n}}});const Oo=(0,zt.Z)(Ro,[["render",Io],["__scopeId","data-v-c5919bb8"]]);var Ao=Oo,yo={class:"key"},No=["value","onInput"];function ko(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",{class:"root",style:(0,C.j5)("height:".concat(e.size.height,"px"))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.list,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.key,class:"element"},[(0,a._)("div",yo,(0,C.zw)(t.displayName),1),(0,a._)("input",{class:"value-input",value:t.value,onInput:function(n){return e.change(n,t.key)}},null,40,No)])})),128))],4)])}n(1249);var bo=(0,a.aZ)({name:"RecordComment",props:{size:{type:Yt,required:!0}},setup:function(){var e=Fi(),t=(0,a.Fl)((function(){return Object.values(qe).map((function(t){var n=e.state.record.metadata;return{key:t,displayName:$e(t),value:n.getStandardMetadata(t)||""}}))})),n=function(t,n){var i=t.target;e.commit(wi.UPDATE_STANDARD_RECORD_METADATA,{key:n,value:i.value})};return{list:t,change:n}}});const Po=(0,zt.Z)(bo,[["render",ko],["__scopeId","data-v-51f6b1c6"]]);var Ho=Po,Co=30,Do=240+Co,Lo=(0,a.aZ)({name:"InformationPane",components:{RecordComment:Gr,EngineAnalytics:Eo,EvaluationChart:Ao,RecordInfo:Ho,ButtonIcon:Qi},props:{size:{type:Yt,required:!0}},setup:function(e){var t=Fi(),n=function(e){t.dispatch(Ii.UPDATE_APP_SETTING,{informationTab:e})},i=(0,a.Fl)((function(){return t.state.appSetting.informationTab})),r=(0,a.Fl)((function(){return e.size.reduce(new Yt(0,Co))}));return{activeTab:i,contentSize:r,changeSelect:n}}});const Mo=(0,zt.Z)(Lo,[["render",Hr],["__scopeId","data-v-597a21bc"]]);var xo=Mo,Go=(0,a.aZ)({name:"StandardLayout",components:{BoardPane:nr,RecordPane:wr,InformationPane:xo},setup:function(){var e=Fi(),t=(0,d.qj)(new Yt(0,0)),n=(0,d.iH)(0),i=(0,d.iH)(null),r=function(){t.width=window.innerWidth,t.height=window.innerHeight},o=new ResizeObserver((function(e){n.value=e[0].contentRect.height}));(0,a.bv)((function(){r(),window.addEventListener("resize",r),o.observe(i.value)})),(0,a.Ah)((function(){window.removeEventListener("resize",r),o.disconnect()}));var s=(0,a.Fl)((function(){var n=e.state.appSetting.informationTab!==nn.INVISIBLE?Do:Co;return new Yt(t.width-gr,t.height-n)})),c=(0,a.Fl)((function(){return new Yt(t.width,t.height-n.value)}));return{topPane:i,boardPaneMaxSize:s,bottomPaneSize:c}}});const Bo=(0,zt.Z)(Go,[["render",l],["__scopeId","data-v-b930b812"]]);var Zo=Bo,Uo=function(e){return(0,a.dD)("data-v-be412a88"),e=e(),(0,a.Cn)(),e},Wo={ref:"dialog"},Ko=Uo((function(){return(0,a._)("div",{class:"dialog-title"},"対局",-1)})),Fo={class:"dialog-form-area"},qo={class:"players"},Vo={class:"player"},Yo=Uo((function(){return(0,a._)("div",{class:"top-label"},"先手（下手）",-1)})),jo=["value"],zo=["value"],Jo={class:"player"},$o=Uo((function(){return(0,a._)("div",{class:"top-label"},"後手（上手）",-1)})),Xo=["value"],Qo=["value"],ea={class:"players-control"},ta=(0,a.Uk)(" 先後入れ替え "),na={class:"dialog-form-areas-h"},ia={class:"dialog-form-area time-limit"},ra={class:"dialog-form-item"},oa=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-label"},"持ち時間",-1)})),aa=["value"],sa=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"時間",-1)})),ca=["value"],ua=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"分",-1)})),la={class:"dialog-form-item"},da=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-label"},"秒読み",-1)})),pa=["value"],ha=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"秒",-1)})),fa={class:"dialog-form-item"},ma=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-label"},"増加",-1)})),va=["value"],_a=Uo((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"秒",-1)})),ga={class:"dialog-form-area flags"},Ea={class:"dialog-form-item"},Sa=["value"],wa=(0,a.uE)('<option value="current" data-v-be412a88>現在の局面</option><option value="standard" data-v-be412a88>平手</option><option value="handicapLance" data-v-be412a88>香落ち</option><option value="handicapRightLance" data-v-be412a88>右香落ち</option><option value="handicapBishop" data-v-be412a88>角落ち</option><option value="handicapRook" data-v-be412a88>飛車落ち</option><option value="handicapRookLance" data-v-be412a88>飛車香落ち</option><option value="handicap2Pieces" data-v-be412a88>2枚落ち</option><option value="handicap4Pieces" data-v-be412a88>4枚落ち</option><option value="handicap6Pieces" data-v-be412a88>6枚落ち</option><option value="handicap8Pieces" data-v-be412a88>8枚落ち</option>',11),Ia=[wa],Ta={class:"dialog-form-item"},Ra=["checked"],Oa=Uo((function(){return(0,a._)("label",{for:"disable-engine-timeout"},"エンジンの時間切れあり",-1)})),Aa={class:"dialog-form-item"},ya=["checked"],Na=Uo((function(){return(0,a._)("label",{for:"human-is-front"},"人を手前に表示する",-1)})),ka={class:"dialog-main-buttons"};function ba(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",Wo,[Ko,(0,a._)("div",Fo,[(0,a._)("div",qo,[(0,a._)("div",Vo,[Yo,(0,a._)("select",{ref:"blackPlayerSelect",class:"player-select",size:"1",value:e.defaultValues.black.type},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.players,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e.uri,value:e.uri},(0,C.zw)(e.name),9,zo)})),128))],8,jo)]),(0,a._)("div",Jo,[$o,(0,a._)("select",{ref:"whitePlayerSelect",class:"player-select",size:"1",value:e.defaultValues.white.type},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.players,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e.uri,value:e.uri},(0,C.zw)(e.name),9,Qo)})),128))],8,Xo)])]),(0,a._)("div",ea,[(0,a._)("button",{onClick:t[0]||(t[0]=function(){return e.onSwapColor&&e.onSwapColor.apply(e,arguments)})},[(0,a.Wm)(s,{class:"icon",icon:"swap_h"}),ta])])]),(0,a._)("div",na,[(0,a._)("div",ia,[(0,a._)("div",ra,[oa,(0,a._)("input",{ref:"hours",class:"time-input",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.hours},null,8,aa),sa,(0,a._)("input",{ref:"minutes",class:"time-input",type:"number",min:"0",max:"59",step:"1",value:e.defaultValues.timeLimit.minutes},null,8,ca),ua]),(0,a._)("div",la,[da,(0,a._)("input",{ref:"byoyomi",class:"time-input single",type:"number",min:"0",max:"60",step:"1",value:e.defaultValues.timeLimit.byoyomi},null,8,pa),ha]),(0,a._)("div",fa,[ma,(0,a._)("input",{ref:"increment",class:"time-input single",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.increment},null,8,va),_a])]),(0,a._)("div",ga,[(0,a._)("div",Ea,[(0,a._)("select",{ref:"startPosition",value:e.defaultValues.startPosition},Ia,8,Sa)]),(0,a._)("div",Ta,[(0,a._)("input",{id:"disable-engine-timeout",ref:"enableEngineTimeout",type:"checkbox",checked:e.defaultValues.enableEngineTimeout},null,8,Ra),Oa]),(0,a._)("div",Aa,[(0,a._)("input",{id:"human-is-front",ref:"humanIsFront",type:"checkbox",checked:e.defaultValues.humanIsFront},null,8,ya),Na])])]),(0,a._)("div",ka,[(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.onStart()})},"対局開始"),(0,a._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=function(t){return e.onCancel()})},"キャンセル")])],512)])}function Pa(e){e.addEventListener("cancel",(function(e){e.preventDefault(),e.stopPropagation()})),e.addEventListener("copy",(function(e){e.stopPropagation()})),e.addEventListener("paste",(function(e){e.stopPropagation()})),e.showModal()}function Ha(e){return document.getElementById(e)}function Ca(e){var t=Number(e.value),n=Number(e.max),i=Number(e.min);return Math.min(Math.max(t,i),n)}var Da=(0,a.aZ)({name:"GameDialog",components:{ButtonIcon:Qi},setup:function(){var e=Fi(),t=(0,d.iH)(null),n=(0,d.iH)(null),o=(0,d.iH)(null),s=(0,d.iH)(null),c=(0,d.iH)(null),u=(0,d.iH)(null),l=(0,d.iH)(null),p=(0,d.iH)(null),h=(0,d.iH)(null),f=(0,d.iH)(null),m=(0,d.iH)(dn()),v=(0,d.iH)(new on);e.commit(wi.RETAIN_BUSSY_STATE),(0,a.bv)((0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Pa(t.value),n.prev=1,n.next=4,Gn();case 4:return m.value=n.sent,n.next=7,Wn();case 7:v.value=n.sent,e.commit(wi.RELEASE_BUSSY_STATE),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),e.commit(wi.PUSH_ERROR,n.t0),e.commit(wi.CLOSE_DIALOG);case 15:case"end":return n.stop()}}),n,null,[[1,11]])}))));var _=function(e){if(ln(e)){var t=v.value.getEngine(e);return{name:t.name,uri:e,usi:t}}return{name:"人",uri:cn}},g=function(){var t={black:_(n.value.value),white:_(o.value.value),timeLimit:{timeSeconds:60*(60*Ca(s.value)+Ca(c.value)),byoyomi:Ca(u.value),increment:Ca(l.value)},startPosition:"current"!==p.value.value?p.value.value:void 0,enableEngineTimeout:h.value.checked,humanIsFront:f.value.checked},i=pn(t);i?e.commit(wi.PUSH_ERROR,i):e.dispatch(Ii.START_GAME,t)},E=function(){e.commit(wi.CLOSE_DIALOG)},S=function(){var e=[o.value.value,n.value.value];n.value.value=e[0],o.value.value=e[1]},w=(0,a.Fl)((function(){return{black:{type:m.value.black.uri},white:{type:m.value.white.uri},timeLimit:{hours:Math.floor(m.value.timeLimit.timeSeconds/3600),minutes:Math.floor(m.value.timeLimit.timeSeconds/60)%60,byoyomi:m.value.timeLimit.byoyomi,increment:m.value.timeLimit.increment},startPosition:void 0!==m.value.startPosition?m.value.startPosition:"current",enableEngineTimeout:m.value.enableEngineTimeout,humanIsFront:m.value.humanIsFront}})),I=(0,a.Fl)((function(){return[{name:"人",uri:cn}].concat((0,r.Z)(v.value.engineList))}));return{dialog:t,blackPlayerSelect:n,whitePlayerSelect:o,hours:s,minutes:c,byoyomi:u,increment:l,startPosition:p,enableEngineTimeout:h,humanIsFront:f,defaultValues:w,players:I,onStart:g,onCancel:E,onSwapColor:S}}});const La=(0,zt.Z)(Da,[["render",ba],["__scopeId","data-v-be412a88"]]);var Ma=La,xa=function(e){return(0,a.dD)("data-v-35a19322"),e=e(),(0,a.Cn)(),e},Ga={ref:"dialog"},Ba=xa((function(){return(0,a._)("div",{class:"dialog-title"},"検討",-1)})),Za={class:"dialog-form-area"},Ua={class:"dialog-form-item"},Wa=xa((function(){return(0,a._)("div",{class:"dialog-form-item-label"},"エンジン",-1)})),Ka={class:"dialog-form-item-unit"},Fa=["value"],qa=["value"],Va={class:"dialog-main-buttons"};function Ya(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",Ga,[Ba,(0,a._)("div",Za,[(0,a._)("div",Ua,[Wa,(0,a._)("div",Ka,[(0,a._)("select",{ref:"engineSelect",class:"engine-select",size:"1",value:e.defaultValue},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.engines,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e.uri,value:e.uri},(0,C.zw)(e.name),9,qa)})),128))],8,Fa)])])]),(0,a._)("div",Va,[(0,a._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=function(t){return e.onStart()})},"検討開始"),(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.onCancel()})},"キャンセル")])],512)])}var ja=(0,a.aZ)({name:"ResearchDialog",setup:function(){var e=Fi(),t=(0,d.iH)(null),n=(0,d.iH)(null),r=(0,d.iH)(hn()),o=(0,d.iH)(new on);e.commit(wi.RETAIN_BUSSY_STATE),(0,a.bv)((0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Pa(t.value),n.prev=1,n.next=4,Dn();case 4:return r.value=n.sent,n.next=7,Wn();case 7:o.value=n.sent,e.commit(wi.RELEASE_BUSSY_STATE),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),e.commit(wi.PUSH_ERROR,n.t0),e.commit(wi.CLOSE_DIALOG);case 15:case"end":return n.stop()}}),n,null,[[1,11]])}))));var s=function(){var t=n.value.value;if(o.value.hasEngine(t)){var i=o.value.getEngine(t),r={usi:i};e.dispatch(Ii.START_RESEARCH,r)}else e.commit(wi.PUSH_ERROR,"エンジンを選択してください。")},c=function(){e.commit(wi.CLOSE_DIALOG)},u=(0,a.Fl)((function(){return o.value.engineList})),l=(0,a.Fl)((function(){return r.value.usi?r.value.usi.uri:""}));return{dialog:t,engineSelect:n,engines:u,defaultValue:l,onStart:s,onCancel:c}}});const za=(0,zt.Z)(ja,[["render",Ya],["__scopeId","data-v-35a19322"]]);var Ja=za,$a=function(e){return(0,a.dD)("data-v-3cf8f19e"),e=e(),(0,a.Cn)(),e},Xa={ref:"dialog"},Qa=$a((function(){return(0,a._)("div",{class:"dialog-title"},"エンジン管理",-1)})),es={class:"dialog-form-area engine-list"},ts={key:0,class:"engine"},ns=["value"],is={class:"engine-name"},rs=["onClick"],os=["onClick"],as={class:"dialog-main-buttons"};function ss(e,t,n,i,r,o){var s=(0,a.up)("USIEngineOptionDialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("dialog",Xa,[Qa,(0,a._)("div",es,[0===e.engines.length?((0,a.wg)(),(0,a.iD)("div",ts," エンジンが登録されていません。 ")):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.engines,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.uri,class:"engine",value:t.uri},[(0,a._)("div",is,(0,C.zw)(t.name),1),(0,a._)("button",{class:"dialog-button",onClick:function(n){return e.openOptions(t.uri)}}," 設定 ",8,rs),(0,a._)("button",{class:"dialog-button",onClick:function(n){return e.remove(t.uri)}}," 削除 ",8,os)],8,ns)})),128))]),(0,a._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=function(t){return e.add()})},"追加"),(0,a._)("div",as,[(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.saveAndClose()})}," 保存して閉じる "),(0,a._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=function(t){return e.cancel()})},"キャンセル")])],512)]),e.optionDialog?((0,a.wg)(),(0,a.j4)(s,{key:0,"latest-engine-setting":e.optionDialog,onOk:e.optionOk,onCancel:e.optionCancel},null,8,["latest-engine-setting","onOk","onCancel"])):(0,a.kq)("",!0)],64)}var cs=function(e){return(0,a.dD)("data-v-12f02a5e"),e=e(),(0,a.Cn)(),e},us={ref:"dialog"},ls=cs((function(){return(0,a._)("div",{class:"dialog-title"},"エンジン設定",-1)})),ds={class:"dialog-form-area option-list"},ps={class:"option"},hs=cs((function(){return(0,a._)("div",{class:"option-name"},"エンジン名",-1)})),fs={class:"option-unchangeable"},ms={class:"option"},vs=cs((function(){return(0,a._)("div",{class:"option-name"},"作者",-1)})),_s={class:"option-unchangeable"},gs={class:"option"},Es=cs((function(){return(0,a._)("div",{class:"option-name"},"場所",-1)})),Ss={class:"option-unchangeable"},ws={class:"option"},Is=cs((function(){return(0,a._)("div",{class:"option-name"},"表示名",-1)})),Ts={ref:"engineNameInput",class:"option-value-text",type:"text",name:"ElectronShogiEngineName"},Rs={class:"option-name"},Os=["id","min","max","name"],As=["id","name"],ys=["id","name"],Ns=["onClick"],ks=["id"],bs=cs((function(){return(0,a._)("option",{value:""},"既定値",-1)})),Ps=cs((function(){return(0,a._)("option",{value:"true"},"ON",-1)})),Hs=cs((function(){return(0,a._)("option",{value:"false"},"OFF",-1)})),Cs=[bs,Ps,Hs],Ds=["id"],Ls=cs((function(){return(0,a._)("option",{value:""},"既定値",-1)})),Ms=["value"],xs=["onClick"],Gs={class:"dialog-main-buttons"};function Bs(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",us,[ls,(0,a._)("div",ds,[(0,a._)("div",ps,[hs,(0,a._)("div",fs,(0,C.zw)(e.engine.defaultName),1)]),(0,a._)("div",ms,[vs,(0,a._)("div",_s,(0,C.zw)(e.engine.author),1)]),(0,a._)("div",gs,[Es,(0,a._)("div",Ss,(0,C.zw)(e.engine.path),1)]),(0,a._)("div",ws,[Is,(0,a._)("input",Ts,null,512)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options,(function(t){return(0,a.wg)(),(0,a.iD)("div",{key:t.name,class:"option"},[(0,a._)("div",Rs,(0,C.zw)(t.name),1),"spin"===t.type?((0,a.wg)(),(0,a.iD)("input",{key:0,id:t.inputId,class:"option-value-number",type:"number",min:t.min,max:t.max,step:"1",name:t.name},null,8,Os)):(0,a.kq)("",!0),"string"===t.type?((0,a.wg)(),(0,a.iD)("input",{key:1,id:t.inputId,class:"option-value-text",type:"text",name:t.name},null,8,As)):(0,a.kq)("",!0),"filename"===t.type?((0,a.wg)(),(0,a.iD)("input",{key:2,id:t.inputId,class:"option-value-filename",type:"text",name:t.name},null,8,ys)):(0,a.kq)("",!0),"filename"===t.type?((0,a.wg)(),(0,a.iD)("button",{key:3,class:"dialog-button",onClick:function(n){return e.selectFile(t.inputId)}}," 選択 ",8,Ns)):(0,a.kq)("",!0),"check"===t.type?((0,a.wg)(),(0,a.iD)("select",{key:4,id:t.inputId,class:"option-value-check"},Cs,8,ks)):(0,a.kq)("",!0),"combo"===t.type?((0,a.wg)(),(0,a.iD)("select",{key:5,id:t.inputId,class:"option-value-combo"},[Ls,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.vars,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e,value:e},(0,C.zw)(e),9,Ms)})),128))],8,Ds)):(0,a.kq)("",!0),"button"===t.type?((0,a.wg)(),(0,a.iD)("button",{key:6,class:"dialog-button",onClick:function(n){return e.sendOption(t.name)}}," 実行 ",8,xs)):(0,a.kq)("",!0)])})),128))]),(0,a._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=function(t){return e.reset()})}," エンジンの既定値に戻す "),(0,a._)("div",Gs,[(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.ok()})},"OK"),(0,a._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=function(t){return e.cancel()})},"キャンセル")])],512)])}var Zs=(0,a.aZ)({name:"USIEngineOptionDialog",props:{latestEngineSetting:{type:Object,required:!0}},emits:["ok","cancel"],setup:function(e,t){var n=(0,d.iH)(null),r=(0,d.iH)(null),o=Fi(),s=e.latestEngineSetting,c=(0,d.iH)(s),u=(0,a.Fl)((function(){return Object.values(c.value.options).sort((function(e,t){var n=e.name.startsWith("USI_"),i=t.name.startsWith("USI_");return n!==i?n?-1:1:e.name<t.name?-1:1})).map((function(e,t){return(0,J.Z)((0,J.Z)({},e),{},{inputId:"usiEngineOptionDialogOption"+t,value:Qt(e)})}))}));o.commit(wi.RETAIN_BUSSY_STATE),(0,a.bv)((0,i.Z)(regeneratorRuntime.mark((function e(){var t,i,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Pa(n.value),e.prev=1,e.next=4,jn(s.path);case 4:c.value=e.sent,en(c.value,s),r.value.value=c.value.name,t=(0,ot.Z)(u.value);try{for(t.s();!(i=t.n()).done;)a=i.value,l=Ha(a.inputId),l&&void 0!==a.value&&(l.value=a.value+"")}catch(d){t.e(d)}finally{t.f()}e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),o.commit(wi.PUSH_ERROR,e.t0);case 14:return e.prev=14,o.commit(wi.RELEASE_BUSSY_STATE),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))));var l=function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o.commit(wi.RETAIN_BUSSY_STATE),e.prev=1,e.next=4,Nn();case 4:n=e.sent,i=Ha(t),n&&i&&(i.value=n),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),o.commit(wi.PUSH_ERROR,e.t0);case 12:return e.prev=12,o.commit(wi.RELEASE_BUSSY_STATE),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o.commit(wi.RETAIN_BUSSY_STATE),e.prev=1,e.next=4,ci(c.value.path,t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),o.commit(wi.PUSH_ERROR,e.t0);case 9:return e.prev=9,o.commit(wi.RELEASE_BUSSY_STATE),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){r.value.value=c.value.defaultName;var e,t=(0,ot.Z)(u.value);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=Ha(n.inputId);i&&(void 0!==c.value.options[n.name].default?i.value=c.value.options[n.name].default+"":i.value="")}}catch(o){t.e(o)}finally{t.f()}},f=function(){c.value.name=r.value.value;var e,n=(0,ot.Z)(u.value);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=Ha(i.inputId);o&&(c.value.options[i.name].value=o.value?"spin"===i.type?Ca(o):o.value:void 0)}}catch(a){n.e(a)}finally{n.f()}t.emit("ok",c.value)},m=function(){t.emit("cancel")};return{engine:c,dialog:n,engineNameInput:r,options:u,selectFile:l,sendOption:p,reset:h,ok:f,cancel:m}}});const Us=(0,zt.Z)(Zs,[["render",Bs],["__scopeId","data-v-12f02a5e"]]);var Ws=Us,Ks=(0,a.aZ)({name:"USIEngineManagementDialog",components:{USIEngineOptionDialog:Ws},setup:function(){var e=(0,d.iH)(null),t=(0,d.iH)(null),n=(0,d.iH)(new on),r=Fi();r.commit(wi.RETAIN_BUSSY_STATE),(0,a.bv)((0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Pa(e.value),t.prev=1,t.next=4,Wn();case 4:n.value=t.sent,r.commit(wi.RELEASE_BUSSY_STATE),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),r.commit(wi.PUSH_ERROR,t.t0),r.commit(wi.CLOSE_DIALOG);case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))));var o=function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r.commit(wi.RETAIN_BUSSY_STATE),e.next=4,Vn();case 4:if(t=e.sent,t){e.next=7;break}return e.abrupt("return");case 7:return e.t0=n.value,e.next=10,jn(t);case 10:e.t1=e.sent,e.t0.addEngine.call(e.t0,e.t1),e.next=17;break;case 14:e.prev=14,e.t2=e["catch"](0),r.commit(wi.PUSH_ERROR,e.t2);case 17:return e.prev=17,r.commit(wi.RELEASE_BUSSY_STATE),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),s=function(e){n.value.removeEngine(e)},c=function(e){t.value=n.value.getEngine(e)},u=function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r.commit(wi.RETAIN_BUSSY_STATE),e.next=4,Fn(n.value);case 4:r.commit(wi.CLOSE_DIALOG),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),r.commit(wi.PUSH_ERROR,e.t0);case 10:return e.prev=10,r.commit(wi.RELEASE_BUSSY_STATE),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),l=function(){r.commit(wi.CLOSE_DIALOG)},p=function(e){n.value.updateEngine(e),t.value=null},h=function(){t.value=null},f=(0,a.Fl)((function(){return n.value.engineList}));return{optionDialog:t,dialog:e,engines:f,add:o,remove:s,openOptions:c,saveAndClose:u,cancel:l,optionOk:p,optionCancel:h}}});const Fs=(0,zt.Z)(Ks,[["render",ss],["__scopeId","data-v-3cf8f19e"]]);var qs=Fs,Vs=function(e){return(0,a.dD)("data-v-1a02b0d4"),e=e(),(0,a.Cn)(),e},Ys={ref:"dialog"},js=Vs((function(){return(0,a._)("div",{class:"dialog-title"},"アプリ設定",-1)})),zs={class:"dialog-form-area settings"},Js={class:"dialog-form-item"},$s=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"駒画像",-1)})),Xs=["value"],Qs=["value"],ec={class:"dialog-form-item"},tc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"盤画像",-1)})),nc=["value"],ic=["value"],rc={class:"dialog-form-item"},oc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"駒音の大きさ",-1)})),ac=["value"],sc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"%",-1)})),cc={class:"dialog-form-item"},uc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"時計音の大きさ",-1)})),lc=["value"],dc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"%",-1)})),pc={class:"dialog-form-item"},hc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"時計音の高さ",-1)})),fc=["value"],mc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-unit"},"Hz (220 ~ 880)",-1)})),vc={class:"dialog-form-item"},_c=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"時計音の対象",-1)})),gc=["value"],Ec=Vs((function(){return(0,a._)("option",{value:"all"},"全ての手番",-1)})),Sc=Vs((function(){return(0,a._)("option",{value:"onlyUser"},"人の手番のみ",-1)})),wc=[Ec,Sc],Ic={class:"dialog-form-item"},Tc=Vs((function(){return(0,a._)("div",{class:"dialog-form-item-label-wide"},"改行文字",-1)})),Rc=["value"],Oc=Vs((function(){return(0,a._)("option",{value:"crlf"},"CR + LF (Windows)",-1)})),Ac=Vs((function(){return(0,a._)("option",{value:"lf"},"LF (UNIX/Mac)",-1)})),yc=Vs((function(){return(0,a._)("option",{value:"cr"},"CR (90年代Mac)",-1)})),Nc=[Oc,Ac,yc],kc={class:"dialog-main-buttons"};function bc(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",Ys,[js,(0,a._)("div",zs,[(0,a._)("div",Js,[$s,(0,a._)("select",{ref:"pieceImage",value:e.appSetting.pieceImage},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.pieceImageTypes,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e,value:e.value},(0,C.zw)(e.name),9,Qs)})),128))],8,Xs)]),(0,a._)("div",ec,[tc,(0,a._)("select",{ref:"boardImage",value:e.appSetting.boardImage},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.boardImageTypes,(function(e){return(0,a.wg)(),(0,a.iD)("option",{key:e,value:e.value},(0,C.zw)(e.name),9,ic)})),128))],8,nc)]),(0,a._)("div",rc,[oc,(0,a._)("input",{ref:"pieceVolume",value:e.appSetting.pieceVolume,type:"number",max:"100",min:"0"},null,8,ac),sc]),(0,a._)("div",cc,[uc,(0,a._)("input",{ref:"clockVolume",value:e.appSetting.clockVolume,type:"number",max:"100",min:"0"},null,8,lc),dc]),(0,a._)("div",pc,[hc,(0,a._)("input",{ref:"clockPitch",value:e.appSetting.clockPitch,type:"number",max:"880",min:"220"},null,8,fc),mc]),(0,a._)("div",vc,[_c,(0,a._)("select",{ref:"clockSoundTarget",value:e.appSetting.clockSoundTarget},wc,8,gc)]),(0,a._)("div",Ic,[Tc,(0,a._)("select",{ref:"returnCode",value:e.appSetting.returnCode},Nc,8,Rc)])]),(0,a._)("div",kc,[(0,a._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=function(t){return e.saveAndClose()})}," 保存して閉じる "),(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.cancel()})},"キャンセル")])],512)])}var Pc={"\r\n":"crlf","\n":"lf","\r":"cr"},Hc={crlf:"\r\n",lf:"\n",cr:"\r"},Cc=(0,a.aZ)({name:"AppSettingDialog",setup:function(){var e=Fi(),t=(0,d.iH)(null),n=(0,d.iH)(null),r=(0,d.iH)(null),o=(0,d.iH)(null),s=(0,d.iH)(null),c=(0,d.iH)(null),u=(0,d.iH)(null),l=(0,d.iH)(null);(0,a.bv)((function(){Pa(t.value)}));var p=function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={pieceImage:n.value.value,boardImage:r.value.value,pieceVolume:Ca(o.value),clockVolume:Ca(s.value),clockPitch:Ca(c.value),clockSoundTarget:u.value.value,returnCode:Hc[l.value.value]},e.commit(wi.RETAIN_BUSSY_STATE),t.prev=2,t.next=5,e.dispatch(Ii.UPDATE_APP_SETTING,i);case 5:e.commit(wi.CLOSE_DIALOG),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),e.commit(wi.PUSH_ERROR,t.t0);case 11:return t.prev=11,e.commit(wi.RELEASE_BUSSY_STATE),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[2,8,11,14]])})));return function(){return t.apply(this,arguments)}}(),h=function(){e.commit(wi.CLOSE_DIALOG)},f=(0,a.Fl)((function(){return(0,J.Z)((0,J.Z)({},e.state.appSetting),{},{returnCode:Pc[e.state.appSetting.returnCode]})})),m=[{name:"一文字駒",value:Gt.HITOMOJI},{name:"一文字駒（ゴシック体）",value:Gt.HITOMOJI_GOTHIC}],v=[{name:"木目（明るい）",value:Bt.LIGHT},{name:"木目（暖かい）",value:Bt.WARM},{name:"塩化ビニル",value:Bt.RESIN}];return{dialog:t,pieceImage:n,boardImage:r,pieceVolume:o,clockVolume:s,clockPitch:c,clockSoundTarget:u,returnCode:l,appSetting:f,pieceImageTypes:m,boardImageTypes:v,saveAndClose:p,cancel:h}}});const Dc=(0,zt.Z)(Cc,[["render",bc],["__scopeId","data-v-1a02b0d4"]]);var Lc=Dc,Mc=function(e){return(0,a.dD)("data-v-01a25e3a"),e=e(),(0,a.Cn)(),e},xc={ref:"dialog"},Gc={ref:"content"},Bc={class:"dialog-form-area"},Zc=Mc((function(){return(0,a._)("div",{class:"message"},"以下の棋譜を取り込みます。",-1)})),Uc={key:0,class:"message"},Wc=(0,a.Uk)(" ※テキストエリアに棋譜を貼り付けてください。"),Kc=Mc((function(){return(0,a._)("br",null,null,-1)})),Fc=(0,a.Uk)(" ※インストールアプリ版では自動的に貼り付けられます。 "),qc=[Wc,Kc,Fc],Vc={ref:"textarea"},Yc={class:"dialog-main-buttons"};function jc(e,t,n,i,r,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",xc,[(0,a._)("div",Gc,[(0,a._)("div",Bc,[Zc,e.isNative?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Uc,qc)),(0,a._)("textarea",Vc,null,512)])],512),(0,a._)("div",Yc,[(0,a._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=function(){return e.onOk&&e.onOk.apply(e,arguments)})},"取り込む"),(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(){return e.onCancel&&e.onCancel.apply(e,arguments)})},"キャンセル")])],512)])}var zc=(0,a.aZ)({name:"PasteDialog",setup:function(){var e=Fi(),t=(0,d.iH)(null),n=(0,d.iH)(null);e.commit(wi.RETAIN_BUSSY_STATE),(0,a.bv)((0,i.Z)(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(i.prev=0,Pa(t.value),!vn()){i.next=6;break}return i.next=5,navigator.clipboard.readText();case 5:n.value.value=i.sent;case 6:return i.prev=6,e.commit(wi.RELEASE_BUSSY_STATE),i.finish(6);case 9:case"end":return i.stop()}}),i,null,[[0,,6,9]])}))));var r=function(){var t=n.value.value;e.commit(wi.CLOSE_PASTE_DIALOG),t&&e.dispatch(Ii.PASTE_RECORD,t)},o=function(){e.commit(wi.CLOSE_PASTE_DIALOG)};return{dialog:t,textarea:n,onOk:r,onCancel:o,isNative:vn()}}});const Jc=(0,zt.Z)(zc,[["render",jc],["__scopeId","data-v-01a25e3a"]]);var $c=Jc,Xc=function(e){return(0,a.dD)("data-v-4939dcf2"),e=e(),(0,a.Cn)(),e},Qc={ref:"dialog",class:"bussy"},eu={class:"content"},tu=Xc((function(){return(0,a._)("div",{class:"message"},"処理中です。お待ち下さい。",-1)}));function nu(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",Qc,[(0,a._)("div",eu,[(0,a.Wm)(s,{class:"icon",icon:"bussy"}),tu])],512)])}var iu=(0,a.aZ)({name:"BussyMessage",components:{ButtonIcon:Qi},setup:function(){var e=(0,d.iH)(null);return(0,a.bv)((function(){Pa(e.value)})),{dialog:e}}});const ru=(0,zt.Z)(iu,[["render",nu],["__scopeId","data-v-4939dcf2"]]);var ou=ru,au={ref:"dialog"},su={class:"content"},cu={class:"message"},uu={class:"dialog-main-buttons"};function lu(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",au,[(0,a._)("div",su,[(0,a.Wm)(s,{class:"icon",icon:"question"}),(0,a._)("div",cu,(0,C.zw)(e.confirmation.message),1)]),(0,a._)("div",uu,[(0,a._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=function(t){return e.onOk()})},"OK"),(0,a._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=function(t){return e.onClose()})},"キャンセル")])],512)])}var du=(0,a.aZ)({name:"InfoMessage",components:{ButtonIcon:Qi},setup:function(){var e=Fi(),t=(0,d.iH)(null),n=(0,a.Fl)((function(){return e.state.confirmation.confirmation}));(0,a.bv)((function(){Pa(t.value)}));var i=function(){e.dispatch(Ii.CONFIRMATION_OK)},r=function(){e.dispatch(Ii.CONFIRMATION_CANCEL)};return{dialog:t,confirmation:n,onOk:i,onClose:r}}});const pu=(0,zt.Z)(du,[["render",lu]]);var hu=pu,fu={ref:"dialog"},mu={class:"content"},vu={class:"message"},_u={class:"dialog-main-buttons"};function gu(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",fu,[(0,a._)("div",mu,[(0,a.Wm)(s,{class:"icon",icon:"info"}),(0,a._)("div",vu,(0,C.zw)(e.message),1)]),(0,a._)("div",_u,[(0,a._)("button",{onClick:t[0]||(t[0]=function(t){return e.onClose()})},"閉じる")])],512)])}var Eu=(0,a.aZ)({name:"InfoMessage",components:{ButtonIcon:Qi},setup:function(){var e=Fi(),t=(0,d.iH)(null);(0,a.bv)((function(){Pa(t.value)}));var n=(0,a.Fl)((function(){return e.getters.message})),i=function(){e.commit(wi.SHIFT_MESSAGE)};return{dialog:t,message:n,onClose:i}}});const Su=(0,zt.Z)(Eu,[["render",gu]]);var wu=Su,Iu={ref:"dialog",class:"error"},Tu={class:"content"},Ru={class:"items"},Ou={class:"notice"},Au={class:"index"},yu={class:"message"},Nu={class:"dialog-main-buttons"};function ku(e,t,n,i,r,o){var s=(0,a.up)("ButtonIcon");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("dialog",Iu,[(0,a._)("div",Tu,[(0,a.Wm)(s,{class:"icon",icon:"error"}),(0,a._)("div",Ru,[(0,a._)("div",Ou,(0,C.zw)(e.errors.length)+" 件のエラーが発生しました。 ",1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.errors,(function(e){return(0,a.wg)(),(0,a.iD)("div",{key:e.index,class:"item"},[(0,a._)("p",Au,(0,C.zw)(e.index+1)+" 件目",1),(0,a._)("p",yu,(0,C.zw)(e.message),1)])})),128))])]),(0,a._)("div",Nu,[(0,a._)("button",{onClick:t[0]||(t[0]=function(t){return e.onClose()})},"閉じる")])],512)])}var bu=(0,a.aZ)({name:"ErrorMessage",components:{ButtonIcon:Qi},setup:function(){var e=Fi(),t=(0,d.iH)(null);(0,a.bv)((function(){Pa(t.value)}));var n=(0,a.Fl)((function(){return e.state.error.queue.map((function(e,t){return{message:e.message,index:t}}))})),i=function(){e.commit(wi.CLEAR_ERRORS)};return{dialog:t,errors:n,onClose:i}}});const Pu=(0,zt.Z)(bu,[["render",ku],["__scopeId","data-v-520b2a4a"]]);var Hu=Pu;function Cu(){var e=document.activeElement;return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement}function Du(e,t){if(!Cu())switch(e){case"ArrowUp":return t.onArrowUp;case"ArrowDown":return t.onArrowDown;case"ArrowLeft":return t.onArrowLeft;case"ArrowRight":return t.onArrowRight}}function Lu(e){document.addEventListener("keydown",(function(t){var n=Du(t.key,e);n&&(t.preventDefault(),n())}))}var Mu=(0,a.aZ)({name:"App",components:{StandardLayout:Zo,GameDialog:Ma,ResearchDialog:Ja,USIEngineManagementDialog:qs,AppSettingDialog:Lc,PasteDialog:$c,BussyMessage:ou,ConfirmDialog:hu,InfoMessage:wu,ErrorMessage:Hu},setup:function(){var e=Fi(),t=(0,a.Fl)((function(){return{game:e.state.mode===Hi.GAME_DIALOG,research:e.state.mode===Hi.RESEARCH_DIALOG,usiEngineSetting:e.state.mode===Hi.USI_ENGINE_SETTING_DIALOG,appSetting:e.state.mode===Hi.APP_SETTING_DIALOG,paste:e.state.mode===Hi.PASTE_DIALOG,bussy:e.getters.isBussy,confirm:e.state.confirmation.confirmation}})),n=(0,a.Fl)((function(){return e.getters.hasMessage})),i=(0,a.Fl)((function(){return e.getters.hasError}));return(0,a.bv)((function(){var t=document.getElementsByTagName("body")[0];t.addEventListener("copy",(function(t){e.dispatch(Ii.COPY_RECORD),t.preventDefault()})),t.addEventListener("paste",(function(t){e.commit(wi.SHOW_PASTE_DIALOG),t.preventDefault()})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("drop",(function(t){if(t.dataTransfer&&t.dataTransfer.files[0]){var n=t.dataTransfer.files[0].path;e.dispatch(Ii.OPEN_RECORD,n)}t.preventDefault()})),Lu({onArrowUp:function(){var t=e.state.record.current.number;e.commit(wi.CHANGE_MOVE_NUMBER,t-1)},onArrowDown:function(){var t=e.state.record.current.number;e.commit(wi.CHANGE_MOVE_NUMBER,t+1)},onArrowLeft:function(){e.commit(wi.CHANGE_MOVE_NUMBER,0)},onArrowRight:function(){e.commit(wi.CHANGE_MOVE_NUMBER,Number.MAX_SAFE_INTEGER)}})})),{dialogVisibilities:t,hasMessage:n,hasErrors:i}}});const xu=(0,zt.Z)(Mu,[["render",s]]);var Gu=xu;To.kL.register.apply(To.kL,(0,r.Z)(To.zX)),li(qi),Promise.allSettled([bn().then((function(e){qi.commit(wi.UPDATE_APP_SETTING,e)})).catch((function(e){qi.commit(wi.PUSH_ERROR,new Error("アプリ設定の読み込み中にエラーが発生しました :"+e))})),(0,i.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,gn();case 2:if(t=e.sent,!t){e.next=6;break}return e.next=6,qi.dispatch(Ii.OPEN_RECORD,t);case 6:case"end":return e.stop()}}),e)})))()]).finally((function(){(0,o.ri)(Gu).use(qi,Ki).mount("#app")}))},5832:function(){}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,i,r,o){if(!i){var a=1/0;for(l=0;l<e.length;l++){i=e[l][0],r=e[l][1],o=e[l][2];for(var s=!0,c=0;c<i.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(s=!1,o<a&&(a=o));if(s){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[i,r,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={826:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var r,o,a=i[0],s=i[1],c=i[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)var l=c(n)}for(t&&t(i);u<a.length;u++)o=a[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(l)},i=self["webpackChunkelectron_shogi"]=self["webpackChunkelectron_shogi"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(9647)}));i=n.O(i)})();
//# sourceMappingURL=index-legacy.87d24128.js.map