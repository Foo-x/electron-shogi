(function(){var e={4945:function(e,t,i){"use strict";i(1703);var n=i(9963),o=i(6252);function a(e,t,i,n,a,s){const r=(0,o.up)("StandardLayout"),c=(0,o.up)("GameDialog"),l=(0,o.up)("ResearchDialog"),u=(0,o.up)("USIEngineManagementDialog"),d=(0,o.up)("AppSettingDialog"),h=(0,o.up)("PasteDialog"),p=(0,o.up)("BussyMessage"),m=(0,o.up)("InfoMessage"),_=(0,o.up)("ErrorMessage");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r,{class:"main"}),e.dialogVisibilities.game?((0,o.wg)(),(0,o.j4)(c,{key:0})):(0,o.kq)("",!0),e.dialogVisibilities.research?((0,o.wg)(),(0,o.j4)(l,{key:1})):(0,o.kq)("",!0),e.dialogVisibilities.usiEngineSetting?((0,o.wg)(),(0,o.j4)(u,{key:2})):(0,o.kq)("",!0),e.dialogVisibilities.appSetting?((0,o.wg)(),(0,o.j4)(d,{key:3})):(0,o.kq)("",!0),e.dialogVisibilities.paste?((0,o.wg)(),(0,o.j4)(h,{key:4})):(0,o.kq)("",!0),e.dialogVisibilities.processing?((0,o.wg)(),(0,o.j4)(p,{key:5})):(0,o.kq)("",!0),e.hasMessage?((0,o.wg)(),(0,o.j4)(m,{key:6})):(0,o.kq)("",!0),e.hasErrors?((0,o.wg)(),(0,o.j4)(_,{key:7})):(0,o.kq)("",!0)],64)}const s={class:"main"},r={ref:"topPane",class:"top-pane"};function c(e,t,i,n,a,c){const l=(0,o.up)("BoardPane"),u=(0,o.up)("RecordPane"),d=(0,o.up)("InformationPane");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",s,[(0,o._)("div",r,[(0,o.Wm)(l,{class:"top-left-pane","max-size":e.boardPaneMaxSize},null,8,["max-size"]),(0,o.Wm)(u,{class:"top-right-pane"})],512),(0,o.Wm)(d,{class:"bottom-pane",size:e.bottomPaneSize},null,8,["size"])])])}var l=i(2262);const u={class:"control top"},d=(0,o.Uk)(" 対局 "),h=(0,o.Uk)(" 中断 "),p=(0,o.Uk)(" 投了 "),m=(0,o.Uk)(" 検討 "),_=(0,o.Uk)(" 検討終了 "),g=(0,o.Uk)(" 局面編集 "),E=(0,o.Uk)(" 局面編集終了 "),S=(0,o.Uk)(" 手番変更 "),v={class:"control bottom"},f=["disabled"],I=(0,o.Uk)(" アプリ設定 "),T=["disabled"],w=(0,o.Uk)(" エンジン設定 "),A=(0,o.Uk)(" 盤面反転 "),O=["disabled"],R=(0,o.Uk)(" 棋譜貼り付け "),N=(0,o.Uk)(" 棋譜コピー "),P=(0,o.Uk)(" 指し手削除 ");function y(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon"),c=(0,o.up)("BoardView");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(c,{"layout-type":e.layout,"max-size":e.maxSize,position:e.position,"last-move":e.lastMove,flip:e.flip,"allow-move":e.allowMove,"allow-edit":e.allowEdit,"black-player-name":e.blackPlayerName,"white-player-name":e.whitePlayerName,"black-player-time-ms":e.blackPlayerTimeMs,"black-player-byoyomi":e.blackPlayerByoyomi,"white-player-time-ms":e.whitePlayerTimeMs,"white-player-byoyomi":e.whitePlayerByoyomi,onMove:e.onMove,onEdit:e.onEdit},{"right-control":(0,o.w5)((()=>[(0,o._)("div",u,[e.controlStates.game?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.onGame&&e.onGame(...t))},[(0,o.Wm)(r,{class:"icon",icon:"game"}),d])):(0,o.kq)("",!0),e.controlStates.stop?((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:t[1]||(t[1]=(...t)=>e.onStop&&e.onStop(...t))},[(0,o.Wm)(r,{class:"icon",icon:"stop"}),h])):(0,o.kq)("",!0),e.controlStates.resign?((0,o.wg)(),(0,o.iD)("button",{key:2,onClick:t[2]||(t[2]=(...t)=>e.onResign&&e.onResign(...t))},[(0,o.Wm)(r,{class:"icon",icon:"resign"}),p])):(0,o.kq)("",!0),e.controlStates.research?((0,o.wg)(),(0,o.iD)("button",{key:3,onClick:t[3]||(t[3]=(...t)=>e.onResearch&&e.onResearch(...t))},[(0,o.Wm)(r,{class:"icon",icon:"research"}),m])):(0,o.kq)("",!0),e.controlStates.endResearch?((0,o.wg)(),(0,o.iD)("button",{key:4,onClick:t[4]||(t[4]=(...t)=>e.onEndResearch&&e.onEndResearch(...t))},[(0,o.Wm)(r,{class:"icon",icon:"end"}),_])):(0,o.kq)("",!0),e.controlStates.startEditPosition?((0,o.wg)(),(0,o.iD)("button",{key:5,onClick:t[5]||(t[5]=(...t)=>e.onStartEditPosition&&e.onStartEditPosition(...t))},[(0,o.Wm)(r,{class:"icon",icon:"edit"}),g])):(0,o.kq)("",!0),e.controlStates.endEditPosition?((0,o.wg)(),(0,o.iD)("button",{key:6,onClick:t[6]||(t[6]=(...t)=>e.onEndEditPosition&&e.onEndEditPosition(...t))},[(0,o.Wm)(r,{class:"icon",icon:"check"}),E])):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:7,onClick:t[7]||(t[7]=(...t)=>e.onChangeTurn&&e.onChangeTurn(...t))},[(0,o.Wm)(r,{class:"icon",icon:"swap"}),S])):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:8,onClick:t[8]||(t[8]=(...t)=>e.onInitPositionStandard&&e.onInitPositionStandard(...t))}," 平手 ")):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:9,onClick:t[9]||(t[9]=(...t)=>e.onInitPositionTsumeShogi&&e.onInitPositionTsumeShogi(...t))}," 詰将棋 ")):(0,o.kq)("",!0)])])),"left-control":(0,o.w5)((()=>[(0,o._)("div",v,[(0,o._)("button",{disabled:!e.controlStates.appSettings,onClick:t[10]||(t[10]=(...t)=>e.onOpenAppSettings&&e.onOpenAppSettings(...t))},[(0,o.Wm)(r,{class:"icon",icon:"settings"}),I],8,f),(0,o._)("button",{disabled:!e.controlStates.engineSettings,onClick:t[11]||(t[11]=(...t)=>e.onOpenEngineSettings&&e.onOpenEngineSettings(...t))},[(0,o.Wm)(r,{class:"icon",icon:"engineSettings"}),w],8,T),(0,o._)("button",{onClick:t[12]||(t[12]=(...t)=>e.onFlip&&e.onFlip(...t))},[(0,o.Wm)(r,{class:"icon",icon:"flip"}),A]),(0,o._)("button",{disabled:!e.controlStates.paste,onClick:t[13]||(t[13]=(...t)=>e.onPaste&&e.onPaste(...t))},[(0,o.Wm)(r,{class:"icon",icon:"paste"}),R],8,O),(0,o._)("button",{onClick:t[14]||(t[14]=(...t)=>e.onCopy&&e.onCopy(...t))},[(0,o.Wm)(r,{class:"icon",icon:"copy"}),N]),(0,o._)("button",{onClick:t[15]||(t[15]=(...t)=>e.onRemoveAfter&&e.onRemoveAfter(...t))},[(0,o.Wm)(r,{class:"icon",icon:"delete"}),P])])])),_:1},8,["layout-type","max-size","position","last-move","flip","allow-move","allow-edit","black-player-name","white-player-name","black-player-time-ms","black-player-byoyomi","white-player-time-ms","white-player-byoyomi","onMove","onEdit"])])}var b=i(3577);const H=["src"],k={class:"player-name-text"},C={class:"clock-text"},D={class:"player-name-text"},L={class:"clock-text"},M=["src"],G=["onClick","onContextmenu"],B=["src"],x=["onClick"],U=["src"],W=["onClick"],K=["src"],F=["src"];function q(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{class:"frame",style:(0,b.j5)(e.layout.frame.style),onClick:t[2]||(t[2]=t=>e.clickFrame())},[(0,o._)("div",{class:"board",style:(0,b.j5)(e.layout.board.style)},[(0,o._)("img",{class:"board-image",src:e.layout.board.imagePath},null,8,H)],4),(0,o._)("div",{class:(0,b.C_)(["player-name",{active:"black"==e.position.color}]),style:(0,b.j5)(e.layout.blackPlayerName.style)},[(0,o._)("span",k,"▲"+(0,b.zw)(e.blackPlayerName),1)],6),(0,o._)("div",{class:(0,b.C_)(["clock",e.blackPlayerTimeSeverity]),style:(0,b.j5)(e.layout.blackClock.style)},[(0,o._)("span",C,(0,b.zw)(e.blackPlayerTimeText),1)],6),(0,o._)("div",{class:(0,b.C_)(["player-name",{active:"white"==e.position.color}]),style:(0,b.j5)(e.layout.whitePlayerName.style)},[(0,o._)("span",D,"△"+(0,b.zw)(e.whitePlayerName),1)],6),(0,o._)("div",{class:(0,b.C_)(["clock",e.whitePlayerTimeSeverity]),style:(0,b.j5)(e.layout.whiteClock.style)},[(0,o._)("span",L,(0,b.zw)(e.whitePlayerTimeText),1)],6),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.square,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"square",style:(0,b.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.piece,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,b.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,M)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.square,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"square",style:(0,b.j5)(t.style),onClick:i=>e.clickSquare(i,t.file,t.rank),onContextmenu:i=>e.clickSquareR(i,t.file,t.rank)},null,44,G)))),128)),(0,o._)("div",{class:"hand",style:(0,b.j5)(e.layout.blackHand.style)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pointers,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"hand-pointer",style:(0,b.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pieces,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,b.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,B)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pointers,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"hand-pointer",style:(0,b.j5)(t.style),onClick:i=>e.clickHand(i,"black",t.type)},null,12,x)))),128))],4),(0,o._)("div",{class:"hand",style:(0,b.j5)(e.layout.whiteHand.style)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pointers,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"hand-pointer",style:(0,b.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pieces,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,b.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,U)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pointers,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"hand-pointer",style:(0,b.j5)(t.style),onClick:i=>e.clickHand(i,"white",t.type)},null,12,W)))),128))],4),e.layout.promotion?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"promotion-selector",style:(0,b.j5)(e.layout.promotion.style)},[(0,o._)("div",{class:"select-button promote",onClick:t[0]||(t[0]=t=>e.clickPromote(t))},[(0,o._)("img",{class:"piece-image",src:e.layout.promotion.promoteImagePath},null,8,K)]),(0,o._)("div",{class:"select-button not-promote",onClick:t[1]||(t[1]=t=>e.clickNotPromote(t))},[(0,o._)("img",{class:"piece-image",src:e.layout.promotion.notPromoteImagePath},null,8,F)])],4)):(0,o.kq)("",!0),(0,o._)("div",{class:"turn",style:(0,b.j5)(e.layout.turn.style)},"手番",4),(0,o._)("div",{style:(0,b.j5)(e.layout.control.left.style)},[(0,o.WI)(e.$slots,"left-control",{},void 0,!0)],4),(0,o._)("div",{style:(0,b.j5)(e.layout.control.right.style)},[(0,o.WI)(e.$slots,"right-control",{},void 0,!0)],4)],4)])}i(7686),i(4506);var V,j,Y=i(2482);function Z(e){return e===V.BLACK?V.WHITE:V.BLACK}function z(e){return e===V.BLACK?"b":"w"}function J(e){return"b"===e||"w"===e}function $(e){return"b"===e?V.BLACK:V.WHITE}(function(e){e["BLACK"]="black",e["WHITE"]="white"})(V||(V={})),function(e){e["PAWN"]="pawn",e["LANCE"]="lance",e["KNIGHT"]="knight",e["SILVER"]="silver",e["GOLD"]="gold",e["BISHOP"]="bishop",e["ROOK"]="rook",e["KING"]="king",e["PROM_PAWN"]="promPawn",e["PROM_LANCE"]="promLance",e["PROM_KNIGHT"]="promKnight",e["PROM_SILVER"]="promSilver",e["HORSE"]="horse",e["DRAGON"]="dragon"}(j||(j={}));const X={pawn:"歩",lance:"香",knight:"桂",silver:"銀",gold:"金",bishop:"角",rook:"飛",king:"玉",promPawn:"と",promLance:"成香",promKnight:"成桂",promSilver:"成銀",horse:"馬",dragon:"竜"};function Q(e){const t=X[e];return t||""}j.PAWN,j.LANCE,j.KNIGHT,j.SILVER,j.GOLD,j.BISHOP,j.ROOK,j.KING,j.PROM_PAWN,j.PROM_LANCE,j.PROM_KNIGHT,j.PROM_SILVER,j.HORSE,j.DRAGON;const ee=[j.PAWN,j.LANCE,j.KNIGHT,j.SILVER,j.GOLD,j.BISHOP,j.ROOK],te={pawn:!0,lance:!0,knight:!0,silver:!0,gold:!1,bishop:!0,rook:!0,king:!1,promPawn:!1,promLance:!1,promKnight:!1,promSilver:!1,horse:!1,dragon:!1},ie={pawn:j.PROM_PAWN,lance:j.PROM_LANCE,knight:j.PROM_KNIGHT,silver:j.PROM_SILVER,bishop:j.HORSE,rook:j.DRAGON},ne={promPawn:j.PAWN,promLance:j.LANCE,promKnight:j.KNIGHT,promSilver:j.SILVER,horse:j.BISHOP,dragon:j.ROOK},oe={pawn:"P",lance:"L",knight:"N",silver:"S",gold:"G",bishop:"B",rook:"R",king:"K",promPawn:"+P",promLance:"+L",promKnight:"+N",promSilver:"+S",horse:"+B",dragon:"+R"};function ae(e){return oe[e]}const se={pawn:"p",lance:"l",knight:"n",silver:"s",gold:"g",bishop:"b",rook:"r",king:"k",promPawn:"+p",promLance:"+l",promKnight:"+n",promSilver:"+s",horse:"+b",dragon:"+r"},re={P:j.PAWN,L:j.LANCE,N:j.KNIGHT,S:j.SILVER,G:j.GOLD,B:j.BISHOP,R:j.ROOK,K:j.KING,"+P":j.PROM_PAWN,"+L":j.PROM_LANCE,"+N":j.PROM_KNIGHT,"+S":j.PROM_SILVER,"+B":j.HORSE,"+R":j.DRAGON,p:j.PAWN,l:j.LANCE,n:j.KNIGHT,s:j.SILVER,g:j.GOLD,b:j.BISHOP,r:j.ROOK,k:j.KING,"+p":j.PROM_PAWN,"+l":j.PROM_LANCE,"+n":j.PROM_KNIGHT,"+s":j.PROM_SILVER,"+b":j.HORSE,"+r":j.DRAGON},ce={P:V.BLACK,L:V.BLACK,N:V.BLACK,S:V.BLACK,G:V.BLACK,B:V.BLACK,R:V.BLACK,K:V.BLACK,"+P":V.BLACK,"+L":V.BLACK,"+N":V.BLACK,"+S":V.BLACK,"+B":V.BLACK,"+R":V.BLACK,p:V.WHITE,l:V.WHITE,n:V.WHITE,s:V.WHITE,g:V.WHITE,b:V.WHITE,r:V.WHITE,k:V.WHITE,"+p":V.WHITE,"+l":V.WHITE,"+n":V.WHITE,"+s":V.WHITE,"+b":V.WHITE,"+r":V.WHITE},le=new Map;le.set(j.PAWN,{type:j.PROM_PAWN,reverseColor:!1}),le.set(j.LANCE,{type:j.PROM_LANCE,reverseColor:!1}),le.set(j.KNIGHT,{type:j.PROM_KNIGHT,reverseColor:!1}),le.set(j.SILVER,{type:j.PROM_SILVER,reverseColor:!1}),le.set(j.GOLD,{type:j.GOLD,reverseColor:!0}),le.set(j.BISHOP,{type:j.HORSE,reverseColor:!1}),le.set(j.ROOK,{type:j.DRAGON,reverseColor:!1}),le.set(j.KING,{type:j.KING,reverseColor:!0}),le.set(j.PROM_PAWN,{type:j.PAWN,reverseColor:!0}),le.set(j.PROM_LANCE,{type:j.LANCE,reverseColor:!0}),le.set(j.PROM_KNIGHT,{type:j.KNIGHT,reverseColor:!0}),le.set(j.PROM_SILVER,{type:j.SILVER,reverseColor:!0}),le.set(j.HORSE,{type:j.BISHOP,reverseColor:!0}),le.set(j.DRAGON,{type:j.ROOK,reverseColor:!0});class ue{constructor(e,t){(0,Y.Z)(this,"color",void 0),(0,Y.Z)(this,"type",void 0),this.type=t,this.color=e}black(){return this.withColor(V.BLACK)}white(){return this.withColor(V.WHITE)}withColor(e){return new ue(e,this.type)}equals(e){return this.type===e.type&&this.color===e.color}promoted(){const e=ie[this.type];return new ue(this.color,e||this.type)}unpromoted(){const e=ne[this.type];return new ue(this.color,e||this.type)}isPromotable(){return!!te[this.type]}rotate(){const e=le.get(this.type),t=new ue(this.color,e?e.type:this.type);return e&&e.reverseColor&&(t.color=Z(this.color)),t}get id(){return this.color+"_"+this.type}get sfen(){switch(this.color){default:case V.BLACK:return oe[this.type];case V.WHITE:return se[this.type]}}static isValidSFEN(e){return!!re[e]}static newBySFEN(e){const t=re[e];if(!t)return null;const i=ce[e];return i?new ue(i,t):null}}var de;(function(e){e["UP"]="up",e["DOWN"]="down",e["LEFT"]="left",e["RIGHT"]="right",e["LEFT_UP"]="left_up",e["RIGHT_UP"]="right_up",e["LEFT_DOWN"]="left_down",e["RIGHT_DOWN"]="right_down",e["LEFT_UP_KNIGHT"]="left_up_knight",e["RIGHT_UP_KNIGHT"]="right_up_knight",e["LEFT_DOWN_KNIGHT"]="left_down_knight",e["RIGHT_DOWN_KNIGHT"]="right_down_knight"})(de||(de={}));const he={up:de.DOWN,down:de.UP,left:de.RIGHT,right:de.LEFT,left_up:de.RIGHT_DOWN,right_up:de.LEFT_DOWN,left_down:de.RIGHT_UP,right_down:de.LEFT_UP,left_up_knight:de.RIGHT_DOWN_KNIGHT,right_up_knight:de.LEFT_DOWN_KNIGHT,left_down_knight:de.RIGHT_UP_KNIGHT,right_down_knight:de.LEFT_UP_KNIGHT};function pe(e){return he[e]}const me=[de.UP,de.DOWN,de.LEFT,de.RIGHT,de.LEFT_UP,de.RIGHT_UP,de.LEFT_DOWN,de.RIGHT_DOWN,de.LEFT_UP_KNIGHT,de.RIGHT_UP_KNIGHT,de.LEFT_DOWN_KNIGHT,de.RIGHT_DOWN_KNIGHT];var _e;(function(e){e["SHORT"]="short",e["LONG"]="long"})(_e||(_e={}));const ge={black:{pawn:{up:_e.SHORT},lance:{up:_e.LONG},knight:{left_up_knight:_e.SHORT,right_up_knight:_e.SHORT},silver:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left_down:_e.SHORT,right_down:_e.SHORT},gold:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},bishop:{left_up:_e.LONG,right_up:_e.LONG,left_down:_e.LONG,right_down:_e.LONG},rook:{up:_e.LONG,left:_e.LONG,right:_e.LONG,down:_e.LONG},king:{left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promPawn:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promLance:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promKnight:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promSilver:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},horse:{left_up:_e.LONG,right_up:_e.LONG,left_down:_e.LONG,right_down:_e.LONG,up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},dragon:{up:_e.LONG,left:_e.LONG,right:_e.LONG,down:_e.LONG,left_up:_e.SHORT,right_up:_e.SHORT,left_down:_e.SHORT,right_down:_e.SHORT}},white:{pawn:{down:_e.SHORT},lance:{down:_e.LONG},knight:{left_down_knight:_e.SHORT,right_down_knight:_e.SHORT},silver:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT},gold:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},bishop:{left_down:_e.LONG,right_down:_e.LONG,left_up:_e.LONG,right_up:_e.LONG},rook:{down:_e.LONG,left:_e.LONG,right:_e.LONG,up:_e.LONG},king:{left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promPawn:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promLance:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promKnight:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promSilver:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},horse:{left_down:_e.LONG,right_down:_e.LONG,left_up:_e.LONG,right_up:_e.LONG,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},dragon:{down:_e.LONG,left:_e.LONG,right:_e.LONG,up:_e.LONG,left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT}}};function Ee(e){return Object.keys(ge[e.color][e.type])}function Se(e,t){return ge[e.color][e.type][t]}const ve={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},left_up:{x:-1,y:-1},right_up:{x:1,y:-1},left_down:{x:-1,y:1},right_down:{x:1,y:1},left_up_knight:{x:-1,y:-2},right_up_knight:{x:1,y:-2},left_down_knight:{x:-1,y:2},right_down_knight:{x:1,y:2}};function fe(e,t){if(1===e&&-2===t)return{direction:de.RIGHT_UP_KNIGHT,distance:1,ok:!0};if(-1===e&&-2===t)return{direction:de.LEFT_UP_KNIGHT,distance:1,ok:!0};if(1===e&&2===t)return{direction:de.RIGHT_DOWN_KNIGHT,distance:1,ok:!0};if(-1===e&&2===t)return{direction:de.LEFT_DOWN_KNIGHT,distance:1,ok:!0};if(0!==e&&0!==t&&Math.abs(e)!==Math.abs(t))return{direction:"",distance:0,ok:!1};let i=e,n=t,o=0;return 0!==i&&(o=Math.abs(i),i/=o),0!==n&&(o=Math.abs(n),n/=o),-1===i&&-1===n?{direction:de.LEFT_UP,distance:o,ok:!0}:0===i&&-1===n?{direction:de.UP,distance:o,ok:!0}:1===i&&-1===n?{direction:de.RIGHT_UP,distance:o,ok:!0}:-1===i&&0===n?{direction:de.LEFT,distance:o,ok:!0}:1===i&&0===n?{direction:de.RIGHT,distance:o,ok:!0}:-1===i&&1===n?{direction:de.LEFT_DOWN,distance:o,ok:!0}:0===i&&1===n?{direction:de.DOWN,distance:o,ok:!0}:1===i&&1===n?{direction:de.RIGHT_DOWN,distance:o,ok:!0}:{direction:"",distance:0,ok:!1}}function Ie(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}function Te(e){switch(e){case"a":return 1;case"b":return 2;case"c":return 3;case"d":return 4;case"e":return 5;case"f":return 6;case"g":return 7;case"h":return 8;case"i":return 9;default:return null}}const we=["a","b","c","d","e","f","g","h","i"];class Ae{constructor(e,t){(0,Y.Z)(this,"file",void 0),(0,Y.Z)(this,"rank",void 0),this.file=e,this.rank=t}get x(){return 9-this.file}get y(){return this.rank-1}get index(){return 9*this.y+this.x}get opposite(){return new Ae(10-this.file,10-this.rank)}neighbor(e,t){switch(e){case de.UP:return new Ae(this.file,this.rank-1);case de.DOWN:return new Ae(this.file,this.rank+1);case de.LEFT:return new Ae(this.file+1,this.rank);case de.RIGHT:return new Ae(this.file-1,this.rank);case de.LEFT_UP:return new Ae(this.file+1,this.rank-1);case de.RIGHT_UP:return new Ae(this.file-1,this.rank-1);case de.LEFT_DOWN:return new Ae(this.file+1,this.rank+1);case de.RIGHT_DOWN:return new Ae(this.file-1,this.rank+1);case de.LEFT_UP_KNIGHT:return new Ae(this.file+1,this.rank-2);case de.RIGHT_UP_KNIGHT:return new Ae(this.file-1,this.rank-2);case de.LEFT_DOWN_KNIGHT:return new Ae(this.file+1,this.rank+2);case de.RIGHT_DOWN_KNIGHT:return new Ae(this.file-1,this.rank+2)}const i=e,n=t;return new Ae(this.file-i,this.rank+n)}get valid(){return this.file>=1&&this.file<=9&&this.rank>=1&&this.rank<=9}equals(e){return!!e&&this.file===e.file&&this.rank===e.rank}static newByXY(e,t){return new Ae(9-e,t+1)}static newByIndex(e){return new Ae(9-e%9,Math.trunc(e/9)+1)}get sfen(){return this.file+we[this.rank-1]}static parseSFENSquare(e){const t=Ie(e[0]),i=Te(e[1]);return t&&i?new Ae(t,i):null}}(0,Y.Z)(Ae,"all",[]);for(let Mc=0;Mc<81;Mc+=1)Ae.all.push(Ae.newByIndex(Mc));const Oe=["１","２","３","４","５","６","７","８","９"],Re=["一","二","三","四","五","六","七","八","九"];class Ne{constructor(e,t,i,n,o,a){(0,Y.Z)(this,"from",void 0),(0,Y.Z)(this,"to",void 0),(0,Y.Z)(this,"promote",void 0),(0,Y.Z)(this,"color",void 0),(0,Y.Z)(this,"pieceType",void 0),(0,Y.Z)(this,"capturedPieceType",void 0),this.from=e,this.to=t,this.promote=i,this.color=n,this.pieceType=o,this.capturedPieceType=a}equals(e){return!!e&&((this.from instanceof Ae&&e.from instanceof Ae&&this.from.equals(e.from)||!(this.from instanceof Ae)&&!(e.from instanceof Ae)&&this.from===e.from)&&this.to.equals(e.to)&&this.promote===e.promote&&this.color===e.color&&this.pieceType===e.pieceType&&this.capturedPieceType===e.capturedPieceType)}withPromote(){return new Ne(this.from,this.to,!0,this.color,this.pieceType,this.capturedPieceType)}getDisplayText(e){let t="";if(t+=this.color===V.BLACK?"▲":"△",e&&e.to.equals(this.to)?t+="同":(t+=Oe[this.to.file-1],t+=Re[this.to.rank-1]),t+=Q(this.pieceType),this.promote&&(t+="成"),this.from instanceof Ae){const e=this.from;t+=` (${e.file}${e.rank})`}else t+="打";return t}get sfen(){let e="";return this.from instanceof Ae?e+=this.from.sfen:e+=ae(this.from)+"*",e+=this.to.sfen,this.promote&&(e+="+"),e}}function Pe(e){let t;if("*"===e[1]){const i=ue.newBySFEN(e[0]);if(!i)return null;t=i.type}else{const i=Ae.parseSFENSquare(e);if(!i)return null;t=i}const i=Ae.parseSFENSquare(e.substring(2));if(!i)return null;const n=e.length>=5&&"+"===e[4];return{from:t,to:i,promote:n}}var ye;function be(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}(function(e){e["STANDARD"]="standard",e["EMPTY"]="empty",e["HANDICAP_LANCE"]="handicapLance",e["HANDICAP_RIGHT_LANCE"]="handicapRightLance",e["HANDICAP_BISHOP"]="handicapBishop",e["HANDICAP_ROOK"]="handicapRook",e["HANDICAP_ROOK_LANCE"]="handicapRookLance",e["HANDICAP_2PIECES"]="handicap2Pieces",e["HANDICAP_4PIECES"]="handicap4Pieces",e["HANDICAP_6PIECES"]="handicap6Pieces",e["HANDICAP_8PIECES"]="handicap8Pieces",e["TSUME_SHOGI"]="tsumeShogi"})(ye||(ye={}));class He{constructor(){(0,Y.Z)(this,"squares",void 0),this.squares=new Array;for(let e=0;e<81;e+=1)this.squares.push(null);this.reset(ye.STANDARD)}at(e){return this.squares[e.index]}set(e,t){this.squares[e.index]=t}swap(e,t){const i=this.squares[e.index];this.squares[e.index]=this.squares[t.index],this.squares[t.index]=i}remove(e){const t=this.squares[e.index];return this.squares[e.index]=null,t}listNonEmptySquares(){const e=new Array;return Ae.all.forEach((t=>{this.squares[t.index]&&e.push(t)})),e}listSquaresByColor(e){const t=new Array;return Ae.all.forEach((i=>{const n=this.squares[i.index];n&&n.color===e&&t.push(i)})),t}clear(){Ae.all.forEach((e=>{this.squares[e.index]=null}))}reset(e){if(this.clear(),e!==ye.EMPTY&&(this.squares[new Ae(5,1).index]=new ue(V.WHITE,j.KING),e!==ye.TSUME_SHOGI))switch(this.squares[new Ae(5,9).index]=new ue(V.BLACK,j.KING),this.squares[new Ae(2,8).index]=new ue(V.BLACK,j.ROOK),this.squares[new Ae(8,2).index]=new ue(V.WHITE,j.ROOK),this.squares[new Ae(8,8).index]=new ue(V.BLACK,j.BISHOP),this.squares[new Ae(2,2).index]=new ue(V.WHITE,j.BISHOP),this.squares[new Ae(4,9).index]=new ue(V.BLACK,j.GOLD),this.squares[new Ae(6,9).index]=new ue(V.BLACK,j.GOLD),this.squares[new Ae(6,1).index]=new ue(V.WHITE,j.GOLD),this.squares[new Ae(4,1).index]=new ue(V.WHITE,j.GOLD),this.squares[new Ae(3,9).index]=new ue(V.BLACK,j.SILVER),this.squares[new Ae(7,9).index]=new ue(V.BLACK,j.SILVER),this.squares[new Ae(7,1).index]=new ue(V.WHITE,j.SILVER),this.squares[new Ae(3,1).index]=new ue(V.WHITE,j.SILVER),this.squares[new Ae(2,9).index]=new ue(V.BLACK,j.KNIGHT),this.squares[new Ae(8,9).index]=new ue(V.BLACK,j.KNIGHT),this.squares[new Ae(8,1).index]=new ue(V.WHITE,j.KNIGHT),this.squares[new Ae(2,1).index]=new ue(V.WHITE,j.KNIGHT),this.squares[new Ae(1,9).index]=new ue(V.BLACK,j.LANCE),this.squares[new Ae(9,9).index]=new ue(V.BLACK,j.LANCE),this.squares[new Ae(9,1).index]=new ue(V.WHITE,j.LANCE),this.squares[new Ae(1,1).index]=new ue(V.WHITE,j.LANCE),this.squares[new Ae(1,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(2,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(3,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(4,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(5,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(6,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(7,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(8,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(9,7).index]=new ue(V.BLACK,j.PAWN),this.squares[new Ae(1,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(2,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(3,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(4,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(5,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(6,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(7,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(8,3).index]=new ue(V.WHITE,j.PAWN),this.squares[new Ae(9,3).index]=new ue(V.WHITE,j.PAWN),e){default:case ye.STANDARD:return;case ye.HANDICAP_LANCE:return void(this.squares[new Ae(1,1).index]=null);case ye.HANDICAP_RIGHT_LANCE:return void(this.squares[new Ae(9,1).index]=null);case ye.HANDICAP_BISHOP:return void(this.squares[new Ae(2,2).index]=null);case ye.HANDICAP_ROOK:return void(this.squares[new Ae(8,2).index]=null);case ye.HANDICAP_ROOK_LANCE:return this.squares[new Ae(8,2).index]=null,void(this.squares[new Ae(1,1).index]=null);case ye.HANDICAP_2PIECES:return this.squares[new Ae(8,2).index]=null,void(this.squares[new Ae(2,2).index]=null);case ye.HANDICAP_4PIECES:return this.squares[new Ae(8,2).index]=null,this.squares[new Ae(2,2).index]=null,this.squares[new Ae(1,1).index]=null,void(this.squares[new Ae(9,1).index]=null);case ye.HANDICAP_6PIECES:return this.squares[new Ae(8,2).index]=null,this.squares[new Ae(2,2).index]=null,this.squares[new Ae(1,1).index]=null,this.squares[new Ae(2,1).index]=null,this.squares[new Ae(8,1).index]=null,void(this.squares[new Ae(9,1).index]=null);case ye.HANDICAP_8PIECES:return this.squares[new Ae(8,2).index]=null,this.squares[new Ae(2,2).index]=null,this.squares[new Ae(1,1).index]=null,this.squares[new Ae(2,1).index]=null,this.squares[new Ae(3,1).index]=null,this.squares[new Ae(7,1).index]=null,this.squares[new Ae(8,1).index]=null,void(this.squares[new Ae(9,1).index]=null)}}get sfen(){let e="",t=0;for(let i=0;i<9;i+=1){for(let n=0;n<9;n+=1){const o=this.at(Ae.newByXY(n,i));o?(t&&(e+=t,t=0),e+=o.sfen):t+=1}t&&(e+=t,t=0),8!==i&&(e+="/")}return e}resetBySFEN(e){if(!He.isValidSFEN(e))return!1;this.clear();const t=e.split("/");for(let i=0;i<9;i+=1){let e=0;for(let n=0;n<t[i].length;n+=1){let o=t[i][n];"+"===o&&(n+=1,o+=t[i][n]);const a=be(o);a?e+=a:(this.set(Ae.newByXY(e,i),ue.newBySFEN(o)),e+=1)}}return!0}findKing(e){const t=new ue(e,j.KING);return Ae.all.find((e=>{const i=this.at(e);if(i&&t.equals(i))return!0}))}hasPower(e,t,i){return!!me.find((n=>{let o=0;for(let a=e.neighbor(n);a.valid;a=a.neighbor(n)){if(o+=1,i&&i.filled&&a.equals(i.filled))break;if(i&&i.ignore&&a.equals(i.ignore))continue;const e=this.at(a);if(e){if(e.color!==t)return!1;const i=pe(n),a=Se(e,i);return a===_e.LONG||a===_e.SHORT&&1===o}}return!1}))}isChecked(e,t){const i=this.findKing(e);return!!i&&this.hasPower(i,Z(e),{filled:t&&t.filled,ignore:t&&t.ignore})}static isValidSFEN(e){const t=e.split("/");if(9!==t.length)return!1;for(let i=0;i<9;i+=1){let e=0;for(let n=0;n<t[i].length;n+=1){let o=t[i][n];"+"===o&&(n+=1,o+=t[i][n]);const a=be(o);if(a)e+=a;else{if(!ue.isValidSFEN(o))return!1;e+=1}}if(9!==e)return!1}return!0}copyFrom(e){Ae.all.forEach((t=>{this.squares[t.index]=e.at(t)}))}}function ke(e,t){return 0===e?"":(1!==e?e:"")+t.sfen}class Ce{constructor(){(0,Y.Z)(this,"pieces",void 0),this.pieces=new Map,this.pieces.set(j.PAWN,0),this.pieces.set(j.LANCE,0),this.pieces.set(j.KNIGHT,0),this.pieces.set(j.SILVER,0),this.pieces.set(j.GOLD,0),this.pieces.set(j.BISHOP,0),this.pieces.set(j.ROOK,0)}count(e){return this.pieces.get(e)}set(e,t){this.pieces.set(e,t)}add(e,t){let i=this.pieces.get(e);return i+=t,this.pieces.set(e,i),i}reduce(e,t){let i=this.pieces.get(e);return i-=t,this.pieces.set(e,i),i}forEach(e){e(j.PAWN,this.pieces.get(j.PAWN)),e(j.LANCE,this.pieces.get(j.LANCE)),e(j.KNIGHT,this.pieces.get(j.KNIGHT)),e(j.SILVER,this.pieces.get(j.SILVER)),e(j.GOLD,this.pieces.get(j.GOLD)),e(j.BISHOP,this.pieces.get(j.BISHOP)),e(j.ROOK,this.pieces.get(j.ROOK))}get sfenBlack(){return this.formatSFEN(V.BLACK)}get sfenWhite(){return this.formatSFEN(V.WHITE)}formatSFEN(e){let t="";return t+=ke(this.count(j.ROOK),new ue(e,j.ROOK)),t+=ke(this.count(j.BISHOP),new ue(e,j.BISHOP)),t+=ke(this.count(j.GOLD),new ue(e,j.GOLD)),t+=ke(this.count(j.SILVER),new ue(e,j.SILVER)),t+=ke(this.count(j.KNIGHT),new ue(e,j.KNIGHT)),t+=ke(this.count(j.LANCE),new ue(e,j.LANCE)),t+=ke(this.count(j.PAWN),new ue(e,j.PAWN)),""===t?"-":t}static formatSFEN(e,t){const i=e.sfenBlack,n=t.sfenWhite;return"-"===i&&"-"===n?"-":"-"===n?i:"-"===i?n:i+n}static isValidSFEN(e){return"-"===e||!!e.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/)}static parseSFEN(e){if("-"===e)return{black:new Ce,white:new Ce};if(!e.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/))return null;const t=e.match(/([0-9]*[PLNSGBRplnsgbr])/g),i=new Ce,n=new Ce;for(let o=0;o<t.length;o+=1){const e=t[o];let a=1;e.length>=2&&(a=Number(e.substring(0,e.length-1)));const s=ue.newBySFEN(e[e.length-1]);s.color===V.BLACK?i.add(s.type,a):n.add(s.type,a)}return{black:i,white:n}}copyFrom(e){e.pieces.forEach(((e,t)=>{this.pieces.set(t,e)}))}}const De={black:{pawn:{1:!0},lance:{1:!0},knight:{1:!0,2:!0}},white:{pawn:{9:!0},lance:{9:!0},knight:{9:!0,8:!0}}};function Le(e,t,i){const n=De[e][t];return!!n&&n[i]}function Me(e,t){return e===V.BLACK?t<=3:t>=7}function Ge(e,t,i){for(let n=1;n<=9;n+=1){const o=t.at(new Ae(i,n));if(o&&o.type===j.PAWN&&o.color===e)return!0}return!1}class Be{constructor(){(0,Y.Z)(this,"_board",void 0),(0,Y.Z)(this,"_color",void 0),(0,Y.Z)(this,"_blackHand",void 0),(0,Y.Z)(this,"_whiteHand",void 0),this._board=new He,this._color=V.BLACK,this._blackHand=new Ce,this._whiteHand=new Ce}get board(){return this._board}get color(){return this._color}get blackHand(){return this._blackHand}get whiteHand(){return this._whiteHand}reset(e){switch(this._board.reset(e),this._blackHand=new Ce,this._whiteHand=new Ce,e){case ye.STANDARD:case ye.EMPTY:case ye.TSUME_SHOGI:this._color=V.BLACK;break;case ye.HANDICAP_LANCE:case ye.HANDICAP_RIGHT_LANCE:case ye.HANDICAP_BISHOP:case ye.HANDICAP_ROOK:case ye.HANDICAP_ROOK_LANCE:case ye.HANDICAP_2PIECES:case ye.HANDICAP_4PIECES:case ye.HANDICAP_6PIECES:case ye.HANDICAP_8PIECES:this._color=V.WHITE;break}e===ye.TSUME_SHOGI&&(this._whiteHand.set(j.PAWN,18),this._whiteHand.set(j.LANCE,4),this._whiteHand.set(j.KNIGHT,4),this._whiteHand.set(j.SILVER,4),this._whiteHand.set(j.GOLD,4),this._whiteHand.set(j.BISHOP,2),this._whiteHand.set(j.ROOK,2))}hand(e){return this._hand(e)}_hand(e){return e===V.BLACK?this._blackHand:this._whiteHand}get checked(){return this._board.isChecked(this.color)}createMove(e,t){let i;if(e instanceof Ae){const t=this._board.at(e);if(!t)return null;i=t.type}else i=e;const n=this._board.at(t);return new Ne(e,t,!1,this.color,i,n?n.type:null)}createMoveBySFEN(e){const t=Pe(e);if(!t)return null;let i=this.createMove(t.from,t.to);return i?(t.promote&&(i=i.withPromote()),i):null}isPawnDropMate(e){if(e.from instanceof Ae)return!1;if(e.pieceType!==j.PAWN)return!1;const t=e.to.neighbor(e.color===V.BLACK?de.UP:de.DOWN),i=this.board.at(t);if(!i||i.type!==j.KING||i.color===e.color)return!1;const n=Ee(i).find((n=>{const o=t.neighbor(n);if(!o.valid)return!1;const a=this.board.at(o);return(!a||a.color!=i.color)&&!this.board.hasPower(o,e.color)}));return!n&&!this.board.listSquaresByColor(i.color).find((n=>!n.equals(t)&&this.isMovable(n,e.to)&&!this.board.isChecked(i.color,{filled:e.to,ignore:n})))}isValidMove(e){if(e.from instanceof Ae){const t=this._board.at(e.from);if(!t||t.color!==this.color)return!1;if(!this.isMovable(e.from,e.to))return!1;const i=this._board.at(e.to);if(i&&i.color===this.color)return!1;if(e.promote){if(!t.isPromotable())return!1;if(!Me(this.color,e.from.rank)&&!Me(this.color,e.to.rank))return!1}else if(Le(this.color,t.type,e.to.rank))return!1;if(e.pieceType!==j.KING?this._board.isChecked(this.color,{filled:e.to,ignore:e.from}):this._board.hasPower(e.to,Z(this.color),{ignore:e.from}))return!1}else{if(e.promote)return!1;if(e.color!==this.color)return!1;if(0===this.hand(this.color).count(e.from))return!1;if(this._board.at(e.to))return!1;if(Le(this.color,e.from,e.to.rank))return!1;if(e.from===j.PAWN&&Ge(this.color,this._board,e.to.file))return!1;if(this._board.isChecked(this.color,{filled:e.to}))return!1;if(this.isPawnDropMate(e))return!1}return!0}doMove(e,t){if((!t||!t.ignoreValidation)&&!this.isValidMove(e))return!1;if(e.from instanceof Ae){const t=this._board.at(e.from),i=this._board.at(e.to);this._board.remove(e.from),this._board.set(e.to,e.promote?t.promoted():t),i&&i.type!==j.KING&&this._hand(this.color).add(i.unpromoted().type,1)}else this._hand(this.color).reduce(e.from,1),this._board.set(e.to,new ue(this.color,e.from));return this._color=Z(this.color),!0}undoMove(e){if(this._color=Z(this.color),e.from instanceof Ae)if(this._board.set(e.from,new ue(this.color,e.pieceType)),e.capturedPieceType){const t=new ue(Z(this.color),e.capturedPieceType);this._board.set(e.to,t),t.type!==j.KING&&this._hand(this.color).reduce(t.unpromoted().type,1)}else this._board.remove(e.to);else this._hand(this.color).add(e.from,1),this._board.remove(e.to)}isValidEditing(e,t){if(e instanceof Ae){const i=this._board.at(e);if(!i)return!1;if(t instanceof Ae){if(e.equals(t))return!1}else if(i.type===j.KING)return!1}else{if(!e.color)return!1;if(0===this.hand(e.color).count(e.type))return!1;if(t instanceof Ae){if(this._board.at(t))return!1}else if(e.color===t)return!1}return!0}edit(e){if(e.move){if(!this.isValidEditing(e.move.from,e.move.to))return!1;if(e.move.from instanceof Ae)if(e.move.to instanceof Ae)this._board.swap(e.move.from,e.move.to);else{const t=this._board.remove(e.move.from);this._hand(e.move.to).add(t.unpromoted().type,1)}else this._hand(e.move.from.color).reduce(e.move.from.type,1),e.move.to instanceof Ae?this._board.set(e.move.to,e.move.from):this._hand(e.move.to).add(e.move.from.type,1)}if(e.rotate){const t=this._board.at(e.rotate);t&&this._board.set(e.rotate,t.rotate())}return!0}get sfen(){return this.getSfen(1)}getSfen(e){let t=`sfen ${this._board.sfen} ${z(this.color)} `;return t+=Ce.formatSFEN(this._blackHand,this._whiteHand),t+=" "+e,t}resetBySFEN(e){if(!Be.isValidSFEN(e))return!1;const t=e.split(" ");this._board.resetBySFEN(t[1]),this._color=$(t[2]);const i=Ce.parseSFEN(t[3]);return this._blackHand=i.black,this._whiteHand=i.white,!0}setColor(e){this._color=e}static isValidSFEN(e){const t=e.split(" ");return!(t.length<5)&&("sfen"===t[0]&&(!!He.isValidSFEN(t[1])&&(!!J(t[2])&&!!Ce.isValidSFEN(t[3]))))}static newBySFEN(e){const t=new Be;return t.resetBySFEN(e)?t:null}isMovable(e,t){const i=t.x-e.x,n=t.y-e.y,{direction:o,distance:a,ok:s}=fe(i,n);if(!s)return!1;const r=this._board.at(e);if(!r)return!1;switch(Se(r,o)){default:return!1;case _e.SHORT:return 1===a;case _e.LONG:{const i=ve[o];for(let n=e.neighbor(i.x,i.y);n.valid;n=n.neighbor(i.x,i.y)){if(n.equals(t))return!0;if(this._board.at(n))return!1}return!1}}}copyFrom(e){this._board.copyFrom(e._board),this._color=e.color,this._blackHand.copyFrom(e._blackHand),this._whiteHand.copyFrom(e._whiteHand)}clone(){const e=new Be;return e.copyFrom(this),e}}function xe(e){return We(Math.floor(e/1e3))}function Ue(e){return Ke(Math.floor(e/1e3))}function We(e){const t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),n=e%60;return t+":"+String(i).padStart(2,"0")+":"+String(n).padStart(2,"0")}function Ke(e){const t=Math.floor(e/60),i=e%60;return String(t).padStart(2," ")+":"+String(i).padStart(2,"0")}var Fe,qe;function Ve(e){switch(e){case Fe.BLACK_NAME:return"先手";case Fe.WHITE_NAME:return"後手";case Fe.START_DATETIME:return"開始日時";case Fe.END_DATETIME:return"終了日時";case Fe.DATE:return"対局日";case Fe.TOURNAMENT:return"棋戦";case Fe.STRATEGY:return"戦型";case Fe.TITLE:return"表題";case Fe.TIME_LIMIT:return"持ち時間";case Fe.TIME_SPENT:return"消費時間";case Fe.PLACE:return"場所";case Fe.POSTED_ON:return"掲載";case Fe.NOTE:return"備考";case Fe.BLACK_SHORT_NAME:return"先手省略名";case Fe.WHITE_SHORT_NAME:return"後手省略名";case Fe.OPUS_NO:return"作品番号";case Fe.OPUS_NAME:return"作品名";case Fe.AUTHOR:return"作者";case Fe.PUBLISHED_ON:return"発表誌";case Fe.PUBLISHED_AT:return"発表年月";case Fe.SOURCE:return"出典";case Fe.LENGTH:return"手数";case Fe.INTEGRITY:return"完全性";case Fe.CATEGORY:return"分類";case Fe.AWARD:return"受賞"}}(function(e){e["BLACK_NAME"]="blackName",e["WHITE_NAME"]="whiteName",e["START_DATETIME"]="startDatetime",e["END_DATETIME"]="endDatetime",e["DATE"]="date",e["TOURNAMENT"]="tournament",e["STRATEGY"]="strategy",e["TITLE"]="title",e["TIME_LIMIT"]="timeLimit",e["TIME_SPENT"]="timeSpent",e["PLACE"]="place",e["POSTED_ON"]="postedOn",e["NOTE"]="note",e["BLACK_SHORT_NAME"]="blackShortName",e["WHITE_SHORT_NAME"]="whiteShortName",e["OPUS_NO"]="opusNo",e["OPUS_NAME"]="opusName",e["AUTHOR"]="author",e["PUBLISHED_ON"]="publishedOn",e["PUBLISHED_AT"]="publishedAt",e["SOURCE"]="source",e["LENGTH"]="length",e["INTEGRITY"]="integrity",e["CATEGORY"]="category",e["AWARD"]="award"})(Fe||(Fe={}));class je{constructor(){(0,Y.Z)(this,"metadata",void 0),(0,Y.Z)(this,"customMetadata",void 0),this.metadata=new Map,this.customMetadata=new Map}get standardMetadataKeys(){return this.metadata.keys()}getStandardMetadata(e){return this.metadata.get(e)}setStandardMetadata(e,t){t?this.metadata.set(e,t):this.metadata.delete(e)}get customMetadataKeys(){return this.customMetadata.keys()}getCustomMetadata(e){return this.customMetadata.get(e)}setCustomMetadata(e,t){t?this.customMetadata.set(e,t):this.customMetadata.delete(e)}}(function(e){e["START"]="start",e["INTERRUPT"]="interrupt",e["RESIGN"]="resign",e["DRAW"]="draw",e["REPETITION_DRAW"]="repetitionDraw",e["MATE"]="mate",e["TIMEOUT"]="timeout",e["FOUL_WIN"]="foulWin",e["FOUL_LOSE"]="foulLose",e["ENTERING_OF_KING"]="enteringOfKing",e["WIN_BY_DEFAULT"]="winByDefault",e["LOSS_BY_DEFAULT"]="lossByDefault"})(qe||(qe={}));const Ye={start:"開始局面",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function Ze(e){return Ye[e]}class ze{constructor(e,t,i,n,o,a){(0,Y.Z)(this,"number",void 0),(0,Y.Z)(this,"prev",void 0),(0,Y.Z)(this,"branchIndex",void 0),(0,Y.Z)(this,"activeBranch",void 0),(0,Y.Z)(this,"move",void 0),(0,Y.Z)(this,"isCheck",void 0),(0,Y.Z)(this,"next",void 0),(0,Y.Z)(this,"branch",void 0),(0,Y.Z)(this,"comment",void 0),(0,Y.Z)(this,"customData",void 0),(0,Y.Z)(this,"elapsedMs",void 0),(0,Y.Z)(this,"totalElapsedMs",void 0),this.number=e,this.prev=t,this.branchIndex=i,this.activeBranch=n,this.move=o,this.isCheck=a,this.next=null,this.branch=null,this.comment="",this.elapsedMs=0,this.totalElapsedMs=0}get displayMoveText(){const e=this.prev&&this.prev.move instanceof Ne?this.prev.move:null;return this.move instanceof Ne?this.move.getDisplayText(e):Ze(this.move)}get displayText(){let e=this.displayMoveText;if(0!==this.number){const t=Ue(this.elapsedMs),i=xe(this.totalElapsedMs);e+=` (${t} / ${i})`}return e}get hasBranch(){return!!this.prev&&!!this.prev.next&&!!this.prev.next.branch}get isFirstBranch(){return!this.prev||this.prev.next===this}updateTotalElapsedMs(){this.totalElapsedMs=this.elapsedMs,this.prev&&this.prev.prev&&(this.totalElapsedMs+=this.prev.prev.totalElapsedMs)}setElapsedMs(e){this.elapsedMs=e,this.updateTotalElapsedMs();let t=this.next;const i=[];while(t)t.updateTotalElapsedMs(),t.branch&&i.push(t.branch),t=t.next?t.next:i.pop()||null}}class Je{constructor(e){(0,Y.Z)(this,"_metadata",void 0),(0,Y.Z)(this,"_initialPosition",void 0),(0,Y.Z)(this,"_position",void 0),(0,Y.Z)(this,"_first",void 0),(0,Y.Z)(this,"_current",void 0),(0,Y.Z)(this,"repetitionCounts",void 0),(0,Y.Z)(this,"repetitionStart",void 0),this._metadata=new je,this._initialPosition=e?e.clone():new Be,this._position=this.initialPosition.clone(),this._first=new ze(0,null,0,!0,qe.START,!1),this._current=this._first,this.repetitionCounts={},this.repetitionStart={},this.incrementRepetition()}get metadata(){return this._metadata}get initialPosition(){return this._initialPosition}get position(){return this._position}get first(){return this._first}get current(){return this._current}get moves(){const e=this.movesBefore;for(let t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e.push(t)}return e}get movesBefore(){return this._movesBefore}get _movesBefore(){const e=new Array;e.unshift(this._current);for(let t=this._current.prev;t;t=t.prev)e.unshift(t);return e}get length(){let e=this._current.number;for(let t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e=t.number}return e}get branchBegin(){return this._current.prev?this._current.prev.next:this._current}clear(e){e&&(this._initialPosition=e.clone()),this._position=this.initialPosition.clone(),this.repetitionCounts={},this.incrementRepetition(),this._first.next=null,this._current=this._first}goBack(){return!!this._current.prev&&(this._current.move instanceof Ne&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=this._current.prev,!0)}goForward(){if(this._current.next){this._current=this._current.next;while(!this._current.activeBranch)this._current=this._current.branch;return this._current.move instanceof Ne&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),!0}return!1}goto(e){while(e<this._current.number)if(!this.goBack())break;while(e>this._current.number)if(!this.goForward())break}resetAllBranchSelection(){this._forEach((e=>{e.activeBranch=e.isFirstBranch}))}switchBranchByIndex(e){if(!this._current.prev)return!1;let t=!1;for(let i=this._current.prev.next;i;i=i.branch)i.branchIndex===e?(i.activeBranch=!0,this._current.move instanceof Ne&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=i,this._current.move instanceof Ne&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),t=!0):i.activeBranch=!1;return t}append(e,t){let i,n=!1;if(e instanceof Ne){if(!this._position.doMove(e,t))return!1;this.incrementRepetition(),n=this.position.checked}if(this._current===this.first||this._current.move instanceof Ne||this.goBack(),!this._current.next)return this._current.next=new ze(this._current.number+1,this._current,0,!0,e,n),this._current=this._current.next,!0;for(i=this._current.next;i;i=i.branch)i.activeBranch=!1;let o=this._current.next;for(i=this._current.next;i;i=i.branch){if(i.move instanceof Ne&&e instanceof Ne&&e.equals(i.move)||e===i.move)return this._current=i,this._current.activeBranch=!0,!0;o=i}return this._current=new ze(this._current.number+1,this._current,o.branchIndex+1,!0,e,n),o.branch=this._current,!0}removeAfter(){const e=this._current;if(!this.goBack())return void(this._current.next=null);if(this._current.next===e)this._current.next=e.branch;else for(let i=this._current.next;i;i=i.branch)if(i.branch===e){i.branch=e.branch;break}let t=0;for(let i=this._current.next;i;i=i.branch)i.branchIndex=t,t+=1;this._current.next&&(this._current.next.activeBranch=!0)}incrementRepetition(){const e=this.position.sfen;this.repetitionCounts[e]?this.repetitionCounts[e]+=1:(this.repetitionCounts[e]=1,this.repetitionStart[e]=this.current.number)}decrementRepetition(){const e=this.position.sfen;this.repetitionCounts[e]-=1,0===this.repetitionCounts[e]&&(delete this.repetitionCounts[e],delete this.repetitionStart[e])}get repetition(){return this.repetitionCounts[this.position.sfen]>=4}get perpetualCheck(){if(!this.repetition)return null;const e=this.position.sfen,t=this.repetitionStart[e];let i=!0,n=!0,o=this.position.color;for(let a=this.current;a.number>=t;a=a.prev)o=Z(o),a.isCheck||(o===V.BLACK?i=!1:n=!1);return i?V.BLACK:n?V.WHITE:null}get usi(){let e="position "+this.initialPosition.sfen+" moves";return this._movesBefore.forEach((t=>{t.move instanceof Ne&&(e+=" "+t.move.sfen)})),e}get sfen(){return"position "+this.position.getSfen(this._current.number+1)}forEach(e){this._forEach(e)}_forEach(e){let t=this._first;const i=[];while(t)e(t),t.branch&&i.push(t.branch),t=t.next?t.next:i.pop()||null}}const $e={"先手":Fe.BLACK_NAME,"後手":Fe.WHITE_NAME,"開始日時":Fe.START_DATETIME,"終了日時":Fe.END_DATETIME,"対局日":Fe.DATE,"棋戦":Fe.TOURNAMENT,"戦型":Fe.STRATEGY,"表題":Fe.TITLE,"持ち時間":Fe.TIME_LIMIT,"消費時間":Fe.TIME_SPENT,"場所":Fe.PLACE,"掲載":Fe.POSTED_ON,"備考":Fe.NOTE,"先手省略名":Fe.BLACK_SHORT_NAME,"後手省略名":Fe.WHITE_SHORT_NAME,"作品番号":Fe.OPUS_NO,"作品名":Fe.OPUS_NAME,"作者":Fe.AUTHOR,"発表誌":Fe.PUBLISHED_ON,"発表年月":Fe.PUBLISHED_AT,"出典":Fe.SOURCE,"手数":Fe.LENGTH,"完全性":Fe.INTEGRITY,"分類":Fe.CATEGORY,"受賞":Fe.AWARD},Xe={blackName:"先手",whiteName:"後手",startDatetime:"開始日時",endDatetime:"終了日時",date:"対局日",tournament:"棋戦",strategy:"戦型",title:"表題",timeLimit:"持ち時間",timeSpent:"消費時間",place:"場所",postedOn:"掲載",note:"備考",blackShortName:"先手省略名",whiteShortName:"後手省略名",opusNo:"作品番号",opusName:"作品名",author:"作者",publishedOn:"発表誌",publishedAt:"発表年月",source:"出典",length:"手数",integrity:"完全性",category:"分類",award:"受賞"};var Qe;(function(e){e[e["METADATA"]=0]="METADATA",e[e["HANDICAP"]=1]="HANDICAP",e[e["BLACK_HAND"]=2]="BLACK_HAND",e[e["WHITE_HAND"]=3]="WHITE_HAND",e[e["BOARD"]=4]="BOARD",e[e["BLACK_TURN"]=5]="BLACK_TURN",e[e["WHITE_TURN"]=6]="WHITE_TURN",e[e["MOVE"]=7]="MOVE",e[e["COMMENT"]=8]="COMMENT",e[e["UNKNOWN"]=9]="UNKNOWN"})(Qe||(Qe={}));const et=[{prefix:/^手合割：/,type:Qe.HANDICAP,removePrefix:!0,isPosition:!0},{prefix:/^先手の持駒：/,type:Qe.BLACK_HAND,removePrefix:!0,isPosition:!0},{prefix:/^後手の持駒：/,type:Qe.WHITE_HAND,removePrefix:!0,isPosition:!0},{prefix:/^\|/,type:Qe.BOARD,removePrefix:!1,isPosition:!0},{prefix:/^先手番/,type:Qe.BLACK_TURN,removePrefix:!1,isPosition:!0},{prefix:/^後手番/,type:Qe.WHITE_TURN,removePrefix:!1,isPosition:!0},{prefix:/^ *[0-9]+ +/,type:Qe.MOVE,removePrefix:!1,isPosition:!1},{prefix:/^\*/,type:Qe.COMMENT,removePrefix:!0,isPosition:!1}];function tt(e){let t=e.indexOf("#");-1===t&&(t=e.length);for(let n=0;n<et.length;n++){const i=et[n],o=e.match(i.prefix);if(o){const n=i.removePrefix?o[0].length:0;return{type:i.type,data:e.substring(n,t),isPosition:i.isPosition,metadataKey:""}}}const i=e.match(/^[^ ]+：/);if(i){const n=i[0];return{type:Qe.METADATA,data:e.substring(n.length,t),isPosition:!1,metadataKey:n.substring(0,n.length-1)}}return{type:Qe.UNKNOWN,data:e.substring(0,t),isPosition:!1,metadataKey:""}}function it(e,t){switch(t.trim()){case"平手":return void e.reset(ye.STANDARD);case"香落ち":return void e.reset(ye.HANDICAP_LANCE);case"右香落ち":return void e.reset(ye.HANDICAP_RIGHT_LANCE);case"角落ち":return void e.reset(ye.HANDICAP_BISHOP);case"飛車落ち":return void e.reset(ye.HANDICAP_ROOK);case"飛香落ち":return void e.reset(ye.HANDICAP_ROOK_LANCE);case"二枚落ち":return void e.reset(ye.HANDICAP_2PIECES);case"四枚落ち":return void e.reset(ye.HANDICAP_4PIECES);case"六枚落ち":return void e.reset(ye.HANDICAP_6PIECES);case"八枚落ち":return void e.reset(ye.HANDICAP_8PIECES);case"その他":return void e.reset(ye.EMPTY)}return new Error("不正なデータ:"+t)}const nt={"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9},ot={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},at={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"十":10,"十一":11,"十二":12,"十三":13,"十四":14,"十五":15,"十六":16,"十七":17,"十八":18},st={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9},rt={"王":j.KING,"玉":j.KING,"飛":j.ROOK,"龍":j.DRAGON,"竜":j.DRAGON,"角":j.BISHOP,"馬":j.HORSE,"金":j.GOLD,"銀":j.SILVER,"成銀":j.PROM_SILVER,"全":j.PROM_SILVER,"桂":j.KNIGHT,"成桂":j.PROM_KNIGHT,"圭":j.PROM_KNIGHT,"香":j.LANCE,"成香":j.PROM_LANCE,"杏":j.PROM_LANCE,"歩":j.PAWN,"と":j.PROM_PAWN},ct={"中断":qe.INTERRUPT,"投了":qe.RESIGN,"持将棋":qe.DRAW,"千日手":qe.REPETITION_DRAW,"詰み":qe.MATE,"切れ負け":qe.TIMEOUT,"反則勝ち":qe.FOUL_WIN,"反則負け":qe.FOUL_LOSE,"入玉勝ち":qe.ENTERING_OF_KING,"不戦勝":qe.WIN_BY_DEFAULT,"不戦敗":qe.LOSS_BY_DEFAULT},lt=/^ *([0-9]+) +[▲△]?([１２３４５６７８９][一二三四五六七八九]|同\u3000)(玉|飛|龍|竜|角|馬|金|銀|成銀|全|桂|成桂|圭|香|成香|杏|歩|と)(成?)(打|\([1-9][1-9]\)) *(.*)$/,ut=/\( *([0-9]+):([0-9]+)\/[0-9: ]*\)/,dt=/^ *([0-9]+) +(中断|投了|持将棋|千日手|詰み|切れ負け|反則勝ち|反則負け|入玉勝ち|不戦勝|不戦敗) *(.*)$/;function ht(e,t){if(t.length<21)return new Error("不正な盤面:"+t);const i=t[20],n=ot[i];if(!n)return new Error("不正な盤面:"+t);for(let o=0;o<9;o+=1){const i=9-o,a=new Ae(i,n),s=2*o+1,r=t[s+1],c=rt[r];if(!c){e.remove(a);continue}const l="v"!==t[s]?V.BLACK:V.WHITE;e.set(a,new ue(l,c))}}function pt(e,t){const i=t.split(/[ 　]/);for(const n of i){if(!n||"なし"===n)continue;const t=n[0],i=n.substring(1),o=rt[t],a=at[i]||1;if(!o)return new Error("不正な持ち駒: "+n);e.add(o,a)}}function mt(e,t){const i=ut.exec(t);if(i){const t=i[1],n=i[2],o=60*Number.parseInt(t)+Number.parseInt(n);e.current.setElapsedMs(1e3*o)}}function _t(e,t){let i=dt.exec(t);if(i){const t=Number(i[1]),n=ct[i[2]],o=i[3];return e.goto(t-1),e.append(n,{ignoreValidation:!0}),void mt(e,o)}if(i=lt.exec(t),!i)return new Error("不正な指し手形式:"+t);const n=Number(i[1]),o=i[2],a=i[3],s=i[4],r=i[5],c=i[6];if(0===n)return new Error("不正な手数:"+t);let l,u;if(e.goto(n-1),"同　"===o){if(!(e.current.move instanceof Ne))return new Error("不明な移動先: "+t);l=e.current.move.to}else{const e=nt[o[0]],t=ot[o[1]];l=new Ae(e,t)}if("打"===r)u=rt[a];else{const e=st[r[1]],t=st[r[2]];u=new Ae(e,t)}let d=e.position.createMove(u,l);if(!d)return new Error("不正な指し手: "+t);"成"===s&&(d=d.withPromote()),e.append(d,{ignoreValidation:!0}),mt(e,c)}function gt(e){const t=new Je,i=e.split(/\r?\n/),n=new Be;let o=!1;for(const a of i){if(""===a)continue;const e=tt(a);if(o&&e.isPosition)return new Error("不正なデータ: "+a);let i;switch(e.type){case Qe.METADATA:{const i=$e[e.metadataKey];i?t.metadata.setStandardMetadata(i,e.data):t.metadata.setCustomMetadata(e.metadataKey,e.data);break}case Qe.HANDICAP:i=it(n,e.data);break;case Qe.BLACK_HAND:i=pt(n.blackHand,e.data);break;case Qe.WHITE_HAND:i=pt(n.whiteHand,e.data);break;case Qe.BOARD:i=ht(n.board,e.data);break;case Qe.BLACK_TURN:n.setColor(V.BLACK);break;case Qe.WHITE_TURN:n.setColor(V.WHITE);break;case Qe.MOVE:o||(t.clear(n),o=!0),i=_t(t,e.data);break;case Qe.COMMENT:t.current.comment+=(0!==t.current.comment.length?"\n":"")+e.data;break;case Qe.UNKNOWN:console.log("skip",a);break}if(i)return i}return o||t.clear(n),t.goto(0),t.resetAllBranchSelection(),t}const Et=["一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八"],St=["１","２","３","４","５","６","７","８","９"],vt=Et,ft={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"成銀",knight:"桂",promKnight:"成桂",lance:"香",promLance:"成香",pawn:"歩",promPawn:"と"},It={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"全",knight:"桂",promKnight:"圭",lance:"香",promLance:"杏",pawn:"歩",promPawn:"と"},Tt={start:"",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉勝ち",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function wt(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";for(const o of e.standardMetadataKeys)i+=Xe[o]+"："+e.getStandardMetadata(o)+n;for(const o of e.customMetadataKeys)i+=o+"："+e.getCustomMetadata(o)+n;return i}function At(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";i+="後手の持駒："+Rt(e.whiteHand)+n,i+="  ９ ８ ７ ６ ５ ４ ３ ２ １"+n,i+="+---------------------------+"+n;for(let o=0;o<9;o++){i+="|";for(let t=0;t<9;t++){const n=Ae.newByXY(t,o),a=e.board.at(n);a?a.color===V.BLACK?i+=" "+It[a.type]:i+="v"+It[a.type]:i+=" ・"}i+="|"+vt[o]+n}return i+="+---------------------------+"+n,i+="先手の持駒："+Rt(e.blackHand)+n,e.color===V.BLACK?i+="先手番"+n:i+="後手番"+n,i}function Ot(e){let t="";return t+=St[e.to.file-1],t+=vt[e.to.rank-1],t+=ft[e.pieceType],e.promote&&(t+="成"),e.from instanceof Ae?t+="("+e.from.file+e.from.rank+")":t+="打",t}function Rt(e){let t="";return e.forEach(((e,i)=>{i>=1&&(t+=It[e],i>=2&&(t+=Et[i-1]),t+="　")})),t}function Nt(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";return i+="# KIF形式棋譜ファイル Generated by Electron Shogi"+n,i+=wt(e.metadata,t),i+=At(e.initialPosition,t),i+="手数----指手---------消費時間--"+n,e.forEach((e=>{if(e.move){e.isFirstBranch||(i+=n,i+="変化："+e.number+"手"+n),e.move instanceof Ne?i+=e.number+" "+Ot(e.move):i+=Tt[e.move];const t=Ue(e.elapsedMs),o=xe(e.totalElapsedMs);i+=` (${t}/${o})`,e.isFirstBranch&&e.hasBranch&&(i+="+"),i+=n}0!==e.comment.length&&(i+="*"+e.comment.replaceAll("\n",n+"*")+n)})),i}const Pt={};function yt(e){if(Pt[e])return;const t=document.createElement("img");t.src=e,Pt[e]=t}var bt;(function(e){e["HITOMOJI"]="hitomoji",e["HITOMOJI_GOTHIC"]="hitomojiGothic"})(bt||(bt={}));const Ht={frame:{width:1471,height:959},board:{x:296.5,y:0,width:878,height:960,squreWidth:94.8,squreHeight:104,leftSquarePadding:12,topSquarePadding:12.2,leftPiecePadding:17.5,topPiecePadding:18.5,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"},lastMove:{"background-color":"#00ddff",opacity:"0.5"}}},piece:{width:88,height:93},hand:{color:"#8b4513",black:{x:1184,y:600},white:{x:0,y:0},width:288,height:360,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"}}},turn:{black:{x:1184,y:425},white:{x:0,y:492},width:288,height:45,fontSize:32},playerName:{black:{x:1184,y:480},white:{x:0,y:370},width:288,height:45,fontSize:25},clock:{black:{x:1184,y:535},white:{x:0,y:425},width:288,height:55,fontSize:40},control:{left:{x:0,y:547,width:288,height:412,fontSize:26},right:{x:1184,y:0,width:288,height:412,fontSize:26}}},kt={hitomoji:{...Ht,images:{board:"./board/default.png",black:{pawn:"./piece/hitomoji/black_pawn.png",lance:"./piece/hitomoji/black_lance.png",knight:"./piece/hitomoji/black_knight.png",silver:"./piece/hitomoji/black_silver.png",gold:"./piece/hitomoji/black_gold.png",bishop:"./piece/hitomoji/black_bishop.png",rook:"./piece/hitomoji/black_rook.png",king:"./piece/hitomoji/black_king.png",king2:"./piece/hitomoji/black_king2.png",promPawn:"./piece/hitomoji/black_prom_pawn.png",promLance:"./piece/hitomoji/black_prom_lance.png",promKnight:"./piece/hitomoji/black_prom_knight.png",promSilver:"./piece/hitomoji/black_prom_silver.png",horse:"./piece/hitomoji/black_horse.png",dragon:"./piece/hitomoji/black_dragon.png"},white:{pawn:"./piece/hitomoji/white_pawn.png",lance:"./piece/hitomoji/white_lance.png",knight:"./piece/hitomoji/white_knight.png",silver:"./piece/hitomoji/white_silver.png",gold:"./piece/hitomoji/white_gold.png",bishop:"./piece/hitomoji/white_bishop.png",rook:"./piece/hitomoji/white_rook.png",king:"./piece/hitomoji/white_king.png",king2:"./piece/hitomoji/white_king2.png",promPawn:"./piece/hitomoji/white_prom_pawn.png",promLance:"./piece/hitomoji/white_prom_lance.png",promKnight:"./piece/hitomoji/white_prom_knight.png",promSilver:"./piece/hitomoji/white_prom_silver.png",horse:"./piece/hitomoji/white_horse.png",dragon:"./piece/hitomoji/white_dragon.png"}}},hitomojiGothic:{...Ht,images:{board:"./board/default.png",black:{pawn:"./piece/hitomoji_gothic/black_pawn.png",lance:"./piece/hitomoji_gothic/black_lance.png",knight:"./piece/hitomoji_gothic/black_knight.png",silver:"./piece/hitomoji_gothic/black_silver.png",gold:"./piece/hitomoji_gothic/black_gold.png",bishop:"./piece/hitomoji_gothic/black_bishop.png",rook:"./piece/hitomoji_gothic/black_rook.png",king:"./piece/hitomoji_gothic/black_king.png",king2:"./piece/hitomoji_gothic/black_king2.png",promPawn:"./piece/hitomoji_gothic/black_prom_pawn.png",promLance:"./piece/hitomoji_gothic/black_prom_lance.png",promKnight:"./piece/hitomoji_gothic/black_prom_knight.png",promSilver:"./piece/hitomoji_gothic/black_prom_silver.png",horse:"./piece/hitomoji_gothic/black_horse.png",dragon:"./piece/hitomoji_gothic/black_dragon.png"},white:{pawn:"./piece/hitomoji_gothic/white_pawn.png",lance:"./piece/hitomoji_gothic/white_lance.png",knight:"./piece/hitomoji_gothic/white_knight.png",silver:"./piece/hitomoji_gothic/white_silver.png",gold:"./piece/hitomoji_gothic/white_gold.png",bishop:"./piece/hitomoji_gothic/white_bishop.png",rook:"./piece/hitomoji_gothic/white_rook.png",king:"./piece/hitomoji_gothic/white_king.png",king2:"./piece/hitomoji_gothic/white_king2.png",promPawn:"./piece/hitomoji_gothic/white_prom_pawn.png",promLance:"./piece/hitomoji_gothic/white_prom_lance.png",promKnight:"./piece/hitomoji_gothic/white_prom_knight.png",promSilver:"./piece/hitomoji_gothic/white_prom_silver.png",horse:"./piece/hitomoji_gothic/white_horse.png",dragon:"./piece/hitomoji_gothic/white_dragon.png"}}}},Ct={black:{pawn:{row:3,column:0,width:2},lance:{row:2,column:0,width:1},knight:{row:2,column:1,width:1},silver:{row:1,column:0,width:1},gold:{row:1,column:1,width:1},bishop:{row:0,column:0,width:1},rook:{row:0,column:1,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}},white:{pawn:{row:0,column:0,width:2},lance:{row:1,column:1,width:1},knight:{row:1,column:0,width:1},silver:{row:2,column:1,width:1},gold:{row:2,column:0,width:1},bishop:{row:3,column:1,width:1},rook:{row:3,column:0,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}}};class Dt{constructor(e){(0,Y.Z)(this,"template",void 0),this.template=kt[e]||kt[bt.HITOMOJI]}preload(){yt(this.template.images.board),Object.values(this.template.images.black).forEach(yt),Object.values(this.template.images.white).forEach(yt)}build(e,t,i,n,o,a){let s=e.width/this.template.frame.width;this.template.frame.height*s>e.height&&(s=e.height/this.template.frame.height);const r=()=>({style:{height:this.template.frame.height*s+"px",width:this.template.frame.width*s+"px"}}),c=()=>{const e=this.template.images.board,t=this.template.board.x*s,i=this.template.board.y*s,n=this.template.board.width*s,o=this.template.board.height*s,a={left:t+"px",top:i+"px",height:o+"px",width:n+"px"};return{imagePath:e,x:t,y:i,style:a}},l=e=>{const i=[];return t.board.listNonEmptySquares().forEach((n=>{const o=t.board.at(n),r=o.id+n.index,c=a?Z(o.color):o.color,l=o.type==j.KING&&o.color==V.BLACK?"king2":o.type,u=this.template.images[c][l],d=e.x+(this.template.board.leftPiecePadding+this.template.board.squreWidth*(a?n.opposite:n).x)*s,h=e.y+(this.template.board.topPiecePadding+this.template.board.squreHeight*(a?n.opposite:n).y)*s,p=this.template.piece.width*s,m=this.template.piece.height*s;i.push({id:r,imagePath:u,style:{left:d+"px",top:h+"px",width:p+"px",height:m+"px"}})})),i},u=e=>{const t=[];return Ae.all.forEach((o=>{const r=o.index,{file:c}=o,{rank:l}=o,u=e.x+(this.template.board.leftSquarePadding+this.template.board.squreWidth*(a?o.opposite:o).x)*s,d=e.y+(this.template.board.topSquarePadding+this.template.board.squreHeight*(a?o.opposite:o).y)*s,h=this.template.board.squreWidth*s,p=this.template.board.squreHeight*s,m={left:u+"px",top:d+"px",width:h+"px",height:p+"px"};let _=m;i&&o.equals(i.to)&&(_={..._,...this.template.board.highlight.lastMove}),n instanceof Ae&&n.equals(o)&&(_={..._,...this.template.board.highlight.selected}),t.push({id:r,file:c,rank:l,style:m,backgroundStyle:_})})),t},d=(e,t)=>{const i=a?Z(e):e,o=this.template.hand[i].x*s,r=this.template.hand[i].y*s,c=this.template.hand.width*s,l=this.template.hand.height*s,u={"background-color":this.template.hand.color,left:o+"px",top:r+"px",width:c+"px",height:l+"px"},d=[],h=[];return ee.forEach((o=>{const a=t.count(o),r=Ct[i][o],c=this.template.hand.width/2*r.width*s,l=this.template.hand.height/4*s,u=c*r.column,p=l*r.row,m=this.template.piece.width*s,_=this.template.piece.height*s,g=Math.max(c-m*a,0)/(2*a),E=(c-m-2*g)/Math.max(a-1,1);for(let e=a-1;e>=0;e-=1){const t=o+e,n=this.template.images[i][o],a=u+g+E*e,s=p;d.push({id:t,imagePath:n,style:{left:a+"px",top:s+"px",width:m+"px",height:_+"px"}})}const S=o,v={left:u+"px",top:p+"px",width:c+"px",height:l+"px"};let f=v;n&&n instanceof ue&&n.color===e&&n.type===o&&(f={...f,...this.template.hand.highlight.selected}),h.push({id:S,type:o,style:v,backgroundStyle:f})})),{style:u,pieces:d,pointers:h}},h=(e,t)=>{if(!t)return null;const i=a?Z(t.color):t.color,n=a?t.to.opposite:t.to,o=new ue(i,t.pieceType),r=o.promoted(),c=o.unpromoted(),l=this.template.images[i][r.type],u=this.template.images[i][c.type],d=e.x+(this.template.board.leftSquarePadding+this.template.board.squreWidth*(n.x-.5))*s,h=e.y+(this.template.board.topSquarePadding+this.template.board.squreHeight*n.y)*s,p=2*this.template.board.squreWidth*s,m=this.template.board.squreHeight*s,_={left:d+"px",top:h+"px",width:p+"px",height:m+"px","font-size":m/4+"px"};return{promoteImagePath:l,notPromoteImagePath:u,style:_}},p=()=>{const e=t.color,i=a?Z(e):e,n=2;return{style:{left:this.template.turn[i].x*s-n+"px",top:this.template.turn[i].y*s-n+"px",width:this.template.turn.width*s-n+"px",height:this.template.turn.height*s-n+"px","font-size":this.template.turn.fontSize*s+"px","border-radius":this.template.turn.height*s*.4+"px","border-width":n+"px","border-style":"solid"}}},m=e=>{const t=a?Z(e):e;return{style:{left:this.template.playerName[t].x*s+"px",top:this.template.playerName[t].y*s+"px",width:this.template.playerName.width*s+"px",height:this.template.playerName.height*s+"px","font-size":this.template.playerName.fontSize*s+"px"}}},_=e=>{const t=a?Z(e):e;return{style:{left:this.template.clock[t].x*s+"px",top:this.template.clock[t].y*s+"px",width:this.template.clock.width*s+"px",height:this.template.clock.height*s+"px","font-size":this.template.clock.fontSize*s+"px"}}},g=()=>({left:{style:{left:this.template.control.left.x*s+"px",top:this.template.control.left.y*s+"px",width:this.template.control.left.width*s+"px",height:this.template.control.left.height*s+"px","font-size":this.template.control.left.fontSize*s+"px"}},right:{style:{left:this.template.control.right.x*s+"px",top:this.template.control.right.y*s+"px",width:this.template.control.right.width*s+"px",height:this.template.control.right.height*s+"px","font-size":this.template.control.right.fontSize*s+"px"}}}),E=r(),S=c(),v=l(S),f=u(S),I=d(V.BLACK,t.hand(V.BLACK)),T=d(V.WHITE,t.hand(V.WHITE)),w=h(S,o),A=p(),O=m(V.BLACK),R=m(V.WHITE),N=_(V.BLACK),P=_(V.WHITE),y=g();return{frame:E,board:S,piece:v,square:f,blackHand:I,whiteHand:T,promotion:w,turn:A,blackPlayerName:O,whitePlayerName:R,blackClock:N,whiteClock:P,control:y}}}class Lt{constructor(e,t){(0,Y.Z)(this,"width",void 0),(0,Y.Z)(this,"height",void 0),this.width=e,this.height=t}add(e){return new Lt(this.width+e.width,this.height+e.height)}reduce(e){return new Lt(this.width-e.width,this.height-e.height)}}var Mt=(0,o.aZ)({name:"BoardView",props:{layoutType:{type:String,required:!0},maxSize:{type:Lt,required:!0},position:{type:Object,required:!0},lastMove:{type:Ne,required:!1,default:null},flip:{type:Boolean,required:!1},allowEdit:{type:Boolean,required:!1},allowMove:{type:Boolean,required:!1},blackPlayerName:{type:String,required:!1,default:"先手"},whitePlayerName:{type:String,required:!1,default:"後手"},blackPlayerTimeMs:{type:Number,required:!1,default:void 0},blackPlayerByoyomi:{type:Number,required:!1,default:void 0},whitePlayerTimeMs:{type:Number,required:!1,default:void 0},whitePlayerByoyomi:{type:Number,required:!1,default:void 0}},emits:["move","edit"],setup(e,t){const i=(0,l.qj)({pointer:null,reservedMove:null}),n=()=>{i.pointer=null,i.reservedMove=null};(0,o.YP)([()=>e.position,()=>e.allowEdit,()=>e.allowMove],(()=>{n()}));const a=()=>{n()},s=(o,a,s)=>{const r=i.pointer;if(n(),!(o instanceof Ae&&r instanceof Ae&&o.equals(r))&&!(o instanceof ue&&r instanceof ue&&o.equals(r))){if(r){const n=r,a=o instanceof Ae?o:o.color;if(e.allowEdit&&e.position.isValidEditing(n,a))return void t.emit("edit",{move:{from:r,to:a}});if(e.allowMove&&o instanceof Ae){const n=r instanceof Ae?r:r.type,a=o,s=e.position.createMove(n,a);if(!s)return;const c=e.position.isValidMove(s),l=e.position.isValidMove(s.withPromote());if(c&&l)return void(i.reservedMove=s);if(c)return void t.emit("move",s);if(l)return void t.emit("move",s.withPromote())}}!e.allowMove&&!e.allowEdit||a||(e.allowEdit||s===e.position.color)&&(i.pointer=o)}},r=(t,i,n)=>{t.stopPropagation(),t.preventDefault();const o=new Ae(i,n),a=e.position.board.at(o),r=!a;s(o,r,a?.color)},c=(t,i,n)=>{t.stopPropagation(),t.preventDefault();const o=0===e.position.hand(i).count(n);s(new ue(i,n),o,i)},u=(i,o,a)=>{i.stopPropagation(),i.preventDefault(),n();const s=new Ae(o,a);e.allowEdit&&e.position.board.at(s)&&t.emit("edit",{rotate:s})},d=o=>{o.stopPropagation(),o.preventDefault();const a=i.reservedMove;n(),a&&e.position.isValidMove(a.withPromote())&&t.emit("move",a.withPromote())},h=o=>{o.stopPropagation(),o.preventDefault();const a=i.reservedMove;n(),a&&e.position.isValidMove(a)&&t.emit("move",a)},p=(0,o.Fl)((()=>{const t=new Dt(e.layoutType);return t.preload(),t})),m=(0,o.Fl)((()=>p.value.build(e.maxSize.reduce(new Lt(20,20)),e.position,e.lastMove,i.pointer,i.reservedMove,e.flip))),_=(e,t)=>e?We(Math.ceil(e/1e3)):void 0!==t?""+t:"0:00:00",g=(e,t)=>{if(!e&&!t)return"normal";const i=(e||0)/1e3+(t||0);return i<=5?"danger":i<=10?"warning":"normal"},E=(0,o.Fl)((()=>_(e.blackPlayerTimeMs,e.blackPlayerByoyomi))),S=(0,o.Fl)((()=>g(e.blackPlayerTimeMs,e.blackPlayerByoyomi))),v=(0,o.Fl)((()=>_(e.whitePlayerTimeMs,e.whitePlayerByoyomi))),f=(0,o.Fl)((()=>g(e.whitePlayerTimeMs,e.whitePlayerByoyomi)));return{clickFrame:a,clickSquare:r,clickHand:c,clickSquareR:u,clickPromote:d,clickNotPromote:h,layout:m,blackPlayerTimeText:E,blackPlayerTimeSeverity:S,whitePlayerTimeText:v,whitePlayerTimeSeverity:f}}}),Gt=i(3744);const Bt=(0,Gt.Z)(Mt,[["render",q],["__scopeId","data-v-3b874c02"]]);var xt,Ut,Wt,Kt=Bt;function Ft(e){return void 0!==e.value?e.value:void 0!==e.default?"string"===e.type&&"<empty>"===e.default?"":e.default:void 0}function qt(e,t){e.uri=t.uri,e.name=t.name,Object.keys(t.options).forEach((i=>{e.options[i]&&(e.options[i].value=t.options[i].value)}))}class Vt{constructor(e){if((0,Y.Z)(this,"engines",void 0),this.engines={},e){const t=JSON.parse(e);t.engines instanceof Object&&(this.engines=t.engines)}}hasEngine(e){return!!this.engines[e]}addEngine(e){this.engines[e.uri]=e}updateEngine(e){return!!this.engines[e.uri]&&(this.engines[e.uri]=e,!0)}removeEngine(e){return!!this.engines[e]&&(delete this.engines[e],!0)}getEngine(e){return this.engines[e]}get engineList(){return Object.values(this.engines).sort(((e,t)=>e.name>t.name?1:-1))}get json(){return JSON.stringify(this)}get jsonWithIndent(){return JSON.stringify(this,void 0,2)}}function jt(e){return{boardLayout:bt.HITOMOJI,pieceVolume:30,clockVolume:30,clockPitch:500,clockSoundTarget:Wt.ONLY_USER,boardFlipping:!1,informationTab:Ut.RECORD_INFO,returnCode:e||"\r\n"}}(function(e){e["NEW_RECORD"]="newRecord",e["OPEN_RECORD"]="openRecord",e["SAVE_RECORD"]="saveRecord",e["SAVE_RECORD_AS"]="saveRecordAs",e["COPY_RECORD"]="copyRecord",e["PASTE_RECORD"]="pasteRecord",e["REMOVE_RECORD_AFTER"]="remvoeRecordAfter",e["START_POSITION_EDITING"]="startPositionEditing",e["END_POSITION_EDITING"]="endPositionEditing",e["CHANGE_TURN"]="changeTurn",e["INIT_POSITION_STANDARD"]="initPositionStandard",e["INIT_POSITION_HANDICAP_LANCE"]="initPositionHandicapLance",e["INIT_POSITION_HANDICAP_RIGHT_LANCE"]="initPositionHandicapRightLance",e["INIT_POSITION_HANDICAP_BISHOP"]="initPositionHandicapBishop",e["INIT_POSITION_HANDICAP_ROOK"]="initPositionHandicapRook",e["INIT_POSITION_HANDICAP_ROOK_LANCE"]="initPositionHandicapRookLance",e["INIT_POSITION_HANDICAP_2PIECES"]="initPositionHandicap2Pieces",e["INIT_POSITION_HANDICAP_4PIECES"]="initPositionHandicap4Pieces",e["INIT_POSITION_HANDICAP_6PIECES"]="initPositionHandicap6Pieces",e["INIT_POSITION_HANDICAP_8PIECES"]="initPositionHandicap8Pieces",e["INIT_POSITION_TSUME_SHOGI"]="initPositionTsumeShogi",e["START_RESEARCH"]="startResearch",e["STOP_RESEARCH"]="stopResearch",e["START_GAME"]="startGame",e["STOP_GAME"]="stopGame",e["RESIGN"]="resign",e["FLIP_BOARD"]="flipBoard",e["APP_SETTING_DIALOG"]="appSetting",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSetting"})(xt||(xt={})),function(e){e["RECORD_INFO"]="recordInfo",e["COMMENT"]="comment",e["SEARCH"]="search",e["CHART"]="chart",e["INVISIBLE"]="invisible"}(Ut||(Ut={})),function(e){e["ALL"]="all",e["ONLY_USER"]="onlyUser"}(Wt||(Wt={}));const Yt="es://human",Zt="es://usi-engine/";function zt(e){return e.startsWith(Zt)}function Jt(){return{black:{name:"人",uri:Yt},white:{name:"人",uri:Yt},timeLimit:{timeSeconds:0,byoyomi:30,increment:0},enableEngineTimeout:!1,humanIsFront:!0}}function $t(e){return 0===e.timeLimit.timeSeconds&&0===e.timeLimit.byoyomi?new Error("持ち時間と秒読みが両方とも0です。"):0!==e.timeLimit.byoyomi&&0!==e.timeLimit.increment?new Error("秒読みとフィッシャールールは併用できません。"):void 0}function Xt(){return{}}var Qt;(function(e){e["APP_SETTING"]="appSetting",e["RESEARCH_SETTING"]="researchSetting",e["GAME_SETTING"]="gameSetting"})(Qt||(Qt={}));const ei={async getRecordPathFromProcArg(){return""},updateMenuState(){},async showOpenRecordDialog(){throw"Web版では利用できない機能です。"},async openRecord(){throw"Web版では利用できない機能です。"},async showSaveRecordDialog(){throw"Web版では利用できない機能です。"},async saveRecord(){throw"Web版では利用できない機能です。"},async showSelectFileDialog(){throw"Web版では利用できない機能です。"},async loadAppSetting(){const e=localStorage.getItem(Qt.APP_SETTING);return e?JSON.stringify({...jt(),...JSON.parse(e)}):JSON.stringify(jt())},async saveAppSetting(e){localStorage.setItem(Qt.APP_SETTING,e)},async loadResearchSetting(){const e=localStorage.getItem(Qt.RESEARCH_SETTING);return e?JSON.stringify({...Xt(),...JSON.parse(e)}):JSON.stringify(Xt())},async saveResearchSetting(e){localStorage.setItem(Qt.RESEARCH_SETTING,e)},async loadGameSetting(){const e=localStorage.getItem(Qt.GAME_SETTING);return e?JSON.stringify({...Jt(),...JSON.parse(e)}):JSON.stringify(Jt())},async saveGameSetting(e){localStorage.setItem(Qt.GAME_SETTING,e)},async loadUSIEngineSetting(){return(new Vt).json},async saveUSIEngineSetting(){},async showSelectUSIEngineDialog(){throw"Web版では利用できない機能です。"},async getUSIEngineInfo(){throw"Web版では利用できない機能です。"},async startResearch(){throw"Web版では利用できない機能です。"},async endResearch(){throw"Web版では利用できない機能です。"},async startGame(){},async endGame(){},async updateUSIPosition(){},async stopUSI(){},async sendUSISetOption(){},onSendError(){},onMenuEvent(){},onUSIBestMove(){},onUSIInfo(){}};function ti(){return window}function ii(){return!!ti().electronShogiAPI}function ni(){return ti().electronShogiAPI||ei}async function oi(){return await ni().getRecordPathFromProcArg()}async function ai(){return await ni().showOpenRecordDialog()}async function si(e){return await ni().openRecord(e)}async function ri(e){return await ni().showSaveRecordDialog(e)}async function ci(e,t){await ni().saveRecord(e,t)}async function li(){return await ni().showSelectFileDialog()}async function ui(){return JSON.parse(await ni().loadAppSetting())}async function di(e){await ni().saveAppSetting(JSON.stringify(e))}async function hi(){return JSON.parse(await ni().loadResearchSetting())}async function pi(e){await ni().saveResearchSetting(JSON.stringify(e))}async function mi(){return JSON.parse(await ni().loadGameSetting())}async function _i(e){await ni().saveGameSetting(JSON.stringify(e))}async function gi(){return new Vt(await ni().loadUSIEngineSetting())}async function Ei(e){await ni().saveUSIEngineSetting(e.jsonWithIndent)}async function Si(){return await ni().showSelectUSIEngineDialog()}async function vi(e){return JSON.parse(await ni().getUSIEngineInfo(e))}async function fi(e,t){await ni().startResearch(JSON.stringify(e),t)}async function Ii(){await ni().endResearch()}async function Ti(e,t){await ni().startGame(JSON.stringify(e),t)}async function wi(e,t){await ni().endGame(e,t)}async function Ai(e,t,i,n){await ni().updateUSIPosition(e,JSON.stringify(t),i,n)}async function Oi(e){await ni().stopUSI(e)}async function Ri(e,t){await ni().sendUSISetOption(e,t)}function Ni(e){const t=ni();t.onSendError((t=>{e.commit(Fi.PUSH_ERROR,t)})),t.onMenuEvent((t=>{if(!e.getters.isBussy)switch(t){case xt.NEW_RECORD:e.commit(Fi.NEW_RECORD);break;case xt.OPEN_RECORD:e.dispatch(qi.OPEN_RECORD);break;case xt.SAVE_RECORD:e.dispatch(qi.SAVE_RECORD,{overwrite:!0});break;case xt.SAVE_RECORD_AS:e.dispatch(qi.SAVE_RECORD);break;case xt.COPY_RECORD:e.dispatch(qi.COPY_RECORD);break;case xt.PASTE_RECORD:e.commit(Fi.SHOW_PASTE_DIALOG);break;case xt.REMOVE_RECORD_AFTER:e.commit(Fi.REMOVE_RECORD_AFTER);break;case xt.START_POSITION_EDITING:e.dispatch(qi.START_POSITION_EDITING);break;case xt.END_POSITION_EDITING:e.dispatch(qi.END_POSITION_EDITING);break;case xt.CHANGE_TURN:e.commit(Fi.CHANGE_TURN);break;case xt.INIT_POSITION_STANDARD:e.commit(Fi.INITIALIZE_POSITION,ye.STANDARD);break;case xt.INIT_POSITION_HANDICAP_LANCE:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_LANCE);break;case xt.INIT_POSITION_HANDICAP_RIGHT_LANCE:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_RIGHT_LANCE);break;case xt.INIT_POSITION_HANDICAP_BISHOP:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_BISHOP);break;case xt.INIT_POSITION_HANDICAP_ROOK:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_ROOK);break;case xt.INIT_POSITION_HANDICAP_ROOK_LANCE:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_ROOK_LANCE);break;case xt.INIT_POSITION_HANDICAP_2PIECES:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_2PIECES);break;case xt.INIT_POSITION_HANDICAP_4PIECES:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_4PIECES);break;case xt.INIT_POSITION_HANDICAP_6PIECES:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_6PIECES);break;case xt.INIT_POSITION_HANDICAP_8PIECES:e.commit(Fi.INITIALIZE_POSITION,ye.HANDICAP_8PIECES);break;case xt.INIT_POSITION_TSUME_SHOGI:e.commit(Fi.INITIALIZE_POSITION,ye.TSUME_SHOGI);break;case xt.START_GAME:e.commit(Fi.SHOW_GAME_DIALOG);break;case xt.STOP_GAME:e.dispatch(qi.STOP_GAME);break;case xt.RESIGN:e.dispatch(qi.RESIGN_BY_USER);break;case xt.START_RESEARCH:e.commit(Fi.SHOW_RESEARCH_DIALOG);break;case xt.STOP_RESEARCH:e.dispatch(qi.STOP_RESEARCH);break;case xt.FLIP_BOARD:e.commit(Fi.FLIP_BOARD);break;case xt.APP_SETTING_DIALOG:e.commit(Fi.OPEN_APP_SETTING_DIALOG);break;case xt.USI_ENGINE_SETTING_DIALOG:e.commit(Fi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG);break}})),t.onUSIBestMove(((t,i,n,o)=>{e.dispatch(qi.DO_MOVE_BY_USI_ENGINE,{sessionID:t,usi:i,color:n,sfen:o})})),t.onUSIInfo(((t,i,n,o,a)=>{e.dispatch(qi.UPDATE_USI_INFO,{sessionID:t,usi:i,sender:n,name:o,info:JSON.parse(a)})})),(0,o.YP)((()=>[e.state.mode,e.getters.isBussy]),(([e,i])=>{t.updateMenuState(e,i)})),t.updateMenuState(e.state.mode,e.getters.isBussy)}var Pi=i(3907),yi=i(4914),bi=i.n(yi);function Hi(e){const t=e?.type||"sine",i=e?.frequency||440,n=e?.volume||2,o=new AudioContext,a=o.createOscillator(),s=o.createGain();return a.connect(s),s.connect(o.destination),a.type=t,a.frequency.value=i,s.gain.value=.005*n,a.onended=()=>{s.disconnect(o.destination),a.disconnect(s)},a.start(o.currentTime),e?.time&&a.stop(o.currentTime+e.time),{stop:()=>{e?.time||a.stop()}}}function ki(e){Hi({type:"sine",frequency:e.frequency,time:.1,volume:e.volume})}function Ci(e){return Hi({type:"sine",frequency:e.frequency,volume:e.volume})}let Di;function Li(e){const t=Date.now();if(Di&&t<Di+200)return;const i=new Audio("sound/piece.mp3");i.volume=.01*e,i.play(),Di=t}var Mi;function Gi(e){switch(e){case Mi.BLACK_PLAYER:return"先手";case Mi.WHITE_PLAYER:return"後手";case Mi.RESEARCHER:return"検討"}}(function(e){e["BLACK_PLAYER"]="blackPlayer",e["WHITE_PLAYER"]="whitePlayer",e["RESEARCHER"]="researcher"})(Mi||(Mi={}));const Bi=2e3,xi=-Bi;class Ui{constructor(e){if((0,Y.Z)(this,"evaluation",void 0),e){const t=JSON.parse(e);this.evaluation=t.evaluation}}updateScore(e,t,i){switch(this.evaluation||(this.evaluation={}),t){case Mi.BLACK_PLAYER:this.evaluation[Mi.BLACK_PLAYER]=i;break;case Mi.WHITE_PLAYER:this.evaluation[Mi.WHITE_PLAYER]=-i;break;case Mi.RESEARCHER:this.evaluation[Mi.RESEARCHER]=e===V.BLACK?i:-i;break}}updateUSIInfo(e,t,i){i.scoreCP?this.updateScore(e,t,Math.min(Math.max(i.scoreCP,xi),Bi)):i.scoreMate&&this.updateScore(e,t,i.scoreMate>=0?Bi:xi)}stringify(){return JSON.stringify(this)}}class Wi{constructor(){(0,Y.Z)(this,"black",void 0),(0,Y.Z)(this,"white",void 0),(0,Y.Z)(this,"timerHandle",void 0),(0,Y.Z)(this,"timerStart",void 0),(0,Y.Z)(this,"lastTimeMs",void 0),(0,Y.Z)(this,"_elapsedMs",void 0),(0,Y.Z)(this,"_setting",void 0),this.black={timeMs:0,byoyomi:0},this.white={timeMs:0,byoyomi:0},this.timerHandle=0,this.timerStart=new Date,this.lastTimeMs=0,this._elapsedMs=0,this._setting=Jt()}get blackTimeMs(){return this.black.timeMs}get blackByoyomi(){return this.black.byoyomi}get whiteTimeMs(){return this.white.timeMs}get whiteByoyomi(){return this.white.byoyomi}get elapsedMs(){return this._elapsedMs}get setting(){return this._setting}setup(e){this.black.timeMs=1e3*e.timeLimit.timeSeconds,this.black.byoyomi=e.timeLimit.byoyomi,this.white.timeMs=1e3*e.timeLimit.timeSeconds,this.white.byoyomi=e.timeLimit.byoyomi,this._setting=e}getPlayerState(e){switch(e){case V.BLACK:return this.black;case V.WHITE:return this.white}}startTimer(e,t){const i=this.getPlayerState(e);this.timerStart=new Date,this.lastTimeMs=i.timeMs,i.byoyomi=this.setting.timeLimit.byoyomi,this.timerHandle=window.setInterval((()=>{const e=i.timeMs,n=i.byoyomi,o=new Date;this._elapsedMs=o.getTime()-this.timerStart.getTime();const a=this.lastTimeMs-this._elapsedMs;if(a>=0?i.timeMs=a:(i.timeMs=0,i.byoyomi=Math.max(Math.ceil(this.setting.timeLimit.byoyomi+a/1e3),0)),0===i.timeMs&&0===i.byoyomi)return void t.timeout();const s=Math.ceil(e/1e3),r=Math.ceil(i.timeMs/1e3),c=i.byoyomi;0===r&&(e>0||c!==n)?c<=5?t.onBeepUnlimited():(c<=10||c%10===0)&&t.onBeepShort():this.setting.timeLimit.byoyomi||r===s||(r<=5?t.onBeepUnlimited():(r<=10||20===r||30===r||60===r)&&t.onBeepShort())}),100)}increment(e){this.getPlayerState(e).timeMs+=1e3*this.setting.timeLimit.increment}clearTimer(){this.timerHandle&&(window.clearInterval(this.timerHandle),this.timerHandle=0),this._elapsedMs=0}}function Ki(e){const t=e.metadata.getStandardMetadata(Fe.DATE);return t?t.trim().replaceAll(" ","_").replaceAll("/","").replaceAll(":","")+".kif":(new Date).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}).replaceAll("/","")+".kif"}var Fi,qi;(function(e){e["UPDATE_APP_SETTING"]="updateAppSetting",e["FLIP_BOARD"]="flipBoard",e["SHOW_PASTE_DIALOG"]="showPasteDialog",e["CLOSE_PASTE_DIALOG"]="closePasteDialog",e["SHOW_GAME_DIALOG"]="showGameDialog",e["SHOW_RESEARCH_DIALOG"]="showResearchDialog",e["OPEN_APP_SETTING_DIALOG"]="openAppSettingDialog",e["OPEN_USI_ENGINE_MANAGEMENT_DIALOG"]="openUSIEngineManagementDialog",e["CLOSE_DIALOG"]="closeDialog",e["NEW_RECORD"]="newRecord",e["UPDATE_RECORD_COMMENT"]="updateRecordComment",e["UPDATE_STANDARD_RECORD_METADATA"]="updateStandardRecordMetadata",e["CHANGE_TURN"]="changeTurn",e["INITIALIZE_POSITION"]="initializePosition",e["EDIT_POSITION"]="editPosition",e["CHANGE_MOVE_NUMBER"]="changeMoveNumber",e["CHANGE_BRANCH"]="changeBranch",e["REMOVE_RECORD_AFTER"]="removeRecordAfter",e["CLEAR_GAME_TIMER"]="clearGameTimer",e["UPDATE_USI_INFO"]="updateUSIInfo",e["PUSH_MESSAGE"]="pushMessage",e["SHIFT_MESSAGE"]="shiftMessage",e["PUSH_ERROR"]="pushError",e["CLEAR_ERRORS"]="clearErrors",e["RETAIN_BUSSY_STATE"]="retainBussyState",e["RELEASE_BUSSY_STATE"]="releaseBussyState"})(Fi||(Fi={})),function(e){e["UPDATE_APP_SETTING"]="updateAppSetting",e["OPEN_RECORD"]="openRecord",e["SAVE_RECORD"]="saveRecord",e["COPY_RECORD"]="copyRecord",e["PASTE_RECORD"]="pasteRecord",e["START_POSITION_EDITING"]="startPositionEditing",e["END_POSITION_EDITING"]="endPositionEditing",e["UPDATE_USI_INFO"]="updateUsiInfo",e["START_RESEARCH"]="startResearch",e["STOP_RESEARCH"]="stopResearch",e["START_GAME"]="startGame",e["STOP_GAME"]="stopGame",e["RESIGN_BY_USER"]="resign",e["DO_MOVE_BY_USER"]="doMoveByUser",e["DO_MOVE_BY_USI_ENGINE"]="doMoveByUSIEngine",e["DO_MOVE"]="doMove",e["RESET_GAME_TIMER"]="resetGameTimer",e["BEEP_UNLIMITED"]="beepUnlimited",e["BEEP_SHORT"]="beepShort"}(qi||(qi={}));const Vi={state:{count:0},getters:{isBussy(e){return 0!==e.count}},mutations:{[Fi.RETAIN_BUSSY_STATE](e){e.count+=1},[Fi.RELEASE_BUSSY_STATE](e){e.count-=1}}};function ji(e,t){const i=e.clone();let n,o="";for(const a of t){const e=i.createMoveBySFEN(a);if(!e)break;i.doMove(e,{ignoreValidation:!0}),o+=e.getDisplayText(n),n=e}return o}class Yi{constructor(e){(0,Y.Z)(this,"name",void 0),(0,Y.Z)(this,"nodes",void 0),(0,Y.Z)(this,"nps",void 0),(0,Y.Z)(this,"iterates",void 0),(0,Y.Z)(this,"hashfull",void 0),(0,Y.Z)(this,"currentMove",void 0),(0,Y.Z)(this,"currentMoveText",void 0),this.name=e,this.iterates=[]}update(e,t){const i={};if(void 0!==t.depth&&(i.depth=t.depth),void 0!==t.seldepth&&(i.selectiveDepth=t.seldepth),void 0!==t.timeMs&&(i.timeMs=t.timeMs),void 0!==t.nodes&&(this.nodes=t.nodes),t.pv&&(i.pv=t.pv,i.text=ji(e,t.pv)),void 0!==t.multipv&&(i.multiPV=t.multipv),void 0!==t.scoreCP&&(i.score=t.scoreCP),void 0!==t.scoreMate&&(i.scoreMate=t.scoreMate),void 0!==t.lowerbound&&(i.lowerBound=t.lowerbound),void 0!==t.upperbound&&(i.upperBound=t.upperbound),void 0!==t.currmove){this.currentMove=t.currmove;const i=e.createMoveBySFEN(t.currmove);i&&(this.currentMoveText=i.getDisplayText())}void 0!==t.hashfullPerMill&&(this.hashfull=t.hashfullPerMill/1e3),void 0!==t.nps&&(this.nps=t.nps),t.string&&(i.text=t.string),0!==Object.keys(i).length&&this.iterates.unshift(i)}}const Zi={mutations:{[Fi.UPDATE_USI_INFO](e,t){switch(e.sessionID!=t.sessionID&&(e.blackPlayer=void 0,e.whitePlayer=void 0,e.researcher=void 0,e.sessionID=t.sessionID),t.sender){case Mi.BLACK_PLAYER:e.blackPlayer&&e.blackPosition===t.position.sfen||(e.blackPlayer=new Yi(t.name),e.blackPosition=t.position.sfen),e.blackPlayer.update(t.position,t.info);break;case Mi.WHITE_PLAYER:e.whitePlayer&&e.whitePosition===t.position.sfen||(e.whitePlayer=new Yi(t.name),e.whitePosition=t.position.sfen),e.whitePlayer.update(t.position,t.info);break;case Mi.RESEARCHER:e.researcher&&e.researchPosition===t.position.sfen||(e.researcher=new Yi(t.name),e.researchPosition=t.position.sfen),e.researcher.update(t.position,t.info);break}}}};var zi;(function(e){e["NORMAL"]="normal",e["PASTE_DIALOG"]="pasteDialog",e["POSITION_EDITING"]="positionEditing",e["GAME"]="game",e["GAME_DIALOG"]="gameDialog",e["RESEARCH"]="research",e["RESEARCH_DIALOG"]="researchDialog",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSettingDialog",e["APP_SETTING_DIALOG"]="appSettingDialog"})(zi||(zi={}));const Ji={state:{queue:[]},getters:{hasMessage(e){return 0!==e.queue.length},message(e){return e.queue[0]}},mutations:{[Fi.PUSH_MESSAGE](e,t){e.queue.push(t)},[Fi.SHIFT_MESSAGE](e){e.queue.shift()}}},$i={state:{queue:[]},getters:{hasError(e){return 0!==e.queue.length}},mutations:{[Fi.PUSH_ERROR](e,t){t instanceof Error?e.queue.push(t):e.queue.push(new Error(t))},[Fi.CLEAR_ERRORS](e){e.queue=[]}}},Xi=Symbol();function Qi(){return(0,Pi.oR)(Xi)}const en=(0,Pi.MT)({state:{appSetting:jt(),record:new Je,mode:zi.NORMAL,usiSessionID:0,game:new Wi},modules:{usi:Zi,message:Ji,error:$i,bussy:Vi},getters:{isMovableByUser(e){switch(e.mode){case zi.NORMAL:case zi.RESEARCH:return!0;case zi.GAME:return(e.record.position.color===V.BLACK?e.game.setting.black.uri:e.game.setting.white.uri)===Yt}return!1}},mutations:{[Fi.UPDATE_APP_SETTING](e,t){e.appSetting={...e.appSetting,...t}},[Fi.FLIP_BOARD](e){e.appSetting.boardFlipping=!e.appSetting.boardFlipping,di(e.appSetting)},[Fi.SHOW_PASTE_DIALOG](e){e.mode===zi.NORMAL&&(e.mode=zi.PASTE_DIALOG)},[Fi.CLOSE_PASTE_DIALOG](e){e.mode===zi.PASTE_DIALOG&&(e.mode=zi.NORMAL)},[Fi.SHOW_GAME_DIALOG](e){e.mode===zi.NORMAL&&(e.mode=zi.GAME_DIALOG)},[Fi.SHOW_RESEARCH_DIALOG](e){e.mode===zi.NORMAL&&(e.mode=zi.RESEARCH_DIALOG)},[Fi.OPEN_APP_SETTING_DIALOG](e){e.mode===zi.NORMAL&&(e.mode=zi.APP_SETTING_DIALOG)},[Fi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG](e){e.mode===zi.NORMAL&&(e.mode=zi.USI_ENGINE_SETTING_DIALOG)},[Fi.CLOSE_DIALOG](e){e.mode!==zi.USI_ENGINE_SETTING_DIALOG&&e.mode!==zi.APP_SETTING_DIALOG&&e.mode!==zi.GAME_DIALOG&&e.mode!==zi.RESEARCH_DIALOG||(e.mode=zi.NORMAL)},[Fi.NEW_RECORD](e){e.mode==zi.NORMAL&&(e.record.clear(new Be),e.recordFilePath=void 0)},[Fi.UPDATE_RECORD_COMMENT](e,t){e.record.current.comment=t},[Fi.UPDATE_STANDARD_RECORD_METADATA](e,t){e.record.metadata.setStandardMetadata(t.key,t.value)},[Fi.CHANGE_TURN](e){if(e.mode!=zi.POSITION_EDITING)return;const t=e.record.position.clone();t.setColor(Z(t.color)),e.record.clear(t)},[Fi.INITIALIZE_POSITION](e,t){if(e.mode!=zi.POSITION_EDITING)return;const i=new Be;i.reset(t),e.record.clear(i)},[Fi.EDIT_POSITION](e,t){if(e.mode===zi.POSITION_EDITING){const i=e.record.position.clone();i.edit(t),e.record.clear(i)}},[Fi.CHANGE_MOVE_NUMBER](e,t){e.mode!==zi.NORMAL&&e.mode!==zi.RESEARCH||e.record.goto(t)},[Fi.CHANGE_BRANCH](e,t){e.mode!==zi.NORMAL&&e.mode!==zi.RESEARCH||e.record.current.branchIndex!==t&&e.record.switchBranchByIndex(t)},[Fi.REMOVE_RECORD_AFTER](e){e.mode!==zi.NORMAL&&e.mode!==zi.RESEARCH||e.record.removeAfter()},[Fi.CLEAR_GAME_TIMER](e){e.game.clearTimer(),e.beep5sHandler&&(e.beep5sHandler.stop(),e.beep5sHandler=void 0)}},actions:{async[qi.UPDATE_APP_SETTING]({commit:e,state:t},i){await di({...t.appSetting,...i}),e(Fi.UPDATE_APP_SETTING,i)},async[qi.OPEN_RECORD]({commit:e,state:t},i){if(t.mode!==zi.NORMAL)return!1;e(Fi.RETAIN_BUSSY_STATE);try{if(!i&&(i=await ai(),!i))return!1;const n=await si(i);if(i.match(/\.kif$/)||i.match(/\.kifu$/)){const o=i.match(/\.kif$/)?bi().decode(n,"Shift_JIS"):n.toString(),a=gt(o);return a instanceof Je?(t.recordFilePath=i,t.record=a):e(Fi.PUSH_ERROR,a),!0}return e(Fi.PUSH_ERROR,"不明なファイル形式: "+i),!1}catch(n){return e(Fi.PUSH_ERROR,"棋譜の読み込み中にエラーが出ました: "+n),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},async[qi.SAVE_RECORD]({commit:e,state:t},i){if(t.mode!==zi.NORMAL)return!1;e(Fi.RETAIN_BUSSY_STATE);try{let n=t.recordFilePath;if(!i?.overwrite||!n){const e=Ki(t.record);if(n=await ri(e),!n)return!1}if(n.match(/\.kif$/)||n.match(/\.kifu$/)){const e=Nt(t.record,{returnCode:t.appSetting.returnCode}),i=n.match(/\.kif$/)?bi().encode(e,"Shift_JIS"):Buffer.from(e);return await ci(n,i),t.recordFilePath=n,!0}return e(Fi.PUSH_ERROR,"不明なファイル形式: "+n),!1}catch(n){return e(Fi.PUSH_ERROR,"棋譜の保存中にエラーが出ました: "+n),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},[qi.COPY_RECORD]({state:e}){const t=Nt(e.record,{returnCode:e.appSetting.returnCode});navigator.clipboard.writeText(t)},[qi.PASTE_RECORD]({state:e,commit:t},i){if(e.mode!==zi.NORMAL)return;const n=gt(i);n instanceof Je?(e.recordFilePath=void 0,e.record=n):t(Fi.PUSH_ERROR,n)},[qi.START_POSITION_EDITING]({state:e}){e.mode===zi.NORMAL&&(e.mode=zi.POSITION_EDITING,e.record.clear(e.record.position),e.recordFilePath=void 0)},[qi.END_POSITION_EDITING]({state:e}){e.mode===zi.POSITION_EDITING&&(e.mode=zi.NORMAL)},[qi.UPDATE_USI_INFO]({state:e,commit:t},i){if(e.usiSessionID!==i.sessionID||e.record.usi!=i.usi)return;t(Fi.UPDATE_USI_INFO,{sessionID:i.sessionID,position:e.record.position,sender:i.sender,name:i.name,info:i.info});const n=new Ui(e.record.current.customData);n.updateUSIInfo(e.record.position.color,i.sender,i.info),e.record.current.customData=n.stringify()},async[qi.START_RESEARCH]({commit:e,state:t},i){if(t.mode!==zi.RESEARCH_DIALOG)return!1;e(Fi.RETAIN_BUSSY_STATE);try{return await pi(i),t.usiSessionID+=1,await fi(i,t.usiSessionID),t.mode=zi.RESEARCH,!0}catch(n){return e(Fi.PUSH_ERROR,"検討の初期化中にエラーが出ました: "+n),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},async[qi.STOP_RESEARCH]({commit:e,state:t}){if(t.mode!==zi.RESEARCH)return!1;e(Fi.RETAIN_BUSSY_STATE);try{return await Ii(),t.mode=zi.NORMAL,!0}catch(i){return e(Fi.PUSH_ERROR,"検討の終了中にエラーが出ました: "+i),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},async[qi.START_GAME]({commit:e,state:t},i){if(t.mode!==zi.GAME_DIALOG)return!1;e(Fi.RETAIN_BUSSY_STATE);try{if(await _i(i),i.startPosition){const e=new Be;e.reset(i.startPosition),t.record.clear(e),t.recordFilePath=void 0}if(t.usiSessionID+=1,await Ti(i,t.usiSessionID),t.game.setup(i),t.mode=zi.GAME,t.record.metadata.setStandardMetadata(Fe.BLACK_NAME,i.black.name),t.record.metadata.setStandardMetadata(Fe.WHITE_NAME,i.white.name),i.humanIsFront){let n=t.appSetting.boardFlipping;i.black.uri===Yt&&i.white.uri!==Yt?n=!1:i.black.uri!==Yt&&i.white.uri===Yt&&(n=!0),n!==t.appSetting.boardFlipping&&e(Fi.FLIP_BOARD)}return!0}catch(n){return e(Fi.PUSH_ERROR,"対局の初期化中にエラーが出ました: "+n),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},async[qi.STOP_GAME]({commit:e,state:t},i){if(t.mode!==zi.GAME)return!1;i&&e(Fi.PUSH_MESSAGE,`対局終了（${Ze(i)})`),e(Fi.RETAIN_BUSSY_STATE);try{return await wi(t.record.usi,i),t.record.append(i||qe.INTERRUPT),t.record.current.setElapsedMs(t.game.elapsedMs),t.mode=zi.NORMAL,!0}catch(n){return e(Fi.PUSH_ERROR,"対局の終了中にエラーが出ました: "+n),!1}finally{e(Fi.RELEASE_BUSSY_STATE)}},[qi.RESIGN_BY_USER]({state:e,getters:t,dispatch:i}){return e.mode===zi.GAME&&(t.isMovableByUser?i(qi.STOP_GAME,qe.RESIGN):void 0)},[qi.DO_MOVE_BY_USER]({dispatch:e,state:t,getters:i},n){return!!i.isMovableByUser&&(t.mode===zi.GAME&&t.game.increment(t.record.position.color),e(qi.DO_MOVE,n),!0)},[qi.DO_MOVE_BY_USI_ENGINE]({commit:e,dispatch:t,state:i},n){if(i.mode!==zi.GAME)return!1;if(i.usiSessionID!==n.sessionID)return!1;if(i.record.usi!==n.usi)return!1;if(n.color!==i.record.position.color)return e(Fi.PUSH_ERROR,"手番ではないエンジンから指し手を受信しました:"+n.sfen),t(qi.STOP_GAME,qe.FOUL_LOSE),!1;if("resign"===n.sfen)return t(qi.STOP_GAME,qe.RESIGN),!0;if("win"===n.sfen)return t(qi.STOP_GAME,qe.ENTERING_OF_KING),!0;const o=i.record.position.createMoveBySFEN(n.sfen);return o&&i.record.position.isValidMove(o)?(i.game.increment(i.record.position.color),t(qi.DO_MOVE,o),!0):(e(Fi.PUSH_ERROR,"エンジンから不明な指し手を受信しました:"+n.sfen),t(qi.STOP_GAME,qe.FOUL_LOSE),!1)},[qi.DO_MOVE]({state:e,dispatch:t},i){if(e.record.append(i,{ignoreValidation:!0}),e.record.current.setElapsedMs(e.game.elapsedMs),Li(e.appSetting.pieceVolume),e.mode!==zi.GAME)return;const n=e.record.perpetualCheck;n?n===e.record.position.color?t(qi.STOP_GAME,qe.FOUL_LOSE):t(qi.STOP_GAME,qe.FOUL_WIN):e.record.repetition&&t(qi.STOP_GAME,qe.REPETITION_DRAW)},[qi.RESET_GAME_TIMER]({dispatch:e,getters:t,state:i}){const n=i.record.position.color;i.game.startTimer(n,{timeout:()=>{t.isMovableByUser||i.game.setting.enableEngineTimeout?e(qi.STOP_GAME,qe.TIMEOUT):Oi(n)},onBeepShort:()=>{e(qi.BEEP_SHORT)},onBeepUnlimited:()=>{e(qi.BEEP_UNLIMITED)}})},[qi.BEEP_UNLIMITED]({state:e,getters:t}){(e.appSetting.clockSoundTarget!==Wt.ONLY_USER||t.isMovableByUser)&&(e.beep5sHandler||(e.beep5sHandler=Ci({frequency:e.appSetting.clockPitch,volume:e.appSetting.clockVolume})))},[qi.BEEP_SHORT]({state:e,getters:t}){(e.appSetting.clockSoundTarget!==Wt.ONLY_USER||t.isMovableByUser)&&(e.beep5sHandler||ki({frequency:e.appSetting.clockPitch,volume:e.appSetting.clockVolume}))}}});(0,o.YP)([()=>en.state.mode,()=>en.state.record.position],(()=>{en.commit(Fi.CLEAR_GAME_TIMER),en.state.mode===zi.GAME&&en.dispatch(qi.RESET_GAME_TIMER),en.state.mode!==zi.GAME&&en.state.mode!==zi.RESEARCH||Ai(en.state.record.usi,en.state.game.setting,en.state.game.blackTimeMs,en.state.game.whiteTimeMs)}),{deep:!0});const tn=["src"];function nn(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("img",{class:"icon",src:e.source},null,8,tn)}var on;(function(e){e["BUSSY"]="bussy",e["ERROR"]="error",e["INFO"]="info",e["GAME"]="game",e["STOP"]="stop",e["RESIGN"]="resign",e["RESEARCH"]="research",e["END"]="end",e["EDIT"]="edit",e["CHECK"]="check",e["SWAP"]="swap",e["SWAP_H"]="swap_h",e["SETTINGS"]="settings",e["ENGINE_SETTINGS"]="engineSettings",e["FLIP"]="flip",e["PASTE"]="paste",e["COPY"]="copy",e["DELETE"]="delete",e["COMMENT"]="comment",e["BRAIN"]="brain",e["CHART"]="chart",e["ARROW_DROP"]="arrowDrop",e["FIRST"]="first",e["BACK"]="back",e["NEXT"]="next",e["LAST"]="last"})(on||(on={}));const an={[on.BUSSY]:"icon/hourglass_empty_white_24dp.svg",[on.ERROR]:"icon/error_outline_white_24dp.svg",[on.INFO]:"icon/info_white_24dp.svg",[on.GAME]:"icon/sports_esports_white_24dp.svg",[on.STOP]:"icon/block_white_24dp.svg",[on.RESIGN]:"icon/flag_white_24dp.svg",[on.RESEARCH]:"icon/science_white_24dp.svg",[on.END]:"icon/do_disturb_on_white_24dp.svg",[on.EDIT]:"icon/app_registration_white_24dp.svg",[on.CHECK]:"icon/check_circle_white_24dp.svg",[on.SWAP]:"icon/swap_vert_white_24dp.svg",[on.SWAP_H]:"icon/swap_horiz_white_24dp.svg",[on.SETTINGS]:"icon/settings_white_24dp.svg",[on.ENGINE_SETTINGS]:"icon/settings_input_component_white_24dp.svg",[on.FLIP]:"icon/flip_camera_android_white_24dp.svg",[on.PASTE]:"icon/content_paste_white_24dp.svg",[on.COPY]:"icon/content_copy_white_24dp.svg",[on.DELETE]:"icon/backspace_white_24dp.svg",[on.COMMENT]:"icon/edit_note_white_24dp.svg",[on.BRAIN]:"icon/psychology_white_24dp.svg",[on.CHART]:"icon/show_chart_white_24dp.svg",[on.ARROW_DROP]:"icon/arrow_drop_down_white_24dp.svg",[on.FIRST]:"icon/first_page_white_24dp.svg",[on.BACK]:"icon/chevron_left_white_24dp.svg",[on.NEXT]:"icon/chevron_right_white_24dp.svg",[on.LAST]:"icon/last_page_white_24dp.svg"};Object.values(an).forEach((e=>{yt(e)}));var sn=(0,o.aZ)({name:"ButtonIcon",props:{icon:{type:String,required:!0}},setup(e){return{source:an[e.icon]}}});const rn=(0,Gt.Z)(sn,[["render",nn]]);var cn=rn,ln=(0,o.aZ)({name:"BoardPane",components:{BoardView:Kt,ButtonIcon:cn},props:{maxSize:{type:Lt,required:!0}},setup(){const e=Qi(),t=t=>{e.dispatch(qi.DO_MOVE_BY_USER,t)},i=t=>{e.commit(Fi.EDIT_POSITION,t)},n=()=>{e.commit(Fi.SHOW_GAME_DIALOG)},a=()=>{e.dispatch(qi.STOP_GAME)},s=()=>{e.dispatch(qi.RESIGN_BY_USER)},r=()=>{e.commit(Fi.SHOW_RESEARCH_DIALOG)},c=()=>{e.dispatch(qi.STOP_RESEARCH)},l=()=>{e.dispatch(qi.START_POSITION_EDITING)},u=()=>{e.dispatch(qi.END_POSITION_EDITING)},d=()=>{e.commit(Fi.INITIALIZE_POSITION,ye.STANDARD)},h=()=>{e.commit(Fi.INITIALIZE_POSITION,ye.TSUME_SHOGI)},p=()=>{e.commit(Fi.CHANGE_TURN)},m=()=>{e.commit(Fi.OPEN_APP_SETTING_DIALOG)},_=()=>{e.commit(Fi.OPEN_USI_ENGINE_MANAGEMENT_DIALOG)},g=()=>{e.commit(Fi.FLIP_BOARD)},E=()=>{e.commit(Fi.SHOW_PASTE_DIALOG)},S=()=>{e.dispatch(qi.COPY_RECORD)},v=()=>{e.commit(Fi.REMOVE_RECORD_AFTER)},f=(0,o.Fl)((()=>e.state.mode===zi.POSITION_EDITING)),I=(0,o.Fl)((()=>e.getters.isMovableByUser)),T=(0,o.Fl)((()=>e.state.record.position)),w=(0,o.Fl)((()=>{const t=e.state.record.current.move;return t instanceof Ne?t:null})),A=(0,o.Fl)((()=>e.state.appSetting.boardLayout)),O=(0,o.Fl)((()=>e.state.appSetting.boardFlipping)),R=(0,o.Fl)((()=>e.state.record.metadata.getStandardMetadata(Fe.BLACK_NAME))),N=(0,o.Fl)((()=>e.state.record.metadata.getStandardMetadata(Fe.WHITE_NAME))),P=(0,o.Fl)((()=>e.state.mode===zi.GAME?e.state.game.blackTimeMs:void 0)),y=(0,o.Fl)((()=>e.state.mode===zi.GAME?e.state.game.blackByoyomi:void 0)),b=(0,o.Fl)((()=>e.state.mode===zi.GAME?e.state.game.whiteTimeMs:void 0)),H=(0,o.Fl)((()=>e.state.mode===zi.GAME?e.state.game.whiteByoyomi:void 0)),k=(0,o.Fl)((()=>({game:e.state.mode===zi.NORMAL,stop:e.state.mode===zi.GAME,resign:e.state.mode===zi.GAME&&e.getters.isMovableByUser,research:e.state.mode===zi.NORMAL,endResearch:e.state.mode===zi.RESEARCH,startEditPosition:e.state.mode===zi.NORMAL,endEditPosition:e.state.mode===zi.POSITION_EDITING,initPosition:e.state.mode===zi.POSITION_EDITING,paste:e.state.mode===zi.NORMAL,appSettings:e.state.mode===zi.NORMAL,engineSettings:e.state.mode===zi.NORMAL})));return{layout:A,position:T,lastMove:w,flip:O,blackPlayerName:R,whitePlayerName:N,blackPlayerTimeMs:P,blackPlayerByoyomi:y,whitePlayerTimeMs:b,whitePlayerByoyomi:H,controlStates:k,onMove:t,onEdit:i,onGame:n,onStop:a,onResign:s,onResearch:r,onEndResearch:c,onStartEditPosition:l,onEndEditPosition:u,onInitPositionStandard:d,onInitPositionTsumeShogi:h,onChangeTurn:p,onOpenAppSettings:m,onOpenEngineSettings:_,onFlip:g,onPaste:E,onCopy:S,onRemoveAfter:v,allowEdit:f,allowMove:I}}});const un=(0,Gt.Z)(ln,[["render",y],["__scopeId","data-v-50b0e606"]]);var dn=un;function hn(e,t,i,n,a,s){const r=(0,o.up)("RecordView");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(r,{class:"record",record:e.record,operational:e.isRecordOperational,onGoBegin:e.goBegin,onGoBack:e.goBack,onGoForward:e.goForward,onGoEnd:e.goEnd,onSelectMove:e.selectMove,onSelectBranch:e.selectBranch},null,8,["record","operational","onGoBegin","onGoBack","onGoForward","onGoEnd","onSelectMove","onSelectBranch"])])}const pn={class:"frame"},mn={class:"controller"},_n=["disabled"],gn=["disabled"],En=["disabled"],Sn=["disabled"],vn=["disabled"],fn=["selected","value"],In=["disabled"],Tn=["selected","value"];function wn(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",pn,[(0,o._)("div",mn,[(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[0]||(t[0]=t=>e.goBegin())},[(0,o.Wm)(r,{class:"icon",icon:"first"})],8,_n),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[1]||(t[1]=t=>e.goBack())},[(0,o.Wm)(r,{class:"icon",icon:"back"})],8,gn),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[2]||(t[2]=t=>e.goForward())},[(0,o.Wm)(r,{class:"icon",icon:"next"})],8,En),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[3]||(t[3]=t=>e.goEnd())},[(0,o.Wm)(r,{class:"icon",icon:"last"})],8,Sn)]),(0,o._)("select",{ref:"moveList",class:"move-list",size:"2",disabled:!e.operational,onChange:t[4]||(t[4]=t=>e.changeNumber())},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.moves,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.number,selected:e.selected,value:e.number},(0,b.zw)(0!==e.number?e.number+" ":"")+" "+(0,b.zw)(e.text)+" "+(0,b.zw)(e.hasBranch?" 分岐":""),9,fn)))),128))],40,vn),(0,o._)("select",{ref:"branchList",class:"branch-list",size:"2",disabled:!e.operational,onChange:t[5]||(t[5]=t=>e.changeBranch())},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.branches,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.index,selected:e.selected,value:e.index},(0,b.zw)(e.text),9,Tn)))),128))],40,In)])])}var An=(0,o.aZ)({name:"RecordView",components:{ButtonIcon:cn},props:{record:{type:Je,required:!0},operational:{type:Boolean,required:!1}},emits:["goBegin","goBack","goForward","goEnd","selectMove","selectBranch"],setup(e,t){const i=(0,l.iH)(null),n=(0,l.iH)(null),a=()=>{t.emit("goBegin")},s=()=>{t.emit("goBack")},r=()=>{t.emit("goForward")},c=()=>{t.emit("goEnd")},u=()=>{t.emit("selectMove",Number(i.value.value))},d=()=>{t.emit("selectBranch",Number(n.value.value))},h=(0,o.Fl)((()=>0===e.record.current.number)),p=(0,o.Fl)((()=>{const t=[];return e.record.moves.forEach((i=>{t.push({number:i.number,text:i.displayText,hasBranch:i.hasBranch,selected:i===e.record.current})})),t})),m=(0,o.Fl)((()=>{if(!e.record.branchBegin.branch)return null;const t=[];let i;for(i=e.record.branchBegin;i&&i.move;i=i.branch)t.push({index:t.length,text:i.displayMoveText,selected:i.activeBranch});return t}));return{beginPosSelected:h,moves:p,branches:m,moveList:i,branchList:n,goBegin:a,goBack:s,goForward:r,goEnd:c,changeNumber:u,changeBranch:d}}});const On=(0,Gt.Z)(An,[["render",wn],["__scopeId","data-v-251a274f"]]);var Rn=On;const Nn=200;var Pn=(0,o.aZ)({name:"RecordPane",components:{RecordView:Rn},setup(){const e=Qi(),t=t=>{e.commit(Fi.CHANGE_MOVE_NUMBER,t)},i=()=>{t(0)},n=()=>{t(e.state.record.current.number-1)},a=()=>{t(e.state.record.current.number+1)},s=()=>{t(Number.MAX_SAFE_INTEGER)},r=e=>{t(e)},c=t=>{e.commit(Fi.CHANGE_BRANCH,t)},l=(0,o.Fl)((()=>e.state.mode===zi.NORMAL||e.state.mode===zi.RESEARCH)),u=(0,o.Fl)((()=>e.state.record));return{isRecordOperational:l,record:u,goBegin:i,goBack:n,goForward:a,goEnd:s,selectMove:r,selectBranch:c}}});const yn=(0,Gt.Z)(Pn,[["render",hn],["__scopeId","data-v-6a2b9b67"]]);var bn=yn;const Hn=e=>((0,o.dD)("data-v-597a21bc"),e=e(),(0,o.Cn)(),e),kn={class:"root"},Cn={class:"tabs"},Dn=(0,o.Uk)(" 棋譜情報 "),Ln=(0,o.Uk)(" 指し手コメント "),Mn=(0,o.Uk)(" 思考 "),Gn=(0,o.Uk)(" 形勢グラフ "),Bn=(0,o.Uk)(" 最小化 "),xn=Hn((()=>(0,o._)("div",{class:"tab-border"},null,-1))),Un={class:"tab-contents"};function Wn(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon"),c=(0,o.up)("RecordInfo"),l=(0,o.up)("RecordComment"),u=(0,o.up)("EngineAnalytics"),d=(0,o.up)("EvaluationChart");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",kn,[(0,o._)("div",{class:(0,b.C_)(["minimize-padding",{enabled:"invisible"===e.activeTab}])},null,2),(0,o._)("div",Cn,[(0,o._)("span",{class:(0,b.C_)(["tab",{selected:"recordInfo"===e.activeTab}]),onClick:t[0]||(t[0]=t=>e.changeSelect("recordInfo"))},[(0,o.Wm)(r,{class:"icon",icon:"recordInfo"}),Dn],2),(0,o._)("span",{class:(0,b.C_)(["tab",{selected:"comment"===e.activeTab}]),onClick:t[1]||(t[1]=t=>e.changeSelect("comment"))},[(0,o.Wm)(r,{class:"icon",icon:"comment"}),Ln],2),(0,o._)("span",{class:(0,b.C_)(["tab",{selected:"search"===e.activeTab}]),onClick:t[2]||(t[2]=t=>e.changeSelect("search"))},[(0,o.Wm)(r,{class:"icon",icon:"brain"}),Mn],2),(0,o._)("span",{class:(0,b.C_)(["tab",{selected:"chart"===e.activeTab}]),onClick:t[3]||(t[3]=t=>e.changeSelect("chart"))},[(0,o.Wm)(r,{class:"icon",icon:"chart"}),Gn],2),(0,o._)("span",{class:(0,b.C_)(["tab",{selected:"invisible"===e.activeTab}]),onClick:t[4]||(t[4]=t=>e.changeSelect("invisible"))},[(0,o.Wm)(r,{class:"icon",icon:"arrowDrop"}),Bn],2)]),xn,(0,o._)("div",Un,[(0,o.Wm)(c,{class:(0,b.C_)(["tab-content",{selected:"recordInfo"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,o.Wm)(l,{class:(0,b.C_)(["tab-content",{selected:"comment"===e.activeTab}])},null,8,["class"]),(0,o.Wm)(u,{class:(0,b.C_)(["tab-content",{selected:"search"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,o.Wm)(d,{class:(0,b.C_)(["tab-content",{selected:"chart"===e.activeTab}]),size:e.contentSize},null,8,["class","size"])])])])}const Kn={class:"root"},Fn=["value","readonly"];function qn(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Kn,[(0,o._)("textarea",{ref:"textarea",class:"text",value:e.comment,readonly:!!e.readonly,onInput:t[0]||(t[0]=(...t)=>e.change&&e.change(...t))},null,40,Fn)])])}var Vn=(0,o.aZ)({name:"RecordComment",setup(){const e=Qi(),t=(0,o.Fl)((()=>e.state.record.current.comment)),i=(0,o.Fl)((()=>e.state.mode!=zi.NORMAL)),n=(0,l.iH)(null),a=t=>{const i=t.target.value;e.commit(Fi.UPDATE_RECORD_COMMENT,i)};return(0,o.bv)((()=>{n.value.addEventListener("copy",(e=>{e.stopPropagation()})),n.value.addEventListener("paste",(e=>{e.stopPropagation()}))})),{textarea:n,comment:t,readonly:i,change:a}}});const jn=(0,Gt.Z)(Vn,[["render",qn],["__scopeId","data-v-eb8b10d8"]]);var Yn=jn;const Zn={class:"root"};function zn(e,t,i,n,a,s){const r=(0,o.up)("EngineAnalyticsElement");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Zn,[e.infos.blackPlayer?((0,o.wg)(),(0,o.j4)(r,{key:0,name:e.infos.blackPlayer.name,info:e.infos.blackPlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0),e.infos.whitePlayer?((0,o.wg)(),(0,o.j4)(r,{key:1,name:e.infos.whitePlayer.name,info:e.infos.whitePlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0),e.infos.researcher?((0,o.wg)(),(0,o.j4)(r,{key:2,name:e.infos.researcher.name,info:e.infos.researcher,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0)])])}const Jn=e=>((0,o.dD)("data-v-787dd2b1"),e=e(),(0,o.Cn)(),e),$n={class:"root"},Xn={class:"headers"},Qn={class:"header"},eo=Jn((()=>(0,o._)("span",{class:"label"},"エンジン名: ",-1))),to={class:"value"},io={class:"header"},no=Jn((()=>(0,o._)("span",{class:"label"},"最善手: ",-1))),oo={class:"value"},ao={class:"header"},so=Jn((()=>(0,o._)("span",{class:"label"},"秒間探索ノード(NPS): ",-1))),ro={class:"value"},co={class:"header"},lo=Jn((()=>(0,o._)("span",{class:"label"},"探索ノード数: ",-1))),uo={class:"value"},ho={class:"header"},po=Jn((()=>(0,o._)("span",{class:"label"},"ハッシュ使用率: ",-1))),mo={class:"value"},_o=(0,o.uE)('<div class="list-header" data-v-787dd2b1><div class="list-column time" data-v-787dd2b1>経過時間</div><div class="list-column multipv-index" data-v-787dd2b1>順位</div><div class="list-column depth" data-v-787dd2b1>深さ</div><div class="list-column score" data-v-787dd2b1>評価値</div></div>',1),go={class:"list-column time"},Eo={class:"list-column multipv-index"},So={class:"list-column depth"},vo={class:"list-column score"},fo={class:"list-column score-flag"},Io={class:"list-column text"};function To(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",$n,[(0,o._)("div",Xn,[(0,o._)("div",Qn,[eo,(0,o._)("span",to,(0,b.zw)(e.name),1)]),(0,o._)("div",io,[no,(0,o._)("span",oo,(0,b.zw)(e.info.currentMoveText||"---"),1)]),(0,o._)("div",ao,[so,(0,o._)("span",ro,(0,b.zw)(e.info.nps||"---"),1)]),(0,o._)("div",co,[lo,(0,o._)("span",uo,(0,b.zw)(e.info.nodes||"---"),1)]),(0,o._)("div",ho,[po,(0,o._)("span",mo,(0,b.zw)(e.info.hashfull?(100*e.info.hashfull).toFixed(1):"---")+" % ",1)])]),_o,(0,o._)("div",{class:"list",style:(0,b.j5)(`height:${e.height-36}px`)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.info.iterates,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:"list-item"},[(0,o._)("div",go,(0,b.zw)(e.timeMs?(e.timeMs/1e3).toFixed(1)+"s":""),1),(0,o._)("div",Eo,(0,b.zw)(e.multiPV||""),1),(0,o._)("div",So,(0,b.zw)(e.depth)+(0,b.zw)(e.selectiveDepth&&e.depth?"/":"")+(0,b.zw)(e.selectiveDepth),1),(0,o._)("div",vo,(0,b.zw)(e.score)+" "+(0,b.zw)(e.scoreMate?e.scoreMate:""),1),(0,o._)("div",fo,(0,b.zw)(e.lowerBound?"++":"")+" "+(0,b.zw)(e.upperBound?"--":"")+" "+(0,b.zw)(e.scoreMate?"詰":""),1),(0,o._)("div",Io,(0,b.zw)(e.text),1)])))),128))],4)])])}var wo=(0,o.aZ)({name:"EngineAnalyticsElement",props:{name:{type:String,required:!0},info:{type:Yi,required:!0},height:{type:Number,required:!0}}});const Ao=(0,Gt.Z)(wo,[["render",To],["__scopeId","data-v-787dd2b1"]]);var Oo=Ao,Ro=(0,o.aZ)({name:"EngineAnalytics",components:{EngineAnalyticsElement:Oo},props:{size:{type:Lt,required:!0}},setup(e){const t=Qi(),i=(0,o.Fl)((()=>t.state.usi)),n=(0,o.Fl)((()=>{const i=(t.state.usi.blackPlayer?1:0)+(t.state.usi.whitePlayer?1:0)+(t.state.usi.researcher?1:0);return 0!==i?e.size.height/i:0}));return{infos:i,elementHeight:n}}});const No=(0,Gt.Z)(Ro,[["render",zn],["__scopeId","data-v-7f58d4c6"]]);var Po=No;const yo={class:"root"},bo=["width","height"];function Ho(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",yo,[(0,o._)("canvas",{ref:"canvas",width:e.size.width.toFixed(0),height:e.size.height.toFixed(0)},null,8,bo)])])}var ko=i(2728),Co=(0,o.aZ)({name:"EvaluationChart",props:{size:{type:Lt,required:!0}},setup(e){const t=(0,l.iH)(null),i=Qi();let n;const a=(e,t,i)=>{const n=[];return i.moves.forEach((e=>{const i=new Ui(e.customData),o=i.evaluation&&i.evaluation[t];o&&n.push({x:e.number,y:o})})),{label:Gi(t),borderColor:e,data:n,showLine:!0}},s=e=>({label:"現在の局面",borderColor:"red",data:[{x:e.current.number,y:Bi},{x:e.current.number,y:xi}],showLine:!0,pointBorderWidth:0,pointRadius:0}),r=e=>[s(e),a("royalblue",Mi.BLACK_PLAYER,e),a("darkorange",Mi.WHITE_PLAYER,e),a("darkgreen",Mi.RESEARCHER,e)],c=e=>({x:{min:0,max:e.length+10},y:{min:xi,max:Bi}}),u=(e,t,n)=>{if(null===e.x)return;const o=n.scales.x.max-n.scales.x.min,a=n.scales.x.right-n.scales.x.left,s=(e.x-n.scales.x.left)/a*o+n.scales.x.min,r=Math.round(s);i.commit(Fi.CHANGE_MOVE_NUMBER,r)};return(0,o.bv)((()=>{const e=t.value,o=e.getContext("2d");n=new ko.kL(o,{type:"scatter",data:{datasets:r(i.state.record)},options:{color:"black",animation:{duration:0},maintainAspectRatio:!1,events:["click"],onClick:u}}),n.draw()})),(0,o.Ah)((()=>{n.destroy()})),(0,o.YP)((()=>[i.state.record]),(([e])=>{n.data.datasets=r(e),n.options.scales=c(e),n.update()}),{deep:!0}),(0,o.YP)((()=>[e.size]),(([e])=>{n.resize(e.width,e.height)}),{deep:!0}),{canvas:t}}});const Do=(0,Gt.Z)(Co,[["render",Ho],["__scopeId","data-v-c5919bb8"]]);var Lo=Do;const Mo={class:"key"},Go=["value","onInput"];function Bo(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{class:"root",style:(0,b.j5)(`height:${e.size.height}px`)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.list,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.key,class:"element"},[(0,o._)("div",Mo,(0,b.zw)(t.displayName),1),(0,o._)("input",{class:"value-input",value:t.value,onInput:i=>e.change(i,t.key)},null,40,Go)])))),128))],4)])}var xo=(0,o.aZ)({name:"RecordComment",props:{size:{type:Lt,required:!0}},setup(){const e=Qi(),t=(0,o.Fl)((()=>Object.values(Fe).map((t=>{const i=e.state.record.metadata;return{key:t,displayName:Ve(t),value:i.getStandardMetadata(t)||""}})))),i=(t,i)=>{const n=t.target;e.commit(Fi.UPDATE_STANDARD_RECORD_METADATA,{key:i,value:n.value})};return{list:t,change:i}}});const Uo=(0,Gt.Z)(xo,[["render",Bo],["__scopeId","data-v-51f6b1c6"]]);var Wo=Uo;const Ko=30,Fo=240+Ko;var qo=(0,o.aZ)({name:"InformationPane",components:{RecordComment:Yn,EngineAnalytics:Po,EvaluationChart:Lo,RecordInfo:Wo,ButtonIcon:cn},props:{size:{type:Lt,required:!0}},setup(e){const t=Qi(),i=e=>{t.dispatch(qi.UPDATE_APP_SETTING,{informationTab:e})},n=(0,o.Fl)((()=>t.state.appSetting.informationTab)),a=(0,o.Fl)((()=>e.size.reduce(new Lt(0,Ko))));return{activeTab:n,contentSize:a,changeSelect:i}}});const Vo=(0,Gt.Z)(qo,[["render",Wn],["__scopeId","data-v-597a21bc"]]);var jo=Vo,Yo=(0,o.aZ)({name:"StandardLayout",components:{BoardPane:dn,RecordPane:bn,InformationPane:jo},setup(){const e=Qi(),t=(0,l.qj)(new Lt(0,0)),i=(0,l.iH)(0),n=(0,l.iH)(null),a=()=>{t.width=window.innerWidth,t.height=window.innerHeight},s=new ResizeObserver((e=>{i.value=e[0].contentRect.height}));(0,o.bv)((()=>{a(),window.addEventListener("resize",a),s.observe(n.value)})),(0,o.Ah)((()=>{window.removeEventListener("resize",a),s.disconnect()}));const r=(0,o.Fl)((()=>{const i=e.state.appSetting.informationTab!==Ut.INVISIBLE?Fo:Ko;return new Lt(t.width-Nn,t.height-i)})),c=(0,o.Fl)((()=>new Lt(t.width,t.height-i.value)));return{topPane:n,boardPaneMaxSize:r,bottomPaneSize:c}}});const Zo=(0,Gt.Z)(Yo,[["render",c],["__scopeId","data-v-b930b812"]]);var zo=Zo;const Jo=e=>((0,o.dD)("data-v-dfe3350c"),e=e(),(0,o.Cn)(),e),$o={ref:"dialog"},Xo=Jo((()=>(0,o._)("div",{class:"dialog-title"},"対局",-1))),Qo={class:"dialog-form-area"},ea={class:"players"},ta={class:"player"},ia=Jo((()=>(0,o._)("div",{class:"top-label"},"先手（下手）",-1))),na=["value"],oa=["value"],aa={class:"player"},sa=Jo((()=>(0,o._)("div",{class:"top-label"},"後手（上手）",-1))),ra=["value"],ca=["value"],la={class:"players-control"},ua=(0,o.Uk)(" 先後入れ替え "),da={class:"dialog-form-areas-h"},ha={class:"dialog-form-area time-limit"},pa={class:"dialog-form-item"},ma=Jo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"持ち時間",-1))),_a=["value"],ga=Jo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"時間",-1))),Ea=["value"],Sa=Jo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"分",-1))),va={class:"dialog-form-item"},fa=Jo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"秒読み",-1))),Ia=["value"],Ta=Jo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"秒",-1))),wa={class:"dialog-form-item"},Aa=Jo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"増加",-1))),Oa=["value"],Ra=Jo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"秒",-1))),Na={class:"dialog-form-area flags"},Pa={class:"dialog-form-item"},ya=["value"],ba=(0,o.uE)('<option value="current" data-v-dfe3350c>現在の局面</option><option value="standard" data-v-dfe3350c>平手</option><option value="handicapLance" data-v-dfe3350c>香落ち</option><option value="handicapRightLance" data-v-dfe3350c>右香落ち</option><option value="handicapBishop" data-v-dfe3350c>角落ち</option><option value="handicapRook" data-v-dfe3350c>飛車落ち</option><option value="handicapRookLance" data-v-dfe3350c>飛車香落ち</option><option value="handicap2Pieces" data-v-dfe3350c>2枚落ち</option><option value="handicap4Pieces" data-v-dfe3350c>4枚落ち</option><option value="handicap6Pieces" data-v-dfe3350c>6枚落ち</option><option value="handicap8Pieces" data-v-dfe3350c>8枚落ち</option>',11),Ha=[ba],ka={class:"dialog-form-item"},Ca=["checked"],Da=Jo((()=>(0,o._)("label",{for:"disable-engine-timeout"},"エンジンの時間切れあり",-1))),La={class:"dialog-form-item"},Ma=["checked"],Ga=Jo((()=>(0,o._)("label",{for:"human-is-front"},"人を手前に表示する",-1))),Ba={class:"dialog-main-buttons"};function xa(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",$o,[Xo,(0,o._)("div",Qo,[(0,o._)("div",ea,[(0,o._)("div",ta,[ia,(0,o._)("select",{ref:"blackPlayerSelect",class:"player-select",size:"1",value:e.defaultValues.black.type},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.players,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,b.zw)(e.name),9,oa)))),128))],8,na)]),(0,o._)("div",aa,[sa,(0,o._)("select",{ref:"whitePlayerSelect",class:"player-select",size:"1",value:e.defaultValues.white.type},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.players,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,b.zw)(e.name),9,ca)))),128))],8,ra)])]),(0,o._)("div",la,[(0,o._)("button",{onClick:t[0]||(t[0]=(...t)=>e.onSwapColor&&e.onSwapColor(...t))},[(0,o.Wm)(r,{class:"icon",icon:"swap_h"}),ua])])]),(0,o._)("div",da,[(0,o._)("div",ha,[(0,o._)("div",pa,[ma,(0,o._)("input",{ref:"hours",class:"time-input",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.hours},null,8,_a),ga,(0,o._)("input",{ref:"minutes",class:"time-input",type:"number",min:"0",max:"59",step:"1",value:e.defaultValues.timeLimit.minutes},null,8,Ea),Sa]),(0,o._)("div",va,[fa,(0,o._)("input",{ref:"byoyomi",class:"time-input single",type:"number",min:"0",max:"60",step:"1",value:e.defaultValues.timeLimit.byoyomi},null,8,Ia),Ta]),(0,o._)("div",wa,[Aa,(0,o._)("input",{ref:"increment",class:"time-input single",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.increment},null,8,Oa),Ra])]),(0,o._)("div",Na,[(0,o._)("div",Pa,[(0,o._)("select",{ref:"startPosition",value:e.defaultValues.startPosition},Ha,8,ya)]),(0,o._)("div",ka,[(0,o._)("input",{id:"disable-engine-timeout",ref:"enableEngineTimeout",type:"checkbox",checked:e.defaultValues.enableEngineTimeout},null,8,Ca),Da]),(0,o._)("div",La,[(0,o._)("input",{id:"human-is-front",ref:"humanIsFront",type:"checkbox",checked:e.defaultValues.humanIsFront},null,8,Ma),Ga])])]),(0,o._)("div",Ba,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.onStart())},"対局開始"),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.onCancel())},"キャンセル")])],512)])}function Ua(e){e.addEventListener("cancel",(e=>{e.preventDefault(),e.stopPropagation()})),e.addEventListener("copy",(e=>{e.stopPropagation()})),e.addEventListener("paste",(e=>{e.stopPropagation()})),e.showModal()}function Wa(e){return document.getElementById(e)}var Ka=(0,o.aZ)({name:"GameDialog",components:{ButtonIcon:cn},setup(){const e=Qi(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(null),a=(0,l.iH)(null),s=(0,l.iH)(null),r=(0,l.iH)(null),c=(0,l.iH)(null),u=(0,l.iH)(null),d=(0,l.iH)(null),h=(0,l.iH)(null),p=(0,l.iH)(Jt()),m=(0,l.iH)(new Vt);e.commit(Fi.RETAIN_BUSSY_STATE),(0,o.bv)((async()=>{Ua(t.value);try{p.value=await mi(),m.value=await gi(),e.commit(Fi.RELEASE_BUSSY_STATE)}catch(i){e.commit(Fi.PUSH_ERROR,i),e.commit(Fi.CLOSE_DIALOG)}}));const _=e=>{if(zt(e)){const t=m.value.getEngine(e);return{name:t.name,uri:e,usi:t}}return{name:"人",uri:Yt}},g=()=>{const t={black:_(i.value.value),white:_(n.value.value),timeLimit:{timeSeconds:60*(60*a.value.value+s.value.value),byoyomi:Number(r.value.value),increment:Number(c.value.value)},startPosition:"current"!==u.value.value?u.value.value:void 0,enableEngineTimeout:d.value.checked,humanIsFront:h.value.checked},o=$t(t);o?e.commit(Fi.PUSH_ERROR,o):e.dispatch(qi.START_GAME,t)},E=()=>{e.commit(Fi.CLOSE_DIALOG)},S=()=>{[i.value.value,n.value.value]=[n.value.value,i.value.value]},v=(0,o.Fl)((()=>({black:{type:p.value.black.uri},white:{type:p.value.white.uri},timeLimit:{hours:Math.floor(p.value.timeLimit.timeSeconds/3600),minutes:Math.floor(p.value.timeLimit.timeSeconds/60)%60,byoyomi:p.value.timeLimit.byoyomi,increment:p.value.timeLimit.increment},startPosition:void 0!==p.value.startPosition?p.value.startPosition:"current",enableEngineTimeout:p.value.enableEngineTimeout,humanIsFront:p.value.humanIsFront}))),f=(0,o.Fl)((()=>[{name:"人",uri:Yt},...m.value.engineList]));return{dialog:t,blackPlayerSelect:i,whitePlayerSelect:n,hours:a,minutes:s,byoyomi:r,increment:c,startPosition:u,enableEngineTimeout:d,humanIsFront:h,defaultValues:v,players:f,onStart:g,onCancel:E,onSwapColor:S}}});const Fa=(0,Gt.Z)(Ka,[["render",xa],["__scopeId","data-v-dfe3350c"]]);var qa=Fa;const Va=e=>((0,o.dD)("data-v-35a19322"),e=e(),(0,o.Cn)(),e),ja={ref:"dialog"},Ya=Va((()=>(0,o._)("div",{class:"dialog-title"},"検討",-1))),Za={class:"dialog-form-area"},za={class:"dialog-form-item"},Ja=Va((()=>(0,o._)("div",{class:"dialog-form-item-label"},"エンジン",-1))),$a={class:"dialog-form-item-unit"},Xa=["value"],Qa=["value"],es={class:"dialog-main-buttons"};function ts(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",ja,[Ya,(0,o._)("div",Za,[(0,o._)("div",za,[Ja,(0,o._)("div",$a,[(0,o._)("select",{ref:"engineSelect",class:"engine-select",size:"1",value:e.defaultValue},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.engines,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,b.zw)(e.name),9,Qa)))),128))],8,Xa)])])]),(0,o._)("div",es,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=t=>e.onStart())},"検討開始"),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.onCancel())},"キャンセル")])],512)])}var is=(0,o.aZ)({name:"ResearchDialog",setup(){const e=Qi(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(Xt()),a=(0,l.iH)(new Vt);e.commit(Fi.RETAIN_BUSSY_STATE),(0,o.bv)((async()=>{Ua(t.value);try{n.value=await hi(),a.value=await gi(),e.commit(Fi.RELEASE_BUSSY_STATE)}catch(i){e.commit(Fi.PUSH_ERROR,i),e.commit(Fi.CLOSE_DIALOG)}}));const s=()=>{const t=i.value.value;if(!a.value.hasEngine(t))return void e.commit(Fi.PUSH_ERROR,"エンジンを選択してください。");const n=a.value.getEngine(t),o={usi:n};e.dispatch(qi.START_RESEARCH,o)},r=()=>{e.commit(Fi.CLOSE_DIALOG)},c=(0,o.Fl)((()=>a.value.engineList)),u=(0,o.Fl)((()=>n.value.usi?n.value.usi.uri:""));return{dialog:t,engineSelect:i,engines:c,defaultValue:u,onStart:s,onCancel:r}}});const ns=(0,Gt.Z)(is,[["render",ts],["__scopeId","data-v-35a19322"]]);var os=ns;const as=e=>((0,o.dD)("data-v-3cf8f19e"),e=e(),(0,o.Cn)(),e),ss={ref:"dialog"},rs=as((()=>(0,o._)("div",{class:"dialog-title"},"エンジン管理",-1))),cs={class:"dialog-form-area engine-list"},ls={key:0,class:"engine"},us=["value"],ds={class:"engine-name"},hs=["onClick"],ps=["onClick"],ms={class:"dialog-main-buttons"};function _s(e,t,i,n,a,s){const r=(0,o.up)("USIEngineOptionDialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",null,[(0,o._)("dialog",ss,[rs,(0,o._)("div",cs,[0===e.engines.length?((0,o.wg)(),(0,o.iD)("div",ls," エンジンが登録されていません。 ")):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.engines,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.uri,class:"engine",value:t.uri},[(0,o._)("div",ds,(0,b.zw)(t.name),1),(0,o._)("button",{class:"dialog-button",onClick:i=>e.openOptions(t.uri)}," 設定 ",8,hs),(0,o._)("button",{class:"dialog-button",onClick:i=>e.remove(t.uri)}," 削除 ",8,ps)],8,us)))),128))]),(0,o._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=t=>e.add())},"追加"),(0,o._)("div",ms,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.saveAndClose())}," 保存して閉じる "),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.cancel())},"キャンセル")])],512)]),e.optionDialog?((0,o.wg)(),(0,o.j4)(r,{key:0,"latest-engine-setting":e.optionDialog,onOk:e.optionOk,onCancel:e.optionCancel},null,8,["latest-engine-setting","onOk","onCancel"])):(0,o.kq)("",!0)],64)}const gs=e=>((0,o.dD)("data-v-38b92ec6"),e=e(),(0,o.Cn)(),e),Es={ref:"dialog"},Ss=gs((()=>(0,o._)("div",{class:"dialog-title"},"エンジン設定",-1))),vs={class:"dialog-form-area option-list"},fs={class:"option"},Is=gs((()=>(0,o._)("div",{class:"option-name"},"エンジン名",-1))),Ts={class:"option-unchangeable"},ws={class:"option"},As=gs((()=>(0,o._)("div",{class:"option-name"},"作者",-1))),Os={class:"option-unchangeable"},Rs={class:"option"},Ns=gs((()=>(0,o._)("div",{class:"option-name"},"場所",-1))),Ps={class:"option-unchangeable"},ys={class:"option"},bs=gs((()=>(0,o._)("div",{class:"option-name"},"表示名",-1))),Hs={ref:"engineNameInput",class:"option-value-text",type:"text",name:"ElectronShogiEngineName"},ks={class:"option-name"},Cs=["id","min","max","name"],Ds=["id","name"],Ls=["id","name"],Ms=["onClick"],Gs=["id"],Bs=gs((()=>(0,o._)("option",{value:""},"既定値",-1))),xs=gs((()=>(0,o._)("option",{value:"true"},"ON",-1))),Us=gs((()=>(0,o._)("option",{value:"false"},"OFF",-1))),Ws=[Bs,xs,Us],Ks=["id"],Fs=gs((()=>(0,o._)("option",{value:""},"既定値",-1))),qs=["value"],Vs=["onClick"],js={class:"dialog-main-buttons"};function Ys(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Es,[Ss,(0,o._)("div",vs,[(0,o._)("div",fs,[Is,(0,o._)("div",Ts,(0,b.zw)(e.engine.defaultName),1)]),(0,o._)("div",ws,[As,(0,o._)("div",Os,(0,b.zw)(e.engine.author),1)]),(0,o._)("div",Rs,[Ns,(0,o._)("div",Ps,(0,b.zw)(e.engine.path),1)]),(0,o._)("div",ys,[bs,(0,o._)("input",Hs,null,512)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.options,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.name,class:"option"},[(0,o._)("div",ks,(0,b.zw)(t.name),1),"spin"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:0,id:t.inputId,class:"option-value-number",type:"number",min:t.min,max:t.max,step:"1",name:t.name},null,8,Cs)):(0,o.kq)("",!0),"string"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:1,id:t.inputId,class:"option-value-text",type:"text",name:t.name},null,8,Ds)):(0,o.kq)("",!0),"filename"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:2,id:t.inputId,class:"option-value-filename",type:"text",name:t.name},null,8,Ls)):(0,o.kq)("",!0),"filename"===t.type?((0,o.wg)(),(0,o.iD)("button",{key:3,class:"dialog-button",onClick:i=>e.selectFile(t.inputId)}," 選択 ",8,Ms)):(0,o.kq)("",!0),"check"===t.type?((0,o.wg)(),(0,o.iD)("select",{key:4,id:t.inputId,class:"option-value-check"},Ws,8,Gs)):(0,o.kq)("",!0),"combo"===t.type?((0,o.wg)(),(0,o.iD)("select",{key:5,id:t.inputId,class:"option-value-combo"},[Fs,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.vars,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e},(0,b.zw)(e),9,qs)))),128))],8,Ks)):(0,o.kq)("",!0),"button"===t.type?((0,o.wg)(),(0,o.iD)("button",{key:6,class:"dialog-button",onClick:i=>e.sendOption(t.name)}," 実行 ",8,Vs)):(0,o.kq)("",!0)])))),128))]),(0,o._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=t=>e.reset())}," エンジンの既定値に戻す "),(0,o._)("div",js,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.ok())},"OK"),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.cancel())},"キャンセル")])],512)])}var Zs=(0,o.aZ)({name:"USIEngineOptionDialog",props:{latestEngineSetting:{type:Object,required:!0}},emits:["ok","cancel"],setup(e,t){const i=(0,l.iH)(null),n=(0,l.iH)(null),a=Qi(),s=e.latestEngineSetting;let r=(0,l.iH)(s);const c=(0,o.Fl)((()=>Object.values(r.value.options).sort(((e,t)=>{const i=e.name.startsWith("USI_"),n=t.name.startsWith("USI_");return i!==n?i?-1:1:e.name<t.name?-1:1})).map(((e,t)=>({...e,inputId:"usiEngineOptionDialogOption"+t,value:Ft(e)})))));a.commit(Fi.RETAIN_BUSSY_STATE),(0,o.bv)((async()=>{Ua(i.value);try{r.value=await vi(s.path),qt(r.value,s),n.value.value=r.value.name;for(const e of c.value){const t=Wa(e.inputId);t&&void 0!==e.value&&(t.value=e.value+"")}}catch(e){a.commit(Fi.PUSH_ERROR,e)}finally{a.commit(Fi.RELEASE_BUSSY_STATE)}}));const u=async e=>{a.commit(Fi.RETAIN_BUSSY_STATE);try{const t=await li(),i=Wa(e);t&&i&&(i.value=t)}catch(t){a.commit(Fi.PUSH_ERROR,t)}finally{a.commit(Fi.RELEASE_BUSSY_STATE)}},d=async e=>{a.commit(Fi.RETAIN_BUSSY_STATE);try{await Ri(r.value.path,e)}catch(t){a.commit(Fi.PUSH_ERROR,t)}finally{a.commit(Fi.RELEASE_BUSSY_STATE)}},h=()=>{n.value.value=r.value.defaultName;for(const e of c.value){const t=Wa(e.inputId);t&&(void 0!==r.value.options[e.name].default?t.value=r.value.options[e.name].default+"":t.value="")}},p=()=>{r.value.name=n.value.value;for(const e of c.value){const t=Wa(e.inputId);t&&(r.value.options[e.name].value=t.value?"spin"===e.type?Number(t.value):t.value:void 0)}t.emit("ok",r.value)},m=()=>{t.emit("cancel")};return{engine:r,dialog:i,engineNameInput:n,options:c,selectFile:u,sendOption:d,reset:h,ok:p,cancel:m}}});const zs=(0,Gt.Z)(Zs,[["render",Ys],["__scopeId","data-v-38b92ec6"]]);var Js=zs,$s=(0,o.aZ)({name:"USIEngineManagementDialog",components:{USIEngineOptionDialog:Js},setup(){const e=(0,l.iH)(null),t=(0,l.iH)(null),i=(0,l.iH)(new Vt),n=Qi();n.commit(Fi.RETAIN_BUSSY_STATE),(0,o.bv)((async()=>{Ua(e.value);try{i.value=await gi(),n.commit(Fi.RELEASE_BUSSY_STATE)}catch(t){n.commit(Fi.PUSH_ERROR,t),n.commit(Fi.CLOSE_DIALOG)}}));const a=async()=>{try{n.commit(Fi.RETAIN_BUSSY_STATE);const e=await Si();if(!e)return;i.value.addEngine(await vi(e))}catch(e){n.commit(Fi.PUSH_ERROR,e)}finally{n.commit(Fi.RELEASE_BUSSY_STATE)}},s=e=>{i.value.removeEngine(e)},r=e=>{t.value=i.value.getEngine(e)},c=async()=>{try{n.commit(Fi.RETAIN_BUSSY_STATE),await Ei(i.value),n.commit(Fi.CLOSE_DIALOG)}catch(e){n.commit(Fi.PUSH_ERROR,e)}finally{n.commit(Fi.RELEASE_BUSSY_STATE)}},u=()=>{n.commit(Fi.CLOSE_DIALOG)},d=e=>{i.value.updateEngine(e),t.value=null},h=()=>{t.value=null},p=(0,o.Fl)((()=>i.value.engineList));return{optionDialog:t,dialog:e,engines:p,add:a,remove:s,openOptions:r,saveAndClose:c,cancel:u,optionOk:d,optionCancel:h}}});const Xs=(0,Gt.Z)($s,[["render",_s],["__scopeId","data-v-3cf8f19e"]]);var Qs=Xs;const er=e=>((0,o.dD)("data-v-acb30814"),e=e(),(0,o.Cn)(),e),tr={ref:"dialog"},ir=er((()=>(0,o._)("div",{class:"dialog-title"},"アプリ設定",-1))),nr={class:"dialog-form-area settings"},or={class:"dialog-form-item"},ar=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"デザイン",-1))),sr=["value"],rr=["value"],cr={class:"dialog-form-item"},lr=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"駒音の大きさ",-1))),ur=["value"],dr=er((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"%",-1))),hr={class:"dialog-form-item"},pr=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の大きさ",-1))),mr=["value"],_r=er((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"%",-1))),gr={class:"dialog-form-item"},Er=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の高さ",-1))),Sr=["value"],vr=er((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"Hz (220 ~ 880)",-1))),fr={class:"dialog-form-item"},Ir=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の対象",-1))),Tr=["value"],wr=er((()=>(0,o._)("option",{value:"all"},"全ての手番",-1))),Ar=er((()=>(0,o._)("option",{value:"onlyUser"},"人の手番のみ",-1))),Or=[wr,Ar],Rr={class:"dialog-form-item"},Nr=er((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"改行文字",-1))),Pr=["value"],yr=er((()=>(0,o._)("option",{value:"crlf"},"CR + LF (Windows)",-1))),br=er((()=>(0,o._)("option",{value:"lf"},"LF (UNIX/Mac)",-1))),Hr=er((()=>(0,o._)("option",{value:"cr"},"CR (90年代Mac)",-1))),kr=[yr,br,Hr],Cr={class:"dialog-main-buttons"};function Dr(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",tr,[ir,(0,o._)("div",nr,[(0,o._)("div",or,[ar,(0,o._)("select",{ref:"boardLayout",value:e.appSetting.boardLayout},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.boardLayouts,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e.value},(0,b.zw)(e.name),9,rr)))),128))],8,sr)]),(0,o._)("div",cr,[lr,(0,o._)("input",{ref:"pieceVolume",value:e.appSetting.pieceVolume,type:"number",max:"100",min:"0"},null,8,ur),dr]),(0,o._)("div",hr,[pr,(0,o._)("input",{ref:"clockVolume",value:e.appSetting.clockVolume,type:"number",max:"100",min:"0"},null,8,mr),_r]),(0,o._)("div",gr,[Er,(0,o._)("input",{ref:"clockPitch",value:e.appSetting.clockPitch,type:"number",max:"880",min:"220"},null,8,Sr),vr]),(0,o._)("div",fr,[Ir,(0,o._)("select",{ref:"clockSoundTarget",value:e.appSetting.clockSoundTarget},Or,8,Tr)]),(0,o._)("div",Rr,[Nr,(0,o._)("select",{ref:"returnCode",value:e.appSetting.returnCode},kr,8,Pr)])]),(0,o._)("div",Cr,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=t=>e.saveAndClose())}," 保存して閉じる "),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.cancel())},"キャンセル")])],512)])}function Lr(e){const t=Number(e.value),i=Number(e.max),n=Number(e.min);return Math.min(Math.max(t,n),i)}const Mr={"\r\n":"crlf","\n":"lf","\r":"cr"},Gr={crlf:"\r\n",lf:"\n",cr:"\r"};var Br=(0,o.aZ)({name:"AppSettingDialog",setup(){const e=Qi(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(null),a=(0,l.iH)(null),s=(0,l.iH)(null),r=(0,l.iH)(null),c=(0,l.iH)(null);(0,o.bv)((()=>{Ua(t.value)}));const u=async()=>{const t={boardLayout:i.value.value,pieceVolume:Lr(n.value),clockVolume:Lr(a.value),clockPitch:Lr(s.value),clockSoundTarget:r.value.value,returnCode:Gr[c.value.value]};e.commit(Fi.RETAIN_BUSSY_STATE);try{await e.dispatch(qi.UPDATE_APP_SETTING,t),e.commit(Fi.CLOSE_DIALOG)}catch(o){e.commit(Fi.PUSH_ERROR,o)}finally{e.commit(Fi.RELEASE_BUSSY_STATE)}},d=()=>{e.commit(Fi.CLOSE_DIALOG)},h=(0,o.Fl)((()=>({...e.state.appSetting,returnCode:Mr[e.state.appSetting.returnCode]}))),p=[{name:"一文字駒",value:bt.HITOMOJI},{name:"一文字駒（ゴシック体）",value:bt.HITOMOJI_GOTHIC}];return{dialog:t,boardLayout:i,pieceVolume:n,clockVolume:a,clockPitch:s,clockSoundTarget:r,returnCode:c,appSetting:h,boardLayouts:p,saveAndClose:u,cancel:d}}});const xr=(0,Gt.Z)(Br,[["render",Dr],["__scopeId","data-v-acb30814"]]);var Ur=xr;const Wr=e=>((0,o.dD)("data-v-01a25e3a"),e=e(),(0,o.Cn)(),e),Kr={ref:"dialog"},Fr={ref:"content"},qr={class:"dialog-form-area"},Vr=Wr((()=>(0,o._)("div",{class:"message"},"以下の棋譜を取り込みます。",-1))),jr={key:0,class:"message"},Yr=(0,o.Uk)(" ※テキストエリアに棋譜を貼り付けてください。"),Zr=Wr((()=>(0,o._)("br",null,null,-1))),zr=(0,o.Uk)(" ※インストールアプリ版では自動的に貼り付けられます。 "),Jr=[Yr,Zr,zr],$r={ref:"textarea"},Xr={class:"dialog-main-buttons"};function Qr(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Kr,[(0,o._)("div",Fr,[(0,o._)("div",qr,[Vr,e.isNative?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",jr,Jr)),(0,o._)("textarea",$r,null,512)])],512),(0,o._)("div",Xr,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=(...t)=>e.onOk&&e.onOk(...t))},"取り込む"),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=(...t)=>e.onCancel&&e.onCancel(...t))},"キャンセル")])],512)])}var ec=(0,o.aZ)({name:"PasteDialog",setup(){const e=Qi(),t=(0,l.iH)(null),i=(0,l.iH)(null);e.commit(Fi.RETAIN_BUSSY_STATE),(0,o.bv)((async()=>{try{Ua(t.value),ii()&&(i.value.value=await navigator.clipboard.readText())}finally{e.commit(Fi.RELEASE_BUSSY_STATE)}}));const n=()=>{const t=i.value.value;e.commit(Fi.CLOSE_PASTE_DIALOG),t&&e.dispatch(qi.PASTE_RECORD,t)},a=()=>{e.commit(Fi.CLOSE_PASTE_DIALOG)};return{dialog:t,textarea:i,onOk:n,onCancel:a,isNative:ii()}}});const tc=(0,Gt.Z)(ec,[["render",Qr],["__scopeId","data-v-01a25e3a"]]);var ic=tc;const nc=e=>((0,o.dD)("data-v-4939dcf2"),e=e(),(0,o.Cn)(),e),oc={ref:"dialog",class:"bussy"},ac={class:"content"},sc=nc((()=>(0,o._)("div",{class:"message"},"処理中です。お待ち下さい。",-1)));function rc(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",oc,[(0,o._)("div",ac,[(0,o.Wm)(r,{class:"icon",icon:"bussy"}),sc])],512)])}var cc=(0,o.aZ)({name:"BussyMessage",components:{ButtonIcon:cn},setup(){const e=(0,l.iH)(null);return(0,o.bv)((()=>{Ua(e.value)})),{dialog:e}}});const lc=(0,Gt.Z)(cc,[["render",rc],["__scopeId","data-v-4939dcf2"]]);var uc=lc;const dc={ref:"dialog",class:"messagebox"},hc={class:"content"},pc={class:"message"},mc={class:"dialog-main-buttons"};function _c(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",dc,[(0,o._)("div",hc,[(0,o.Wm)(r,{class:"icon",icon:"info"}),(0,o._)("div",pc,(0,b.zw)(e.message),1)]),(0,o._)("div",mc,[(0,o._)("button",{onClick:t[0]||(t[0]=t=>e.onClose())},"閉じる")])],512)])}var gc=(0,o.aZ)({name:"InfoMessage",components:{ButtonIcon:cn},setup(){const e=Qi(),t=(0,l.iH)(null);(0,o.bv)((()=>{Ua(t.value)}));const i=(0,o.Fl)((()=>e.getters.message)),n=()=>{e.commit(Fi.SHIFT_MESSAGE)};return{dialog:t,message:i,onClose:n}}});const Ec=(0,Gt.Z)(gc,[["render",_c],["__scopeId","data-v-619a2b23"]]);var Sc=Ec;const vc={ref:"dialog",class:"error"},fc={class:"content"},Ic={class:"items"},Tc={class:"notice"},wc={class:"index"},Ac={class:"message"},Oc={class:"dialog-main-buttons"};function Rc(e,t,i,n,a,s){const r=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",vc,[(0,o._)("div",fc,[(0,o.Wm)(r,{class:"icon",icon:"error"}),(0,o._)("div",Ic,[(0,o._)("div",Tc,(0,b.zw)(e.errors.length)+" 件のエラーが発生しました。 ",1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.errors,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.index,class:"item"},[(0,o._)("p",wc,(0,b.zw)(e.index+1)+" 件目",1),(0,o._)("p",Ac,(0,b.zw)(e.message),1)])))),128))])]),(0,o._)("div",Oc,[(0,o._)("button",{onClick:t[0]||(t[0]=t=>e.onClose())},"閉じる")])],512)])}var Nc=(0,o.aZ)({name:"ErrorMessage",components:{ButtonIcon:cn},setup(){const e=Qi(),t=(0,l.iH)(null);(0,o.bv)((()=>{Ua(t.value)}));const i=(0,o.Fl)((()=>e.state.error.queue.map(((e,t)=>({message:e.message,index:t}))))),n=()=>{e.commit(Fi.CLEAR_ERRORS)};return{dialog:t,errors:i,onClose:n}}});const Pc=(0,Gt.Z)(Nc,[["render",Rc],["__scopeId","data-v-520b2a4a"]]);var yc=Pc;function bc(){const e=document.activeElement;return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement}function Hc(e,t){if(!bc())switch(e){case"ArrowUp":return t.onArrowUp;case"ArrowDown":return t.onArrowDown;case"ArrowLeft":return t.onArrowLeft;case"ArrowRight":return t.onArrowRight}}function kc(e){document.addEventListener("keydown",(t=>{const i=Hc(t.key,e);i&&(t.preventDefault(),i())}))}var Cc=(0,o.aZ)({name:"App",components:{StandardLayout:zo,GameDialog:qa,ResearchDialog:os,USIEngineManagementDialog:Qs,AppSettingDialog:Ur,PasteDialog:ic,BussyMessage:uc,InfoMessage:Sc,ErrorMessage:yc},setup(){const e=Qi(),t=(0,o.Fl)((()=>({game:e.state.mode===zi.GAME_DIALOG,research:e.state.mode===zi.RESEARCH_DIALOG,usiEngineSetting:e.state.mode===zi.USI_ENGINE_SETTING_DIALOG,appSetting:e.state.mode===zi.APP_SETTING_DIALOG,paste:e.state.mode===zi.PASTE_DIALOG,processing:e.getters.isBussy}))),i=(0,o.Fl)((()=>e.getters.hasMessage)),n=(0,o.Fl)((()=>e.getters.hasError));return(0,o.bv)((()=>{const t=document.getElementsByTagName("body")[0];t.addEventListener("copy",(t=>{e.dispatch(qi.COPY_RECORD),t.preventDefault()})),t.addEventListener("paste",(t=>{e.commit(Fi.SHOW_PASTE_DIALOG),t.preventDefault()})),t.addEventListener("dragover",(e=>{e.preventDefault()})),t.addEventListener("drop",(t=>{if(t.dataTransfer&&t.dataTransfer.files[0]){const i=t.dataTransfer.files[0].path;e.dispatch(qi.OPEN_RECORD,i)}t.preventDefault()})),kc({onArrowUp(){const t=e.state.record.current.number;e.commit(Fi.CHANGE_MOVE_NUMBER,t-1)},onArrowDown(){const t=e.state.record.current.number;e.commit(Fi.CHANGE_MOVE_NUMBER,t+1)},onArrowLeft(){e.commit(Fi.CHANGE_MOVE_NUMBER,0)},onArrowRight(){e.commit(Fi.CHANGE_MOVE_NUMBER,Number.MAX_SAFE_INTEGER)}})})),{dialogVisibilities:t,hasMessage:i,hasErrors:n}}});const Dc=(0,Gt.Z)(Cc,[["render",a]]);var Lc=Dc;ko.kL.register(...ko.zX),Ni(en),Promise.allSettled([ui().then((e=>{en.commit(Fi.UPDATE_APP_SETTING,e)})).catch((e=>{en.commit(Fi.PUSH_ERROR,new Error("アプリ設定の読み込み中にエラーが発生しました :"+e))})),async function(){const e=await oi();e&&await en.dispatch(qi.OPEN_RECORD,e)}()]).finally((()=>{(0,n.ri)(Lc).use(en,Xi).mount("#app")}))},5832:function(){}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,n,o,a){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],a=e[u][2];for(var r=!0,c=0;c<n.length;c++)(!1&a||s>=a)&&Object.keys(i.O).every((function(e){return i.O[e](n[c])}))?n.splice(c--,1):(r=!1,a<s&&(s=a));if(r){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={826:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,s=n[0],r=n[1],c=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(c)var u=c(i)}for(t&&t(n);l<s.length;l++)a=s[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=self["webpackChunkelectron_shogi"]=self["webpackChunkelectron_shogi"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(4945)}));n=i.O(n)})();
//# sourceMappingURL=index.1bc988a9.js.map