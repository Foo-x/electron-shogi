(function(){var e={7818:function(e,t,i){"use strict";i(1703);var n=i(9963),o=i(6252);function s(e,t,i,n,s,r){const a=(0,o.up)("StandardLayout"),c=(0,o.up)("GameDialog"),l=(0,o.up)("ResearchDialog"),u=(0,o.up)("USIEngineManagementDialog"),h=(0,o.up)("AppSettingDialog"),d=(0,o.up)("PasteDialog"),p=(0,o.up)("BussyMessage"),m=(0,o.up)("ConfirmDialog"),g=(0,o.up)("InfoMessage"),_=(0,o.up)("ErrorMessage");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a,{class:"main"}),e.dialogVisibilities.game?((0,o.wg)(),(0,o.j4)(c,{key:0})):(0,o.kq)("",!0),e.dialogVisibilities.research?((0,o.wg)(),(0,o.j4)(l,{key:1})):(0,o.kq)("",!0),e.dialogVisibilities.usiEngineSetting?((0,o.wg)(),(0,o.j4)(u,{key:2})):(0,o.kq)("",!0),e.dialogVisibilities.appSetting?((0,o.wg)(),(0,o.j4)(h,{key:3})):(0,o.kq)("",!0),e.dialogVisibilities.paste?((0,o.wg)(),(0,o.j4)(d,{key:4})):(0,o.kq)("",!0),e.dialogVisibilities.bussy?((0,o.wg)(),(0,o.j4)(p,{key:5})):(0,o.kq)("",!0),e.dialogVisibilities.confirm?((0,o.wg)(),(0,o.j4)(m,{key:6})):(0,o.kq)("",!0),e.hasMessage?((0,o.wg)(),(0,o.j4)(g,{key:7})):(0,o.kq)("",!0),e.hasErrors?((0,o.wg)(),(0,o.j4)(_,{key:8})):(0,o.kq)("",!0)],64)}const r={class:"main"},a={ref:"topPane",class:"top-pane"};function c(e,t,i,n,s,c){const l=(0,o.up)("BoardPane"),u=(0,o.up)("RecordPane"),h=(0,o.up)("TabPane");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",r,[(0,o._)("div",a,[(0,o.Wm)(l,{class:"top-left-pane","max-size":e.boardPaneMaxSize},null,8,["max-size"]),(0,o.Wm)(u,{class:"top-right-pane"})],512),(0,o.Wm)(h,{class:"bottom-pane",size:e.bottomPaneSize},null,8,["size"])])])}var l=i(2262);const u={class:"control top"},h=(0,o.Uk)(" 対局 "),d=(0,o.Uk)(" 中断 "),p=(0,o.Uk)(" 投了 "),m=(0,o.Uk)(" 検討 "),g=(0,o.Uk)(" 検討終了 "),_=(0,o.Uk)(" 局面編集 "),v=(0,o.Uk)(" 局面編集終了 "),f=(0,o.Uk)(" 手番変更 "),w={class:"control bottom"},E=["disabled"],S=(0,o.Uk)(" アプリ設定 "),I=["disabled"],y=(0,o.Uk)(" エンジン設定 "),T=(0,o.Uk)(" 盤面反転 "),b=["disabled"],N=(0,o.Uk)(" 棋譜貼り付け "),O=(0,o.Uk)(" 棋譜コピー "),A=["disabled"],P=(0,o.Uk)(" 指し手削除 ");function R(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon"),c=(0,o.up)("BoardView");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(c,{"piece-image-type":e.pieceImageType,"board-image-type":e.boardImageType,"max-size":e.maxSize,position:e.position,"last-move":e.lastMove,flip:e.flip,"allow-move":e.allowMove,"allow-edit":e.allowEdit,"black-player-name":e.blackPlayerName,"white-player-name":e.whitePlayerName,"black-player-time-ms":e.blackPlayerTimeMs,"black-player-byoyomi":e.blackPlayerByoyomi,"white-player-time-ms":e.whitePlayerTimeMs,"white-player-byoyomi":e.whitePlayerByoyomi,onMove:e.onMove,onEdit:e.onEdit},{"right-control":(0,o.w5)((()=>[(0,o._)("div",u,[e.controlStates.game?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.onGame&&e.onGame(...t))},[(0,o.Wm)(a,{class:"icon",icon:"game"}),h])):(0,o.kq)("",!0),e.controlStates.stop?((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:t[1]||(t[1]=(...t)=>e.onStop&&e.onStop(...t))},[(0,o.Wm)(a,{class:"icon",icon:"stop"}),d])):(0,o.kq)("",!0),e.controlStates.resign?((0,o.wg)(),(0,o.iD)("button",{key:2,onClick:t[2]||(t[2]=(...t)=>e.onResign&&e.onResign(...t))},[(0,o.Wm)(a,{class:"icon",icon:"resign"}),p])):(0,o.kq)("",!0),e.controlStates.research?((0,o.wg)(),(0,o.iD)("button",{key:3,onClick:t[3]||(t[3]=(...t)=>e.onResearch&&e.onResearch(...t))},[(0,o.Wm)(a,{class:"icon",icon:"research"}),m])):(0,o.kq)("",!0),e.controlStates.endResearch?((0,o.wg)(),(0,o.iD)("button",{key:4,onClick:t[4]||(t[4]=(...t)=>e.onEndResearch&&e.onEndResearch(...t))},[(0,o.Wm)(a,{class:"icon",icon:"end"}),g])):(0,o.kq)("",!0),e.controlStates.startEditPosition?((0,o.wg)(),(0,o.iD)("button",{key:5,onClick:t[5]||(t[5]=(...t)=>e.onStartEditPosition&&e.onStartEditPosition(...t))},[(0,o.Wm)(a,{class:"icon",icon:"edit"}),_])):(0,o.kq)("",!0),e.controlStates.endEditPosition?((0,o.wg)(),(0,o.iD)("button",{key:6,onClick:t[6]||(t[6]=(...t)=>e.onEndEditPosition&&e.onEndEditPosition(...t))},[(0,o.Wm)(a,{class:"icon",icon:"check"}),v])):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:7,onClick:t[7]||(t[7]=(...t)=>e.onChangeTurn&&e.onChangeTurn(...t))},[(0,o.Wm)(a,{class:"icon",icon:"swap"}),f])):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:8,onClick:t[8]||(t[8]=(...t)=>e.onInitPositionStandard&&e.onInitPositionStandard(...t))}," 平手 ")):(0,o.kq)("",!0),e.controlStates.initPosition?((0,o.wg)(),(0,o.iD)("button",{key:9,onClick:t[9]||(t[9]=(...t)=>e.onInitPositionTsumeShogi&&e.onInitPositionTsumeShogi(...t))}," 詰将棋 ")):(0,o.kq)("",!0)])])),"left-control":(0,o.w5)((()=>[(0,o._)("div",w,[(0,o._)("button",{disabled:!e.controlStates.appSettings,onClick:t[10]||(t[10]=(...t)=>e.onOpenAppSettings&&e.onOpenAppSettings(...t))},[(0,o.Wm)(a,{class:"icon",icon:"settings"}),S],8,E),(0,o._)("button",{disabled:!e.controlStates.engineSettings,onClick:t[11]||(t[11]=(...t)=>e.onOpenEngineSettings&&e.onOpenEngineSettings(...t))},[(0,o.Wm)(a,{class:"icon",icon:"engineSettings"}),y],8,I),(0,o._)("button",{onClick:t[12]||(t[12]=(...t)=>e.onFlip&&e.onFlip(...t))},[(0,o.Wm)(a,{class:"icon",icon:"flip"}),T]),(0,o._)("button",{disabled:!e.controlStates.paste,onClick:t[13]||(t[13]=(...t)=>e.onPaste&&e.onPaste(...t))},[(0,o.Wm)(a,{class:"icon",icon:"paste"}),N],8,b),(0,o._)("button",{onClick:t[14]||(t[14]=(...t)=>e.onCopy&&e.onCopy(...t))},[(0,o.Wm)(a,{class:"icon",icon:"copy"}),O]),(0,o._)("button",{disabled:!e.controlStates.removeAfter,onClick:t[15]||(t[15]=(...t)=>e.onRemoveAfter&&e.onRemoveAfter(...t))},[(0,o.Wm)(a,{class:"icon",icon:"delete"}),P],8,A)])])),_:1},8,["piece-image-type","board-image-type","max-size","position","last-move","flip","allow-move","allow-edit","black-player-name","white-player-name","black-player-time-ms","black-player-byoyomi","white-player-time-ms","white-player-byoyomi","onMove","onEdit"])])}var k=i(3577);const H=["src"],C={class:"player-name-text"},M={class:"clock-text"},D={class:"player-name-text"},L={class:"clock-text"},B=["src"],G=["onClick","onContextmenu"],x=["src"],K=["onClick"],W=["src"],F=["onClick"],q=["src"],U=["src"];function Z(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{class:"frame",style:(0,k.j5)(e.layout.frame.style),onClick:t[2]||(t[2]=t=>e.clickFrame())},[(0,o._)("div",{class:"board",style:(0,k.j5)(e.layout.board.style)},[(0,o._)("img",{class:"board-image",src:e.layout.board.imagePath},null,8,H)],4),(0,o._)("div",{class:(0,k.C_)(["player-name",{active:"black"==e.position.color}]),style:(0,k.j5)(e.layout.blackPlayerName.style)},[(0,o._)("span",C,"▲"+(0,k.zw)(e.blackPlayerName),1)],6),(0,o._)("div",{class:(0,k.C_)(["clock",e.blackPlayerTimeSeverity]),style:(0,k.j5)(e.layout.blackClock.style)},[(0,o._)("span",M,(0,k.zw)(e.blackPlayerTimeText),1)],6),(0,o._)("div",{class:(0,k.C_)(["player-name",{active:"white"==e.position.color}]),style:(0,k.j5)(e.layout.whitePlayerName.style)},[(0,o._)("span",D,"△"+(0,k.zw)(e.whitePlayerName),1)],6),(0,o._)("div",{class:(0,k.C_)(["clock",e.whitePlayerTimeSeverity]),style:(0,k.j5)(e.layout.whiteClock.style)},[(0,o._)("span",L,(0,k.zw)(e.whitePlayerTimeText),1)],6),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.square,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"square",style:(0,k.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.piece,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,k.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,B)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.square,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"square",style:(0,k.j5)(t.style),onClick:i=>e.clickSquare(i,t.file,t.rank),onContextmenu:i=>e.clickSquareR(i,t.file,t.rank)},null,44,G)))),128)),(0,o._)("div",{class:"hand",style:(0,k.j5)(e.layout.blackHand.style)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pointers,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"hand-pointer",style:(0,k.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pieces,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,k.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,x)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.blackHand.pointers,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"hand-pointer",style:(0,k.j5)(t.style),onClick:i=>e.clickHand(i,"black",t.type)},null,12,K)))),128))],4),(0,o._)("div",{class:"hand",style:(0,k.j5)(e.layout.whiteHand.style)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pointers,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"hand-pointer",style:(0,k.j5)(e.backgroundStyle)},null,4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pieces,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"piece",style:(0,k.j5)(e.style)},[(0,o._)("img",{class:"piece-image",src:e.imagePath},null,8,W)],4)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.layout.whiteHand.pointers,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"hand-pointer",style:(0,k.j5)(t.style),onClick:i=>e.clickHand(i,"white",t.type)},null,12,F)))),128))],4),e.layout.promotion?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"promotion-selector",style:(0,k.j5)(e.layout.promotion.style)},[(0,o._)("div",{class:"select-button promote",onClick:t[0]||(t[0]=t=>e.clickPromote(t))},[(0,o._)("img",{class:"piece-image",src:e.layout.promotion.promoteImagePath},null,8,q)]),(0,o._)("div",{class:"select-button not-promote",onClick:t[1]||(t[1]=t=>e.clickNotPromote(t))},[(0,o._)("img",{class:"piece-image",src:e.layout.promotion.notPromoteImagePath},null,8,U)])],4)):(0,o.kq)("",!0),(0,o._)("div",{class:"turn",style:(0,k.j5)(e.layout.turn.style)},"手番",4),(0,o._)("div",{style:(0,k.j5)(e.layout.control.left.style)},[(0,o.WI)(e.$slots,"left-control",{},void 0,!0)],4),(0,o._)("div",{style:(0,k.j5)(e.layout.control.right.style)},[(0,o.WI)(e.$slots,"right-control",{},void 0,!0)],4)],4)])}i(7686),i(4506);var j,z,V=i(2482);function Y(e){return e===j.BLACK?j.WHITE:j.BLACK}function J(e){return e===j.BLACK?"b":"w"}function $(e){return"b"===e||"w"===e}function X(e){return"b"===e?j.BLACK:j.WHITE}(function(e){e["BLACK"]="black",e["WHITE"]="white"})(j||(j={})),function(e){e["PAWN"]="pawn",e["LANCE"]="lance",e["KNIGHT"]="knight",e["SILVER"]="silver",e["GOLD"]="gold",e["BISHOP"]="bishop",e["ROOK"]="rook",e["KING"]="king",e["PROM_PAWN"]="promPawn",e["PROM_LANCE"]="promLance",e["PROM_KNIGHT"]="promKnight",e["PROM_SILVER"]="promSilver",e["HORSE"]="horse",e["DRAGON"]="dragon"}(z||(z={}));const Q={pawn:"歩",lance:"香",knight:"桂",silver:"銀",gold:"金",bishop:"角",rook:"飛",king:"玉",promPawn:"と",promLance:"成香",promKnight:"成桂",promSilver:"成銀",horse:"馬",dragon:"竜"};function ee(e){const t=Q[e];return t||""}z.PAWN,z.LANCE,z.KNIGHT,z.SILVER,z.GOLD,z.BISHOP,z.ROOK,z.KING,z.PROM_PAWN,z.PROM_LANCE,z.PROM_KNIGHT,z.PROM_SILVER,z.HORSE,z.DRAGON;const te=[z.PAWN,z.LANCE,z.KNIGHT,z.SILVER,z.GOLD,z.BISHOP,z.ROOK],ie={pawn:!0,lance:!0,knight:!0,silver:!0,gold:!1,bishop:!0,rook:!0,king:!1,promPawn:!1,promLance:!1,promKnight:!1,promSilver:!1,horse:!1,dragon:!1},ne={pawn:z.PROM_PAWN,lance:z.PROM_LANCE,knight:z.PROM_KNIGHT,silver:z.PROM_SILVER,bishop:z.HORSE,rook:z.DRAGON},oe={promPawn:z.PAWN,promLance:z.LANCE,promKnight:z.KNIGHT,promSilver:z.SILVER,horse:z.BISHOP,dragon:z.ROOK},se={pawn:"P",lance:"L",knight:"N",silver:"S",gold:"G",bishop:"B",rook:"R",king:"K",promPawn:"+P",promLance:"+L",promKnight:"+N",promSilver:"+S",horse:"+B",dragon:"+R"};function re(e){return se[e]}const ae={pawn:"p",lance:"l",knight:"n",silver:"s",gold:"g",bishop:"b",rook:"r",king:"k",promPawn:"+p",promLance:"+l",promKnight:"+n",promSilver:"+s",horse:"+b",dragon:"+r"},ce={P:z.PAWN,L:z.LANCE,N:z.KNIGHT,S:z.SILVER,G:z.GOLD,B:z.BISHOP,R:z.ROOK,K:z.KING,"+P":z.PROM_PAWN,"+L":z.PROM_LANCE,"+N":z.PROM_KNIGHT,"+S":z.PROM_SILVER,"+B":z.HORSE,"+R":z.DRAGON,p:z.PAWN,l:z.LANCE,n:z.KNIGHT,s:z.SILVER,g:z.GOLD,b:z.BISHOP,r:z.ROOK,k:z.KING,"+p":z.PROM_PAWN,"+l":z.PROM_LANCE,"+n":z.PROM_KNIGHT,"+s":z.PROM_SILVER,"+b":z.HORSE,"+r":z.DRAGON},le={P:j.BLACK,L:j.BLACK,N:j.BLACK,S:j.BLACK,G:j.BLACK,B:j.BLACK,R:j.BLACK,K:j.BLACK,"+P":j.BLACK,"+L":j.BLACK,"+N":j.BLACK,"+S":j.BLACK,"+B":j.BLACK,"+R":j.BLACK,p:j.WHITE,l:j.WHITE,n:j.WHITE,s:j.WHITE,g:j.WHITE,b:j.WHITE,r:j.WHITE,k:j.WHITE,"+p":j.WHITE,"+l":j.WHITE,"+n":j.WHITE,"+s":j.WHITE,"+b":j.WHITE,"+r":j.WHITE},ue=new Map;ue.set(z.PAWN,{type:z.PROM_PAWN,reverseColor:!1}),ue.set(z.LANCE,{type:z.PROM_LANCE,reverseColor:!1}),ue.set(z.KNIGHT,{type:z.PROM_KNIGHT,reverseColor:!1}),ue.set(z.SILVER,{type:z.PROM_SILVER,reverseColor:!1}),ue.set(z.GOLD,{type:z.GOLD,reverseColor:!0}),ue.set(z.BISHOP,{type:z.HORSE,reverseColor:!1}),ue.set(z.ROOK,{type:z.DRAGON,reverseColor:!1}),ue.set(z.KING,{type:z.KING,reverseColor:!0}),ue.set(z.PROM_PAWN,{type:z.PAWN,reverseColor:!0}),ue.set(z.PROM_LANCE,{type:z.LANCE,reverseColor:!0}),ue.set(z.PROM_KNIGHT,{type:z.KNIGHT,reverseColor:!0}),ue.set(z.PROM_SILVER,{type:z.SILVER,reverseColor:!0}),ue.set(z.HORSE,{type:z.BISHOP,reverseColor:!0}),ue.set(z.DRAGON,{type:z.ROOK,reverseColor:!0});class he{constructor(e,t){(0,V.Z)(this,"color",void 0),(0,V.Z)(this,"type",void 0),this.type=t,this.color=e}black(){return this.withColor(j.BLACK)}white(){return this.withColor(j.WHITE)}withColor(e){return new he(e,this.type)}equals(e){return this.type===e.type&&this.color===e.color}promoted(){const e=ne[this.type];return new he(this.color,e||this.type)}unpromoted(){const e=oe[this.type];return new he(this.color,e||this.type)}isPromotable(){return!!ie[this.type]}rotate(){const e=ue.get(this.type),t=new he(this.color,e?e.type:this.type);return e&&e.reverseColor&&(t.color=Y(this.color)),t}get id(){return this.color+"_"+this.type}get sfen(){switch(this.color){default:case j.BLACK:return se[this.type];case j.WHITE:return ae[this.type]}}static isValidSFEN(e){return!!ce[e]}static newBySFEN(e){const t=ce[e];if(!t)return null;const i=le[e];return i?new he(i,t):null}}var de;(function(e){e["UP"]="up",e["DOWN"]="down",e["LEFT"]="left",e["RIGHT"]="right",e["LEFT_UP"]="left_up",e["RIGHT_UP"]="right_up",e["LEFT_DOWN"]="left_down",e["RIGHT_DOWN"]="right_down",e["LEFT_UP_KNIGHT"]="left_up_knight",e["RIGHT_UP_KNIGHT"]="right_up_knight",e["LEFT_DOWN_KNIGHT"]="left_down_knight",e["RIGHT_DOWN_KNIGHT"]="right_down_knight"})(de||(de={}));const pe={up:de.DOWN,down:de.UP,left:de.RIGHT,right:de.LEFT,left_up:de.RIGHT_DOWN,right_up:de.LEFT_DOWN,left_down:de.RIGHT_UP,right_down:de.LEFT_UP,left_up_knight:de.RIGHT_DOWN_KNIGHT,right_up_knight:de.LEFT_DOWN_KNIGHT,left_down_knight:de.RIGHT_UP_KNIGHT,right_down_knight:de.LEFT_UP_KNIGHT};function me(e){return pe[e]}const ge=[de.UP,de.DOWN,de.LEFT,de.RIGHT,de.LEFT_UP,de.RIGHT_UP,de.LEFT_DOWN,de.RIGHT_DOWN,de.LEFT_UP_KNIGHT,de.RIGHT_UP_KNIGHT,de.LEFT_DOWN_KNIGHT,de.RIGHT_DOWN_KNIGHT];var _e;(function(e){e["SHORT"]="short",e["LONG"]="long"})(_e||(_e={}));const ve={black:{pawn:{up:_e.SHORT},lance:{up:_e.LONG},knight:{left_up_knight:_e.SHORT,right_up_knight:_e.SHORT},silver:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left_down:_e.SHORT,right_down:_e.SHORT},gold:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},bishop:{left_up:_e.LONG,right_up:_e.LONG,left_down:_e.LONG,right_down:_e.LONG},rook:{up:_e.LONG,left:_e.LONG,right:_e.LONG,down:_e.LONG},king:{left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promPawn:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promLance:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promKnight:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},promSilver:{left_up:_e.SHORT,up:_e.SHORT,right_up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},horse:{left_up:_e.LONG,right_up:_e.LONG,left_down:_e.LONG,right_down:_e.LONG,up:_e.SHORT,left:_e.SHORT,right:_e.SHORT,down:_e.SHORT},dragon:{up:_e.LONG,left:_e.LONG,right:_e.LONG,down:_e.LONG,left_up:_e.SHORT,right_up:_e.SHORT,left_down:_e.SHORT,right_down:_e.SHORT}},white:{pawn:{down:_e.SHORT},lance:{down:_e.LONG},knight:{left_down_knight:_e.SHORT,right_down_knight:_e.SHORT},silver:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT},gold:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},bishop:{left_down:_e.LONG,right_down:_e.LONG,left_up:_e.LONG,right_up:_e.LONG},rook:{down:_e.LONG,left:_e.LONG,right:_e.LONG,up:_e.LONG},king:{left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promPawn:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promLance:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promKnight:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},promSilver:{left_down:_e.SHORT,down:_e.SHORT,right_down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},horse:{left_down:_e.LONG,right_down:_e.LONG,left_up:_e.LONG,right_up:_e.LONG,down:_e.SHORT,left:_e.SHORT,right:_e.SHORT,up:_e.SHORT},dragon:{down:_e.LONG,left:_e.LONG,right:_e.LONG,up:_e.LONG,left_down:_e.SHORT,right_down:_e.SHORT,left_up:_e.SHORT,right_up:_e.SHORT}}};function fe(e){return Object.keys(ve[e.color][e.type])}function we(e,t){return ve[e.color][e.type][t]}const Ee={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},left_up:{x:-1,y:-1},right_up:{x:1,y:-1},left_down:{x:-1,y:1},right_down:{x:1,y:1},left_up_knight:{x:-1,y:-2},right_up_knight:{x:1,y:-2},left_down_knight:{x:-1,y:2},right_down_knight:{x:1,y:2}};function Se(e,t){if(1===e&&-2===t)return{direction:de.RIGHT_UP_KNIGHT,distance:1,ok:!0};if(-1===e&&-2===t)return{direction:de.LEFT_UP_KNIGHT,distance:1,ok:!0};if(1===e&&2===t)return{direction:de.RIGHT_DOWN_KNIGHT,distance:1,ok:!0};if(-1===e&&2===t)return{direction:de.LEFT_DOWN_KNIGHT,distance:1,ok:!0};if(0!==e&&0!==t&&Math.abs(e)!==Math.abs(t))return{direction:"",distance:0,ok:!1};let i=e,n=t,o=0;return 0!==i&&(o=Math.abs(i),i/=o),0!==n&&(o=Math.abs(n),n/=o),-1===i&&-1===n?{direction:de.LEFT_UP,distance:o,ok:!0}:0===i&&-1===n?{direction:de.UP,distance:o,ok:!0}:1===i&&-1===n?{direction:de.RIGHT_UP,distance:o,ok:!0}:-1===i&&0===n?{direction:de.LEFT,distance:o,ok:!0}:1===i&&0===n?{direction:de.RIGHT,distance:o,ok:!0}:-1===i&&1===n?{direction:de.LEFT_DOWN,distance:o,ok:!0}:0===i&&1===n?{direction:de.DOWN,distance:o,ok:!0}:1===i&&1===n?{direction:de.RIGHT_DOWN,distance:o,ok:!0}:{direction:"",distance:0,ok:!1}}function Ie(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}function ye(e){switch(e){case"a":return 1;case"b":return 2;case"c":return 3;case"d":return 4;case"e":return 5;case"f":return 6;case"g":return 7;case"h":return 8;case"i":return 9;default:return null}}const Te=["a","b","c","d","e","f","g","h","i"];class be{constructor(e,t){(0,V.Z)(this,"file",void 0),(0,V.Z)(this,"rank",void 0),this.file=e,this.rank=t}get x(){return 9-this.file}get y(){return this.rank-1}get index(){return 9*this.y+this.x}get opposite(){return new be(10-this.file,10-this.rank)}neighbor(e,t){switch(e){case de.UP:return new be(this.file,this.rank-1);case de.DOWN:return new be(this.file,this.rank+1);case de.LEFT:return new be(this.file+1,this.rank);case de.RIGHT:return new be(this.file-1,this.rank);case de.LEFT_UP:return new be(this.file+1,this.rank-1);case de.RIGHT_UP:return new be(this.file-1,this.rank-1);case de.LEFT_DOWN:return new be(this.file+1,this.rank+1);case de.RIGHT_DOWN:return new be(this.file-1,this.rank+1);case de.LEFT_UP_KNIGHT:return new be(this.file+1,this.rank-2);case de.RIGHT_UP_KNIGHT:return new be(this.file-1,this.rank-2);case de.LEFT_DOWN_KNIGHT:return new be(this.file+1,this.rank+2);case de.RIGHT_DOWN_KNIGHT:return new be(this.file-1,this.rank+2)}const i=e,n=t;return new be(this.file-i,this.rank+n)}get valid(){return this.file>=1&&this.file<=9&&this.rank>=1&&this.rank<=9}equals(e){return!!e&&this.file===e.file&&this.rank===e.rank}static newByXY(e,t){return new be(9-e,t+1)}static newByIndex(e){return new be(9-e%9,Math.trunc(e/9)+1)}get sfen(){return this.file+Te[this.rank-1]}static parseSFENSquare(e){const t=Ie(e[0]),i=ye(e[1]);return t&&i?new be(t,i):null}}(0,V.Z)(be,"all",[]);for(let Qc=0;Qc<81;Qc+=1)be.all.push(be.newByIndex(Qc));const Ne=["１","２","３","４","５","６","７","８","９"],Oe=["一","二","三","四","五","六","七","八","九"];class Ae{constructor(e,t,i,n,o,s){(0,V.Z)(this,"from",void 0),(0,V.Z)(this,"to",void 0),(0,V.Z)(this,"promote",void 0),(0,V.Z)(this,"color",void 0),(0,V.Z)(this,"pieceType",void 0),(0,V.Z)(this,"capturedPieceType",void 0),this.from=e,this.to=t,this.promote=i,this.color=n,this.pieceType=o,this.capturedPieceType=s}equals(e){return!!e&&((this.from instanceof be&&e.from instanceof be&&this.from.equals(e.from)||!(this.from instanceof be)&&!(e.from instanceof be)&&this.from===e.from)&&this.to.equals(e.to)&&this.promote===e.promote&&this.color===e.color&&this.pieceType===e.pieceType&&this.capturedPieceType===e.capturedPieceType)}withPromote(){return new Ae(this.from,this.to,!0,this.color,this.pieceType,this.capturedPieceType)}getDisplayText(e){let t="";if(t+=this.color===j.BLACK?"▲":"△",e&&e.to.equals(this.to)?t+="同":(t+=Ne[this.to.file-1],t+=Oe[this.to.rank-1]),t+=ee(this.pieceType),this.promote&&(t+="成"),this.from instanceof be){const e=this.from;t+=` (${e.file}${e.rank})`}else t+="打";return t}get sfen(){let e="";return this.from instanceof be?e+=this.from.sfen:e+=re(this.from)+"*",e+=this.to.sfen,this.promote&&(e+="+"),e}}function Pe(e){let t;if("*"===e[1]){const i=he.newBySFEN(e[0]);if(!i)return null;t=i.type}else{const i=be.parseSFENSquare(e);if(!i)return null;t=i}const i=be.parseSFENSquare(e.substring(2));if(!i)return null;const n=e.length>=5&&"+"===e[4];return{from:t,to:i,promote:n}}var Re;function ke(e){switch(e){case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;default:return null}}(function(e){e["STANDARD"]="standard",e["EMPTY"]="empty",e["HANDICAP_LANCE"]="handicapLance",e["HANDICAP_RIGHT_LANCE"]="handicapRightLance",e["HANDICAP_BISHOP"]="handicapBishop",e["HANDICAP_ROOK"]="handicapRook",e["HANDICAP_ROOK_LANCE"]="handicapRookLance",e["HANDICAP_2PIECES"]="handicap2Pieces",e["HANDICAP_4PIECES"]="handicap4Pieces",e["HANDICAP_6PIECES"]="handicap6Pieces",e["HANDICAP_8PIECES"]="handicap8Pieces",e["TSUME_SHOGI"]="tsumeShogi"})(Re||(Re={}));class He{constructor(){(0,V.Z)(this,"squares",void 0),this.squares=new Array;for(let e=0;e<81;e+=1)this.squares.push(null);this.reset(Re.STANDARD)}at(e){return this.squares[e.index]}set(e,t){this.squares[e.index]=t}swap(e,t){const i=this.squares[e.index];this.squares[e.index]=this.squares[t.index],this.squares[t.index]=i}remove(e){const t=this.squares[e.index];return this.squares[e.index]=null,t}listNonEmptySquares(){const e=new Array;return be.all.forEach((t=>{this.squares[t.index]&&e.push(t)})),e}listSquaresByColor(e){const t=new Array;return be.all.forEach((i=>{const n=this.squares[i.index];n&&n.color===e&&t.push(i)})),t}clear(){be.all.forEach((e=>{this.squares[e.index]=null}))}reset(e){if(this.clear(),e!==Re.EMPTY&&(this.squares[new be(5,1).index]=new he(j.WHITE,z.KING),e!==Re.TSUME_SHOGI))switch(this.squares[new be(5,9).index]=new he(j.BLACK,z.KING),this.squares[new be(2,8).index]=new he(j.BLACK,z.ROOK),this.squares[new be(8,2).index]=new he(j.WHITE,z.ROOK),this.squares[new be(8,8).index]=new he(j.BLACK,z.BISHOP),this.squares[new be(2,2).index]=new he(j.WHITE,z.BISHOP),this.squares[new be(4,9).index]=new he(j.BLACK,z.GOLD),this.squares[new be(6,9).index]=new he(j.BLACK,z.GOLD),this.squares[new be(6,1).index]=new he(j.WHITE,z.GOLD),this.squares[new be(4,1).index]=new he(j.WHITE,z.GOLD),this.squares[new be(3,9).index]=new he(j.BLACK,z.SILVER),this.squares[new be(7,9).index]=new he(j.BLACK,z.SILVER),this.squares[new be(7,1).index]=new he(j.WHITE,z.SILVER),this.squares[new be(3,1).index]=new he(j.WHITE,z.SILVER),this.squares[new be(2,9).index]=new he(j.BLACK,z.KNIGHT),this.squares[new be(8,9).index]=new he(j.BLACK,z.KNIGHT),this.squares[new be(8,1).index]=new he(j.WHITE,z.KNIGHT),this.squares[new be(2,1).index]=new he(j.WHITE,z.KNIGHT),this.squares[new be(1,9).index]=new he(j.BLACK,z.LANCE),this.squares[new be(9,9).index]=new he(j.BLACK,z.LANCE),this.squares[new be(9,1).index]=new he(j.WHITE,z.LANCE),this.squares[new be(1,1).index]=new he(j.WHITE,z.LANCE),this.squares[new be(1,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(2,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(3,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(4,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(5,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(6,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(7,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(8,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(9,7).index]=new he(j.BLACK,z.PAWN),this.squares[new be(1,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(2,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(3,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(4,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(5,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(6,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(7,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(8,3).index]=new he(j.WHITE,z.PAWN),this.squares[new be(9,3).index]=new he(j.WHITE,z.PAWN),e){default:case Re.STANDARD:return;case Re.HANDICAP_LANCE:return void(this.squares[new be(1,1).index]=null);case Re.HANDICAP_RIGHT_LANCE:return void(this.squares[new be(9,1).index]=null);case Re.HANDICAP_BISHOP:return void(this.squares[new be(2,2).index]=null);case Re.HANDICAP_ROOK:return void(this.squares[new be(8,2).index]=null);case Re.HANDICAP_ROOK_LANCE:return this.squares[new be(8,2).index]=null,void(this.squares[new be(1,1).index]=null);case Re.HANDICAP_2PIECES:return this.squares[new be(8,2).index]=null,void(this.squares[new be(2,2).index]=null);case Re.HANDICAP_4PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,void(this.squares[new be(9,1).index]=null);case Re.HANDICAP_6PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,this.squares[new be(2,1).index]=null,this.squares[new be(8,1).index]=null,void(this.squares[new be(9,1).index]=null);case Re.HANDICAP_8PIECES:return this.squares[new be(8,2).index]=null,this.squares[new be(2,2).index]=null,this.squares[new be(1,1).index]=null,this.squares[new be(2,1).index]=null,this.squares[new be(3,1).index]=null,this.squares[new be(7,1).index]=null,this.squares[new be(8,1).index]=null,void(this.squares[new be(9,1).index]=null)}}get sfen(){let e="",t=0;for(let i=0;i<9;i+=1){for(let n=0;n<9;n+=1){const o=this.at(be.newByXY(n,i));o?(t&&(e+=t,t=0),e+=o.sfen):t+=1}t&&(e+=t,t=0),8!==i&&(e+="/")}return e}resetBySFEN(e){if(!He.isValidSFEN(e))return!1;this.clear();const t=e.split("/");for(let i=0;i<9;i+=1){let e=0;for(let n=0;n<t[i].length;n+=1){let o=t[i][n];"+"===o&&(n+=1,o+=t[i][n]);const s=ke(o);s?e+=s:(this.set(be.newByXY(e,i),he.newBySFEN(o)),e+=1)}}return!0}findKing(e){const t=new he(e,z.KING);return be.all.find((e=>{const i=this.at(e);if(i&&t.equals(i))return!0}))}hasPower(e,t,i){return!!ge.find((n=>{let o=0;for(let s=e.neighbor(n);s.valid;s=s.neighbor(n)){if(o+=1,i&&i.filled&&s.equals(i.filled))break;if(i&&i.ignore&&s.equals(i.ignore))continue;const e=this.at(s);if(e){if(e.color!==t)return!1;const i=me(n),s=we(e,i);return s===_e.LONG||s===_e.SHORT&&1===o}}return!1}))}isChecked(e,t){const i=this.findKing(e);return!!i&&this.hasPower(i,Y(e),{filled:t&&t.filled,ignore:t&&t.ignore})}static isValidSFEN(e){const t=e.split("/");if(9!==t.length)return!1;for(let i=0;i<9;i+=1){let e=0;for(let n=0;n<t[i].length;n+=1){let o=t[i][n];"+"===o&&(n+=1,o+=t[i][n]);const s=ke(o);if(s)e+=s;else{if(!he.isValidSFEN(o))return!1;e+=1}}if(9!==e)return!1}return!0}copyFrom(e){be.all.forEach((t=>{this.squares[t.index]=e.at(t)}))}}function Ce(e,t){return 0===e?"":(1!==e?e:"")+t.sfen}class Me{constructor(){(0,V.Z)(this,"pieces",void 0),this.pieces=new Map,this.pieces.set(z.PAWN,0),this.pieces.set(z.LANCE,0),this.pieces.set(z.KNIGHT,0),this.pieces.set(z.SILVER,0),this.pieces.set(z.GOLD,0),this.pieces.set(z.BISHOP,0),this.pieces.set(z.ROOK,0)}count(e){return this.pieces.get(e)}set(e,t){this.pieces.set(e,t)}add(e,t){let i=this.pieces.get(e);return i+=t,this.pieces.set(e,i),i}reduce(e,t){let i=this.pieces.get(e);return i-=t,this.pieces.set(e,i),i}forEach(e){e(z.PAWN,this.pieces.get(z.PAWN)),e(z.LANCE,this.pieces.get(z.LANCE)),e(z.KNIGHT,this.pieces.get(z.KNIGHT)),e(z.SILVER,this.pieces.get(z.SILVER)),e(z.GOLD,this.pieces.get(z.GOLD)),e(z.BISHOP,this.pieces.get(z.BISHOP)),e(z.ROOK,this.pieces.get(z.ROOK))}get sfenBlack(){return this.formatSFEN(j.BLACK)}get sfenWhite(){return this.formatSFEN(j.WHITE)}formatSFEN(e){let t="";return t+=Ce(this.count(z.ROOK),new he(e,z.ROOK)),t+=Ce(this.count(z.BISHOP),new he(e,z.BISHOP)),t+=Ce(this.count(z.GOLD),new he(e,z.GOLD)),t+=Ce(this.count(z.SILVER),new he(e,z.SILVER)),t+=Ce(this.count(z.KNIGHT),new he(e,z.KNIGHT)),t+=Ce(this.count(z.LANCE),new he(e,z.LANCE)),t+=Ce(this.count(z.PAWN),new he(e,z.PAWN)),""===t?"-":t}static formatSFEN(e,t){const i=e.sfenBlack,n=t.sfenWhite;return"-"===i&&"-"===n?"-":"-"===n?i:"-"===i?n:i+n}static isValidSFEN(e){return"-"===e||!!e.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/)}static parseSFEN(e){if("-"===e)return{black:new Me,white:new Me};if(!e.match(/^(?:[0-9]*[PLNSGBRplnsgbr])*$/))return null;const t=e.match(/([0-9]*[PLNSGBRplnsgbr])/g),i=new Me,n=new Me;for(let o=0;o<t.length;o+=1){const e=t[o];let s=1;e.length>=2&&(s=Number(e.substring(0,e.length-1)));const r=he.newBySFEN(e[e.length-1]);r.color===j.BLACK?i.add(r.type,s):n.add(r.type,s)}return{black:i,white:n}}copyFrom(e){e.pieces.forEach(((e,t)=>{this.pieces.set(t,e)}))}}const De={black:{pawn:{1:!0},lance:{1:!0},knight:{1:!0,2:!0}},white:{pawn:{9:!0},lance:{9:!0},knight:{9:!0,8:!0}}};function Le(e,t,i){const n=De[e][t];return!!n&&n[i]}function Be(e,t){return e===j.BLACK?t<=3:t>=7}function Ge(e,t,i){for(let n=1;n<=9;n+=1){const o=t.at(new be(i,n));if(o&&o.type===z.PAWN&&o.color===e)return!0}return!1}class xe{constructor(){(0,V.Z)(this,"_board",void 0),(0,V.Z)(this,"_color",void 0),(0,V.Z)(this,"_blackHand",void 0),(0,V.Z)(this,"_whiteHand",void 0),this._board=new He,this._color=j.BLACK,this._blackHand=new Me,this._whiteHand=new Me}get board(){return this._board}get color(){return this._color}get blackHand(){return this._blackHand}get whiteHand(){return this._whiteHand}reset(e){switch(this._board.reset(e),this._blackHand=new Me,this._whiteHand=new Me,e){case Re.STANDARD:case Re.EMPTY:case Re.TSUME_SHOGI:this._color=j.BLACK;break;case Re.HANDICAP_LANCE:case Re.HANDICAP_RIGHT_LANCE:case Re.HANDICAP_BISHOP:case Re.HANDICAP_ROOK:case Re.HANDICAP_ROOK_LANCE:case Re.HANDICAP_2PIECES:case Re.HANDICAP_4PIECES:case Re.HANDICAP_6PIECES:case Re.HANDICAP_8PIECES:this._color=j.WHITE;break}e===Re.TSUME_SHOGI&&(this._whiteHand.set(z.PAWN,18),this._whiteHand.set(z.LANCE,4),this._whiteHand.set(z.KNIGHT,4),this._whiteHand.set(z.SILVER,4),this._whiteHand.set(z.GOLD,4),this._whiteHand.set(z.BISHOP,2),this._whiteHand.set(z.ROOK,2))}hand(e){return this._hand(e)}_hand(e){return e===j.BLACK?this._blackHand:this._whiteHand}get checked(){return this._board.isChecked(this.color)}createMove(e,t){let i;if(e instanceof be){const t=this._board.at(e);if(!t)return null;i=t.type}else i=e;const n=this._board.at(t);return new Ae(e,t,!1,this.color,i,n?n.type:null)}createMoveBySFEN(e){const t=Pe(e);if(!t)return null;let i=this.createMove(t.from,t.to);return i?(t.promote&&(i=i.withPromote()),i):null}isPawnDropMate(e){if(e.from instanceof be)return!1;if(e.pieceType!==z.PAWN)return!1;const t=e.to.neighbor(e.color===j.BLACK?de.UP:de.DOWN),i=this.board.at(t);if(!i||i.type!==z.KING||i.color===e.color)return!1;const n=fe(i).find((n=>{const o=t.neighbor(n);if(!o.valid)return!1;const s=this.board.at(o);return(!s||s.color!=i.color)&&!this.board.hasPower(o,e.color)}));return!n&&!this.board.listSquaresByColor(i.color).find((n=>!n.equals(t)&&this.isMovable(n,e.to)&&!this.board.isChecked(i.color,{filled:e.to,ignore:n})))}isValidMove(e){if(e.from instanceof be){const t=this._board.at(e.from);if(!t||t.color!==this.color)return!1;if(!this.isMovable(e.from,e.to))return!1;const i=this._board.at(e.to);if(i&&i.color===this.color)return!1;if(e.promote){if(!t.isPromotable())return!1;if(!Be(this.color,e.from.rank)&&!Be(this.color,e.to.rank))return!1}else if(Le(this.color,t.type,e.to.rank))return!1;if(e.pieceType!==z.KING?this._board.isChecked(this.color,{filled:e.to,ignore:e.from}):this._board.hasPower(e.to,Y(this.color),{ignore:e.from}))return!1}else{if(e.promote)return!1;if(e.color!==this.color)return!1;if(0===this.hand(this.color).count(e.from))return!1;if(this._board.at(e.to))return!1;if(Le(this.color,e.from,e.to.rank))return!1;if(e.from===z.PAWN&&Ge(this.color,this._board,e.to.file))return!1;if(this._board.isChecked(this.color,{filled:e.to}))return!1;if(this.isPawnDropMate(e))return!1}return!0}doMove(e,t){if((!t||!t.ignoreValidation)&&!this.isValidMove(e))return!1;if(e.from instanceof be){const t=this._board.at(e.from),i=this._board.at(e.to);this._board.remove(e.from),this._board.set(e.to,e.promote?t.promoted():t),i&&i.type!==z.KING&&this._hand(this.color).add(i.unpromoted().type,1)}else this._hand(this.color).reduce(e.from,1),this._board.set(e.to,new he(this.color,e.from));return this._color=Y(this.color),!0}undoMove(e){if(this._color=Y(this.color),e.from instanceof be)if(this._board.set(e.from,new he(this.color,e.pieceType)),e.capturedPieceType){const t=new he(Y(this.color),e.capturedPieceType);this._board.set(e.to,t),t.type!==z.KING&&this._hand(this.color).reduce(t.unpromoted().type,1)}else this._board.remove(e.to);else this._hand(this.color).add(e.from,1),this._board.remove(e.to)}isValidEditing(e,t){if(e instanceof be){const i=this._board.at(e);if(!i)return!1;if(t instanceof be){if(e.equals(t))return!1}else if(i.type===z.KING)return!1}else{if(!e.color)return!1;if(0===this.hand(e.color).count(e.type))return!1;if(t instanceof be){if(this._board.at(t))return!1}else if(e.color===t)return!1}return!0}edit(e){if(e.move){if(!this.isValidEditing(e.move.from,e.move.to))return!1;if(e.move.from instanceof be)if(e.move.to instanceof be)this._board.swap(e.move.from,e.move.to);else{const t=this._board.remove(e.move.from);this._hand(e.move.to).add(t.unpromoted().type,1)}else this._hand(e.move.from.color).reduce(e.move.from.type,1),e.move.to instanceof be?this._board.set(e.move.to,e.move.from):this._hand(e.move.to).add(e.move.from.type,1)}if(e.rotate){const t=this._board.at(e.rotate);t&&this._board.set(e.rotate,t.rotate())}return!0}get sfen(){return this.getSfen(1)}getSfen(e){let t=`sfen ${this._board.sfen} ${J(this.color)} `;return t+=Me.formatSFEN(this._blackHand,this._whiteHand),t+=" "+e,t}resetBySFEN(e){if(!xe.isValidSFEN(e))return!1;const t=e.split(" ");this._board.resetBySFEN(t[1]),this._color=X(t[2]);const i=Me.parseSFEN(t[3]);return this._blackHand=i.black,this._whiteHand=i.white,!0}setColor(e){this._color=e}static isValidSFEN(e){const t=e.split(" ");return!(t.length<5)&&("sfen"===t[0]&&(!!He.isValidSFEN(t[1])&&(!!$(t[2])&&!!Me.isValidSFEN(t[3]))))}static newBySFEN(e){const t=new xe;return t.resetBySFEN(e)?t:null}isMovable(e,t){const i=t.x-e.x,n=t.y-e.y,{direction:o,distance:s,ok:r}=Se(i,n);if(!r)return!1;const a=this._board.at(e);if(!a)return!1;switch(we(a,o)){default:return!1;case _e.SHORT:return 1===s;case _e.LONG:{const i=Ee[o];for(let n=e.neighbor(i.x,i.y);n.valid;n=n.neighbor(i.x,i.y)){if(n.equals(t))return!0;if(this._board.at(n))return!1}return!1}}}copyFrom(e){this._board.copyFrom(e._board),this._color=e.color,this._blackHand.copyFrom(e._blackHand),this._whiteHand.copyFrom(e._whiteHand)}clone(){const e=new xe;return e.copyFrom(this),e}}function Ke(e){return Fe(Math.floor(e/1e3))}function We(e){return qe(Math.floor(e/1e3))}function Fe(e){const t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),n=e%60;return t+":"+String(i).padStart(2,"0")+":"+String(n).padStart(2,"0")}function qe(e){const t=Math.floor(e/60),i=e%60;return String(t).padStart(2," ")+":"+String(i).padStart(2,"0")}var Ue,Ze;function je(e){switch(e){case Ue.BLACK_NAME:return"先手";case Ue.WHITE_NAME:return"後手";case Ue.START_DATETIME:return"開始日時";case Ue.END_DATETIME:return"終了日時";case Ue.DATE:return"対局日";case Ue.TOURNAMENT:return"棋戦";case Ue.STRATEGY:return"戦型";case Ue.TITLE:return"表題";case Ue.TIME_LIMIT:return"持ち時間";case Ue.TIME_SPENT:return"消費時間";case Ue.PLACE:return"場所";case Ue.POSTED_ON:return"掲載";case Ue.NOTE:return"備考";case Ue.BLACK_SHORT_NAME:return"先手省略名";case Ue.WHITE_SHORT_NAME:return"後手省略名";case Ue.OPUS_NO:return"作品番号";case Ue.OPUS_NAME:return"作品名";case Ue.AUTHOR:return"作者";case Ue.PUBLISHED_ON:return"発表誌";case Ue.PUBLISHED_AT:return"発表年月";case Ue.SOURCE:return"出典";case Ue.LENGTH:return"手数";case Ue.INTEGRITY:return"完全性";case Ue.CATEGORY:return"分類";case Ue.AWARD:return"受賞"}}(function(e){e["BLACK_NAME"]="blackName",e["WHITE_NAME"]="whiteName",e["START_DATETIME"]="startDatetime",e["END_DATETIME"]="endDatetime",e["DATE"]="date",e["TOURNAMENT"]="tournament",e["STRATEGY"]="strategy",e["TITLE"]="title",e["TIME_LIMIT"]="timeLimit",e["TIME_SPENT"]="timeSpent",e["PLACE"]="place",e["POSTED_ON"]="postedOn",e["NOTE"]="note",e["BLACK_SHORT_NAME"]="blackShortName",e["WHITE_SHORT_NAME"]="whiteShortName",e["OPUS_NO"]="opusNo",e["OPUS_NAME"]="opusName",e["AUTHOR"]="author",e["PUBLISHED_ON"]="publishedOn",e["PUBLISHED_AT"]="publishedAt",e["SOURCE"]="source",e["LENGTH"]="length",e["INTEGRITY"]="integrity",e["CATEGORY"]="category",e["AWARD"]="award"})(Ue||(Ue={}));class ze{constructor(){(0,V.Z)(this,"standard",void 0),(0,V.Z)(this,"custom",void 0),this.standard=new Map,this.custom=new Map}get standardMetadataKeys(){return this.standard.keys()}getStandardMetadata(e){return this.standard.get(e)}setStandardMetadata(e,t){t?this.standard.set(e,t):this.standard.delete(e)}get customMetadataKeys(){return this.custom.keys()}getCustomMetadata(e){return this.custom.get(e)}setCustomMetadata(e,t){t?this.custom.set(e,t):this.custom.delete(e)}}(function(e){e["START"]="start",e["INTERRUPT"]="interrupt",e["RESIGN"]="resign",e["DRAW"]="draw",e["REPETITION_DRAW"]="repetitionDraw",e["MATE"]="mate",e["TIMEOUT"]="timeout",e["FOUL_WIN"]="foulWin",e["FOUL_LOSE"]="foulLose",e["ENTERING_OF_KING"]="enteringOfKing",e["WIN_BY_DEFAULT"]="winByDefault",e["LOSS_BY_DEFAULT"]="lossByDefault"})(Ze||(Ze={}));const Ve={start:"開始局面",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function Ye(e){return Ve[e]}class Je{constructor(e,t,i,n,o,s){(0,V.Z)(this,"number",void 0),(0,V.Z)(this,"prev",void 0),(0,V.Z)(this,"branchIndex",void 0),(0,V.Z)(this,"activeBranch",void 0),(0,V.Z)(this,"move",void 0),(0,V.Z)(this,"isCheck",void 0),(0,V.Z)(this,"next",void 0),(0,V.Z)(this,"branch",void 0),(0,V.Z)(this,"comment",void 0),(0,V.Z)(this,"customData",void 0),(0,V.Z)(this,"elapsedMs",void 0),(0,V.Z)(this,"totalElapsedMs",void 0),this.number=e,this.prev=t,this.branchIndex=i,this.activeBranch=n,this.move=o,this.isCheck=s,this.next=null,this.branch=null,this.comment="",this.elapsedMs=0,this.totalElapsedMs=0}get displayMoveText(){const e=this.prev&&this.prev.move instanceof Ae?this.prev.move:null;return this.move instanceof Ae?this.move.getDisplayText(e):Ye(this.move)}get displayText(){let e=this.displayMoveText;if(0!==this.number){const t=We(this.elapsedMs),i=Ke(this.totalElapsedMs);e+=` (${t} / ${i})`}return e}get hasBranch(){return!!this.prev&&!!this.prev.next&&!!this.prev.next.branch}get isFirstBranch(){return!this.prev||this.prev.next===this}updateTotalElapsedMs(){this.totalElapsedMs=this.elapsedMs,this.prev&&this.prev.prev&&(this.totalElapsedMs+=this.prev.prev.totalElapsedMs)}setElapsedMs(e){this.elapsedMs=e,this.updateTotalElapsedMs();let t=this.next;const i=[];while(t)t.updateTotalElapsedMs(),t.branch&&i.push(t.branch),t=t.next?t.next:i.pop()||null}}class $e{constructor(e){(0,V.Z)(this,"metadata",void 0),(0,V.Z)(this,"_initialPosition",void 0),(0,V.Z)(this,"_position",void 0),(0,V.Z)(this,"_first",void 0),(0,V.Z)(this,"_current",void 0),(0,V.Z)(this,"repetitionCounts",void 0),(0,V.Z)(this,"repetitionStart",void 0),this.metadata=new ze,this._initialPosition=e?e.clone():new xe,this._position=this.initialPosition.clone(),this._first=new Je(0,null,0,!0,Ze.START,!1),this._current=this._first,this.repetitionCounts={},this.repetitionStart={},this.incrementRepetition()}get initialPosition(){return this._initialPosition}get position(){return this._position}get first(){return this._first}get current(){return this._current}get moves(){const e=this.movesBefore;for(let t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e.push(t)}return e}get movesBefore(){return this._movesBefore}get _movesBefore(){const e=new Array;e.unshift(this._current);for(let t=this._current.prev;t;t=t.prev)e.unshift(t);return e}get length(){let e=this._current.number;for(let t=this._current.next;t;t=t.next){while(!t.activeBranch)t=t.branch;e=t.number}return e}get branchBegin(){return this._current.prev?this._current.prev.next:this._current}clear(e){this.metadata=new ze,e&&(this._initialPosition=e.clone()),this._position=this.initialPosition.clone(),this._first.next=null,this._current=this._first,this.repetitionCounts={},this.repetitionStart={},this.incrementRepetition()}goBack(){return!!this._current.prev&&(this._current.move instanceof Ae&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=this._current.prev,!0)}goForward(){if(this._current.next){this._current=this._current.next;while(!this._current.activeBranch)this._current=this._current.branch;return this._current.move instanceof Ae&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),!0}return!1}goto(e){while(e<this._current.number)if(!this.goBack())break;while(e>this._current.number)if(!this.goForward())break}resetAllBranchSelection(){this._forEach((e=>{e.activeBranch=e.isFirstBranch}))}switchBranchByIndex(e){if(!this._current.prev)return!1;let t=!1;for(let i=this._current.prev.next;i;i=i.branch)i.branchIndex===e?(i.activeBranch=!0,this._current.move instanceof Ae&&(this.decrementRepetition(),this._position.undoMove(this._current.move)),this._current=i,this._current.move instanceof Ae&&(this._position.doMove(this._current.move,{ignoreValidation:!0}),this.incrementRepetition()),t=!0):i.activeBranch=!1;return t}append(e,t){let i,n=!1;if(e instanceof Ae){if(!this._position.doMove(e,t))return!1;this.incrementRepetition(),n=this.position.checked}if(this._current===this.first||this._current.move instanceof Ae||this.goBack(),!this._current.next)return this._current.next=new Je(this._current.number+1,this._current,0,!0,e,n),this._current=this._current.next,!0;for(i=this._current.next;i;i=i.branch)i.activeBranch=!1;let o=this._current.next;for(i=this._current.next;i;i=i.branch){if(i.move instanceof Ae&&e instanceof Ae&&e.equals(i.move)||e===i.move)return this._current=i,this._current.activeBranch=!0,!0;o=i}return this._current=new Je(this._current.number+1,this._current,o.branchIndex+1,!0,e,n),o.branch=this._current,!0}removeAfter(){const e=this._current;if(!this.goBack())return void(this._current.next=null);if(this._current.next===e)this._current.next=e.branch;else for(let i=this._current.next;i;i=i.branch)if(i.branch===e){i.branch=e.branch;break}let t=0;for(let i=this._current.next;i;i=i.branch)i.branchIndex=t,t+=1;this._current.next&&(this._current.next.activeBranch=!0)}incrementRepetition(){const e=this.position.sfen;this.repetitionCounts[e]?this.repetitionCounts[e]+=1:(this.repetitionCounts[e]=1,this.repetitionStart[e]=this.current.number)}decrementRepetition(){const e=this.position.sfen;this.repetitionCounts[e]-=1,0===this.repetitionCounts[e]&&(delete this.repetitionCounts[e],delete this.repetitionStart[e])}get repetition(){return this.repetitionCounts[this.position.sfen]>=4}get perpetualCheck(){if(!this.repetition)return null;const e=this.position.sfen,t=this.repetitionStart[e];let i=!0,n=!0,o=this.position.color;for(let s=this.current;s.number>=t;s=s.prev)o=Y(o),s.isCheck||(o===j.BLACK?i=!1:n=!1);return i?j.BLACK:n?j.WHITE:null}get usi(){let e="position "+this.initialPosition.sfen+" moves";return this._movesBefore.forEach((t=>{t.move instanceof Ae&&(e+=" "+t.move.sfen)})),e}get sfen(){return"position "+this.position.getSfen(this._current.number+1)}forEach(e){this._forEach(e)}_forEach(e){let t=this._first;const i=[];while(t)e(t),t.branch&&i.push(t.branch),t=t.next?t.next:i.pop()||null}}const Xe={"先手":Ue.BLACK_NAME,"後手":Ue.WHITE_NAME,"開始日時":Ue.START_DATETIME,"終了日時":Ue.END_DATETIME,"対局日":Ue.DATE,"棋戦":Ue.TOURNAMENT,"戦型":Ue.STRATEGY,"表題":Ue.TITLE,"持ち時間":Ue.TIME_LIMIT,"消費時間":Ue.TIME_SPENT,"場所":Ue.PLACE,"掲載":Ue.POSTED_ON,"備考":Ue.NOTE,"先手省略名":Ue.BLACK_SHORT_NAME,"後手省略名":Ue.WHITE_SHORT_NAME,"作品番号":Ue.OPUS_NO,"作品名":Ue.OPUS_NAME,"作者":Ue.AUTHOR,"発表誌":Ue.PUBLISHED_ON,"発表年月":Ue.PUBLISHED_AT,"出典":Ue.SOURCE,"手数":Ue.LENGTH,"完全性":Ue.INTEGRITY,"分類":Ue.CATEGORY,"受賞":Ue.AWARD},Qe={blackName:"先手",whiteName:"後手",startDatetime:"開始日時",endDatetime:"終了日時",date:"対局日",tournament:"棋戦",strategy:"戦型",title:"表題",timeLimit:"持ち時間",timeSpent:"消費時間",place:"場所",postedOn:"掲載",note:"備考",blackShortName:"先手省略名",whiteShortName:"後手省略名",opusNo:"作品番号",opusName:"作品名",author:"作者",publishedOn:"発表誌",publishedAt:"発表年月",source:"出典",length:"手数",integrity:"完全性",category:"分類",award:"受賞"};var et;(function(e){e[e["METADATA"]=0]="METADATA",e[e["HANDICAP"]=1]="HANDICAP",e[e["BLACK_HAND"]=2]="BLACK_HAND",e[e["WHITE_HAND"]=3]="WHITE_HAND",e[e["BOARD"]=4]="BOARD",e[e["BLACK_TURN"]=5]="BLACK_TURN",e[e["WHITE_TURN"]=6]="WHITE_TURN",e[e["MOVE"]=7]="MOVE",e[e["COMMENT"]=8]="COMMENT",e[e["UNKNOWN"]=9]="UNKNOWN"})(et||(et={}));const tt=[{prefix:/^手合割：/,type:et.HANDICAP,removePrefix:!0,isPosition:!0},{prefix:/^先手の持駒：/,type:et.BLACK_HAND,removePrefix:!0,isPosition:!0},{prefix:/^後手の持駒：/,type:et.WHITE_HAND,removePrefix:!0,isPosition:!0},{prefix:/^\|/,type:et.BOARD,removePrefix:!1,isPosition:!0},{prefix:/^先手番/,type:et.BLACK_TURN,removePrefix:!1,isPosition:!0},{prefix:/^後手番/,type:et.WHITE_TURN,removePrefix:!1,isPosition:!0},{prefix:/^ *[0-9]+ +/,type:et.MOVE,removePrefix:!1,isPosition:!1},{prefix:/^\*/,type:et.COMMENT,removePrefix:!0,isPosition:!1}];function it(e){let t=e.indexOf("#");-1===t&&(t=e.length);for(let n=0;n<tt.length;n++){const i=tt[n],o=e.match(i.prefix);if(o){const n=i.removePrefix?o[0].length:0;return{type:i.type,data:e.substring(n,t),isPosition:i.isPosition,metadataKey:""}}}const i=e.match(/^[^ ]+：/);if(i){const n=i[0];return{type:et.METADATA,data:e.substring(n.length,t),isPosition:!1,metadataKey:n.substring(0,n.length-1)}}return{type:et.UNKNOWN,data:e.substring(0,t),isPosition:!1,metadataKey:""}}function nt(e,t){switch(t.trim()){case"平手":return void e.reset(Re.STANDARD);case"香落ち":return void e.reset(Re.HANDICAP_LANCE);case"右香落ち":return void e.reset(Re.HANDICAP_RIGHT_LANCE);case"角落ち":return void e.reset(Re.HANDICAP_BISHOP);case"飛車落ち":return void e.reset(Re.HANDICAP_ROOK);case"飛香落ち":return void e.reset(Re.HANDICAP_ROOK_LANCE);case"二枚落ち":return void e.reset(Re.HANDICAP_2PIECES);case"四枚落ち":return void e.reset(Re.HANDICAP_4PIECES);case"六枚落ち":return void e.reset(Re.HANDICAP_6PIECES);case"八枚落ち":return void e.reset(Re.HANDICAP_8PIECES);case"その他":return void e.reset(Re.EMPTY)}return new Error("不正なデータ:"+t)}const ot={"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9},st={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},rt={"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"十":10,"十一":11,"十二":12,"十三":13,"十四":14,"十五":15,"十六":16,"十七":17,"十八":18},at={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9},ct={"王":z.KING,"玉":z.KING,"飛":z.ROOK,"龍":z.DRAGON,"竜":z.DRAGON,"角":z.BISHOP,"馬":z.HORSE,"金":z.GOLD,"銀":z.SILVER,"成銀":z.PROM_SILVER,"全":z.PROM_SILVER,"桂":z.KNIGHT,"成桂":z.PROM_KNIGHT,"圭":z.PROM_KNIGHT,"香":z.LANCE,"成香":z.PROM_LANCE,"杏":z.PROM_LANCE,"歩":z.PAWN,"と":z.PROM_PAWN},lt={"中断":Ze.INTERRUPT,"投了":Ze.RESIGN,"持将棋":Ze.DRAW,"千日手":Ze.REPETITION_DRAW,"詰み":Ze.MATE,"切れ負け":Ze.TIMEOUT,"反則勝ち":Ze.FOUL_WIN,"反則負け":Ze.FOUL_LOSE,"入玉勝ち":Ze.ENTERING_OF_KING,"不戦勝":Ze.WIN_BY_DEFAULT,"不戦敗":Ze.LOSS_BY_DEFAULT},ut=/^ *([0-9]+) +[▲△]?([１２３４５６７８９][一二三四五六七八九]|同\u3000)(玉|飛|龍|竜|角|馬|金|銀|成銀|全|桂|成桂|圭|香|成香|杏|歩|と)(成?)(打|\([1-9][1-9]\)) *(.*)$/,ht=/\( *([0-9]+):([0-9]+)\/[0-9: ]*\)/,dt=/^ *([0-9]+) +(中断|投了|持将棋|千日手|詰み|切れ負け|反則勝ち|反則負け|入玉勝ち|不戦勝|不戦敗) *(.*)$/;function pt(e,t){if(t.length<21)return new Error("不正な盤面:"+t);const i=t[20],n=st[i];if(!n)return new Error("不正な盤面:"+t);for(let o=0;o<9;o+=1){const i=9-o,s=new be(i,n),r=2*o+1,a=t[r+1],c=ct[a];if(!c){e.remove(s);continue}const l="v"!==t[r]?j.BLACK:j.WHITE;e.set(s,new he(l,c))}}function mt(e,t){const i=t.split(/[ 　]/);for(const n of i){if(!n||"なし"===n)continue;const t=n[0],i=n.substring(1),o=ct[t],s=rt[i]||1;if(!o)return new Error("不正な持ち駒: "+n);e.add(o,s)}}function gt(e,t){const i=ht.exec(t);if(i){const t=i[1],n=i[2],o=60*Number.parseInt(t)+Number.parseInt(n);e.current.setElapsedMs(1e3*o)}}function _t(e,t){let i=dt.exec(t);if(i){const t=Number(i[1]),n=lt[i[2]],o=i[3];return e.goto(t-1),e.append(n,{ignoreValidation:!0}),void gt(e,o)}if(i=ut.exec(t),!i)return new Error("不正な指し手形式:"+t);const n=Number(i[1]),o=i[2],s=i[3],r=i[4],a=i[5],c=i[6];if(0===n)return new Error("不正な手数:"+t);let l,u;if(e.goto(n-1),"同　"===o){if(!(e.current.move instanceof Ae))return new Error("不明な移動先: "+t);l=e.current.move.to}else{const e=ot[o[0]],t=st[o[1]];l=new be(e,t)}if("打"===a)u=ct[s];else{const e=at[a[1]],t=at[a[2]];u=new be(e,t)}let h=e.position.createMove(u,l);if(!h)return new Error("不正な指し手: "+t);"成"===r&&(h=h.withPromote()),e.append(h,{ignoreValidation:!0}),gt(e,c)}function vt(e){const t=new ze,i=new $e,n=e.split(/\r?\n/),o=new xe;let s=!1;for(const r of n){if(""===r)continue;const e=it(r);if(s&&e.isPosition)return new Error("不正なデータ: "+r);let n;switch(e.type){case et.METADATA:{const i=Xe[e.metadataKey];i?t.setStandardMetadata(i,e.data):t.setCustomMetadata(e.metadataKey,e.data);break}case et.HANDICAP:n=nt(o,e.data);break;case et.BLACK_HAND:n=mt(o.blackHand,e.data);break;case et.WHITE_HAND:n=mt(o.whiteHand,e.data);break;case et.BOARD:n=pt(o.board,e.data);break;case et.BLACK_TURN:o.setColor(j.BLACK);break;case et.WHITE_TURN:o.setColor(j.WHITE);break;case et.MOVE:s||(i.clear(o),s=!0),n=_t(i,e.data);break;case et.COMMENT:i.current.comment+=(0!==i.current.comment.length?"\n":"")+e.data;break;case et.UNKNOWN:console.log("skip",r);break}if(n)return n}return s||i.clear(o),i.goto(0),i.resetAllBranchSelection(),i.metadata=t,i}const ft=["一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八"],wt=["１","２","３","４","５","６","７","８","９"],Et=ft,St={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"成銀",knight:"桂",promKnight:"成桂",lance:"香",promLance:"成香",pawn:"歩",promPawn:"と"},It={king:"玉",rook:"飛",dragon:"龍",bishop:"角",horse:"馬",gold:"金",silver:"銀",promSilver:"全",knight:"桂",promKnight:"圭",lance:"香",promLance:"杏",pawn:"歩",promPawn:"と"},yt={start:"",resign:"投了",interrupt:"中断",draw:"持将棋",repetitionDraw:"千日手",mate:"詰み",timeout:"切れ負け",foulWin:"反則勝ち",foulLose:"反則負け",enteringOfKing:"入玉勝ち",winByDefault:"不戦勝",lossByDefault:"不戦敗"};function Tt(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";for(const o of e.standardMetadataKeys)i+=Qe[o]+"："+e.getStandardMetadata(o)+n;for(const o of e.customMetadataKeys)i+=o+"："+e.getCustomMetadata(o)+n;return i}function bt(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";i+="後手の持駒："+Ot(e.whiteHand)+n,i+="  ９ ８ ７ ６ ５ ４ ３ ２ １"+n,i+="+---------------------------+"+n;for(let o=0;o<9;o++){i+="|";for(let t=0;t<9;t++){const n=be.newByXY(t,o),s=e.board.at(n);s?s.color===j.BLACK?i+=" "+It[s.type]:i+="v"+It[s.type]:i+=" ・"}i+="|"+Et[o]+n}return i+="+---------------------------+"+n,i+="先手の持駒："+Ot(e.blackHand)+n,e.color===j.BLACK?i+="先手番"+n:i+="後手番"+n,i}function Nt(e){let t="";return t+=wt[e.to.file-1],t+=Et[e.to.rank-1],t+=St[e.pieceType],e.promote&&(t+="成"),e.from instanceof be?t+="("+e.from.file+e.from.rank+")":t+="打",t}function Ot(e){let t="";return e.forEach(((e,i)=>{i>=1&&(t+=It[e],i>=2&&(t+=ft[i-1]),t+="　")})),t}function At(e,t){let i="";const n=t.returnCode?t.returnCode:"\n";return i+="# KIF形式棋譜ファイル Generated by Electron Shogi"+n,i+=Tt(e.metadata,t),i+=bt(e.initialPosition,t),i+="手数----指手---------消費時間--"+n,e.forEach((e=>{if(0!==e.number){e.isFirstBranch||(i+=n,i+="変化："+e.number+"手"+n),i+=e.number+" ",e.move instanceof Ae?i+=Nt(e.move):i+=yt[e.move];const t=We(e.elapsedMs),o=Ke(e.totalElapsedMs);i+=` (${t}/${o})`,e.isFirstBranch&&e.hasBranch&&(i+="+"),i+=n}0!==e.comment.length&&(i+="*"+e.comment.replaceAll("\n",n+"*")+n)})),i}const Pt={};function Rt(e){if(Pt[e])return;const t=document.createElement("img");t.src=e,Pt[e]=t}var kt,Ht;(function(e){e["HITOMOJI"]="hitomoji",e["HITOMOJI_GOTHIC"]="hitomojiGothic"})(kt||(kt={})),function(e){e["LIGHT"]="light",e["WARM"]="warm",e["RESIN"]="resin"}(Ht||(Ht={}));const Ct={frame:{width:1471,height:959},board:{x:296.5,y:0,width:878,height:960,squreWidth:94.8,squreHeight:104,leftSquarePadding:12,topSquarePadding:12.2,leftPiecePadding:17.5,topPiecePadding:18.5,highlight:{selected:{"background-color":"#0088ff",opacity:"0.8"},lastMoveTo:{"background-color":"#44cc44",opacity:"0.8"},lastMoveFrom:{"background-color":"#44cc44",opacity:"0.4"}}},piece:{width:88,height:93},hand:{color:"#8b4513",black:{x:1184,y:600},white:{x:0,y:0},width:288,height:360,highlight:{selected:{"background-color":"#ff4800",opacity:"0.7"}}},turn:{black:{x:1184,y:425},white:{x:0,y:492},width:288,height:45,fontSize:32},playerName:{black:{x:1184,y:480},white:{x:0,y:370},width:288,height:45,fontSize:25},clock:{black:{x:1184,y:535},white:{x:0,y:425},width:288,height:55,fontSize:40},control:{left:{x:0,y:547,width:288,height:412,fontSize:26},right:{x:1184,y:0,width:288,height:412,fontSize:26}}},Mt={[kt.HITOMOJI]:{black:{pawn:"./piece/hitomoji/black_pawn.png",lance:"./piece/hitomoji/black_lance.png",knight:"./piece/hitomoji/black_knight.png",silver:"./piece/hitomoji/black_silver.png",gold:"./piece/hitomoji/black_gold.png",bishop:"./piece/hitomoji/black_bishop.png",rook:"./piece/hitomoji/black_rook.png",king:"./piece/hitomoji/black_king.png",king2:"./piece/hitomoji/black_king2.png",promPawn:"./piece/hitomoji/black_prom_pawn.png",promLance:"./piece/hitomoji/black_prom_lance.png",promKnight:"./piece/hitomoji/black_prom_knight.png",promSilver:"./piece/hitomoji/black_prom_silver.png",horse:"./piece/hitomoji/black_horse.png",dragon:"./piece/hitomoji/black_dragon.png"},white:{pawn:"./piece/hitomoji/white_pawn.png",lance:"./piece/hitomoji/white_lance.png",knight:"./piece/hitomoji/white_knight.png",silver:"./piece/hitomoji/white_silver.png",gold:"./piece/hitomoji/white_gold.png",bishop:"./piece/hitomoji/white_bishop.png",rook:"./piece/hitomoji/white_rook.png",king:"./piece/hitomoji/white_king.png",king2:"./piece/hitomoji/white_king2.png",promPawn:"./piece/hitomoji/white_prom_pawn.png",promLance:"./piece/hitomoji/white_prom_lance.png",promKnight:"./piece/hitomoji/white_prom_knight.png",promSilver:"./piece/hitomoji/white_prom_silver.png",horse:"./piece/hitomoji/white_horse.png",dragon:"./piece/hitomoji/white_dragon.png"}},[kt.HITOMOJI_GOTHIC]:{black:{pawn:"./piece/hitomoji_gothic/black_pawn.png",lance:"./piece/hitomoji_gothic/black_lance.png",knight:"./piece/hitomoji_gothic/black_knight.png",silver:"./piece/hitomoji_gothic/black_silver.png",gold:"./piece/hitomoji_gothic/black_gold.png",bishop:"./piece/hitomoji_gothic/black_bishop.png",rook:"./piece/hitomoji_gothic/black_rook.png",king:"./piece/hitomoji_gothic/black_king.png",king2:"./piece/hitomoji_gothic/black_king2.png",promPawn:"./piece/hitomoji_gothic/black_prom_pawn.png",promLance:"./piece/hitomoji_gothic/black_prom_lance.png",promKnight:"./piece/hitomoji_gothic/black_prom_knight.png",promSilver:"./piece/hitomoji_gothic/black_prom_silver.png",horse:"./piece/hitomoji_gothic/black_horse.png",dragon:"./piece/hitomoji_gothic/black_dragon.png"},white:{pawn:"./piece/hitomoji_gothic/white_pawn.png",lance:"./piece/hitomoji_gothic/white_lance.png",knight:"./piece/hitomoji_gothic/white_knight.png",silver:"./piece/hitomoji_gothic/white_silver.png",gold:"./piece/hitomoji_gothic/white_gold.png",bishop:"./piece/hitomoji_gothic/white_bishop.png",rook:"./piece/hitomoji_gothic/white_rook.png",king:"./piece/hitomoji_gothic/white_king.png",king2:"./piece/hitomoji_gothic/white_king2.png",promPawn:"./piece/hitomoji_gothic/white_prom_pawn.png",promLance:"./piece/hitomoji_gothic/white_prom_lance.png",promKnight:"./piece/hitomoji_gothic/white_prom_knight.png",promSilver:"./piece/hitomoji_gothic/white_prom_silver.png",horse:"./piece/hitomoji_gothic/white_horse.png",dragon:"./piece/hitomoji_gothic/white_dragon.png"}}},Dt={[Ht.LIGHT]:"./board/light.png",[Ht.WARM]:"./board/warm.png",[Ht.RESIN]:"./board/resin.png"},Lt={black:{pawn:{row:3,column:0,width:2},lance:{row:2,column:0,width:1},knight:{row:2,column:1,width:1},silver:{row:1,column:0,width:1},gold:{row:1,column:1,width:1},bishop:{row:0,column:0,width:1},rook:{row:0,column:1,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}},white:{pawn:{row:0,column:0,width:2},lance:{row:1,column:1,width:1},knight:{row:1,column:0,width:1},silver:{row:2,column:1,width:1},gold:{row:2,column:0,width:1},bishop:{row:3,column:1,width:1},rook:{row:3,column:0,width:1},king:{row:0,column:0,width:0},promPawn:{row:0,column:0,width:0},promLance:{row:0,column:0,width:0},promKnight:{row:0,column:0,width:0},promSilver:{row:0,column:0,width:0},horse:{row:0,column:0,width:0},dragon:{row:0,column:0,width:0}}};class Bt{constructor(e,t){(0,V.Z)(this,"pieceImages",void 0),(0,V.Z)(this,"boardImage",void 0),this.pieceImages=Mt[e]||Mt[kt.HITOMOJI],this.boardImage=Dt[t]}preload(){Rt(this.boardImage),Object.values(this.pieceImages.black).forEach(Rt),Object.values(this.pieceImages.white).forEach(Rt)}build(e,t,i,n,o,s){let r=e.width/Ct.frame.width;Ct.frame.height*r>e.height&&(r=e.height/Ct.frame.height);const a=()=>({style:{height:Ct.frame.height*r+"px",width:Ct.frame.width*r+"px"}}),c=()=>{const e=this.boardImage,t=Ct.board.x*r,i=Ct.board.y*r,n=Ct.board.width*r,o=Ct.board.height*r,s={left:t+"px",top:i+"px",height:o+"px",width:n+"px"};return{imagePath:e,x:t,y:i,style:s}},l=e=>{const i=[];return t.board.listNonEmptySquares().forEach((n=>{const o=t.board.at(n),a=o.id+n.index,c=s?Y(o.color):o.color,l=o.type==z.KING&&o.color==j.BLACK?"king2":o.type,u=this.pieceImages[c][l],h=e.x+(Ct.board.leftPiecePadding+Ct.board.squreWidth*(s?n.opposite:n).x)*r,d=e.y+(Ct.board.topPiecePadding+Ct.board.squreHeight*(s?n.opposite:n).y)*r,p=Ct.piece.width*r,m=Ct.piece.height*r;i.push({id:a,imagePath:u,style:{left:h+"px",top:d+"px",width:p+"px",height:m+"px"}})})),i},u=e=>{const t=[];return be.all.forEach((o=>{const a=o.index,{file:c}=o,{rank:l}=o,u=e.x+(Ct.board.leftSquarePadding+Ct.board.squreWidth*(s?o.opposite:o).x)*r,h=e.y+(Ct.board.topSquarePadding+Ct.board.squreHeight*(s?o.opposite:o).y)*r,d=Ct.board.squreWidth*r,p=Ct.board.squreHeight*r,m={left:u+"px",top:h+"px",width:d+"px",height:p+"px"};let g=m;i&&o.equals(i.to)&&(g={...g,...Ct.board.highlight.lastMoveTo}),i&&i.from instanceof be&&o.equals(i.from)&&(g={...g,...Ct.board.highlight.lastMoveFrom}),n instanceof be&&n.equals(o)&&(g={...g,...Ct.board.highlight.selected}),t.push({id:a,file:c,rank:l,style:m,backgroundStyle:g})})),t},h=(e,t)=>{const i=s?Y(e):e,o=Ct.hand[i].x*r,a=Ct.hand[i].y*r,c=Ct.hand.width*r,l=Ct.hand.height*r,u={"background-color":Ct.hand.color,left:o+"px",top:a+"px",width:c+"px",height:l+"px"},h=[],d=[];return te.forEach((o=>{const s=t.count(o),a=Lt[i][o],c=Ct.hand.width/2*a.width*r,l=Ct.hand.height/4*r,u=c*a.column,p=l*a.row,m=Ct.piece.width*r,g=Ct.piece.height*r,_=Math.max(c-m*s,0)/(2*s),v=(c-m-2*_)/Math.max(s-1,1);for(let e=s-1;e>=0;e-=1){const t=o+e,n=this.pieceImages[i][o],s=u+_+v*e,r=p;h.push({id:t,imagePath:n,style:{left:s+"px",top:r+"px",width:m+"px",height:g+"px"}})}const f=o,w={left:u+"px",top:p+"px",width:c+"px",height:l+"px"};let E=w;n&&n instanceof he&&n.color===e&&n.type===o&&(E={...E,...Ct.hand.highlight.selected}),d.push({id:f,type:o,style:w,backgroundStyle:E})})),{style:u,pieces:h,pointers:d}},d=(e,t)=>{if(!t)return null;const i=s?Y(t.color):t.color,n=s?t.to.opposite:t.to,o=new he(i,t.pieceType),a=o.promoted(),c=o.unpromoted(),l=this.pieceImages[i][a.type],u=this.pieceImages[i][c.type],h=e.x+(Ct.board.leftSquarePadding+Ct.board.squreWidth*(n.x-.5))*r,d=e.y+(Ct.board.topSquarePadding+Ct.board.squreHeight*n.y)*r,p=2*Ct.board.squreWidth*r,m=Ct.board.squreHeight*r,g={left:h+"px",top:d+"px",width:p+"px",height:m+"px","font-size":m/4+"px"};return{promoteImagePath:l,notPromoteImagePath:u,style:g}},p=()=>{const e=t.color,i=s?Y(e):e,n=2;return{style:{left:Ct.turn[i].x*r-n+"px",top:Ct.turn[i].y*r-n+"px",width:Ct.turn.width*r-n+"px",height:Ct.turn.height*r-n+"px","font-size":Ct.turn.fontSize*r+"px","border-radius":Ct.turn.height*r*.4+"px","border-width":n+"px","border-style":"solid"}}},m=e=>{const t=s?Y(e):e;return{style:{left:Ct.playerName[t].x*r+"px",top:Ct.playerName[t].y*r+"px",width:Ct.playerName.width*r+"px",height:Ct.playerName.height*r+"px","font-size":Ct.playerName.fontSize*r+"px"}}},g=e=>{const t=s?Y(e):e;return{style:{left:Ct.clock[t].x*r+"px",top:Ct.clock[t].y*r+"px",width:Ct.clock.width*r+"px",height:Ct.clock.height*r+"px","font-size":Ct.clock.fontSize*r+"px"}}},_=()=>({left:{style:{left:Ct.control.left.x*r+"px",top:Ct.control.left.y*r+"px",width:Ct.control.left.width*r+"px",height:Ct.control.left.height*r+"px","font-size":Ct.control.left.fontSize*r+"px"}},right:{style:{left:Ct.control.right.x*r+"px",top:Ct.control.right.y*r+"px",width:Ct.control.right.width*r+"px",height:Ct.control.right.height*r+"px","font-size":Ct.control.right.fontSize*r+"px"}}}),v=a(),f=c(),w=l(f),E=u(f),S=h(j.BLACK,t.hand(j.BLACK)),I=h(j.WHITE,t.hand(j.WHITE)),y=d(f,o),T=p(),b=m(j.BLACK),N=m(j.WHITE),O=g(j.BLACK),A=g(j.WHITE),P=_();return{frame:v,board:f,piece:w,square:E,blackHand:S,whiteHand:I,promotion:y,turn:T,blackPlayerName:b,whitePlayerName:N,blackClock:O,whiteClock:A,control:P}}}class Gt{constructor(e,t){(0,V.Z)(this,"width",void 0),(0,V.Z)(this,"height",void 0),this.width=e,this.height=t}add(e){return new Gt(this.width+e.width,this.height+e.height)}reduce(e){return new Gt(this.width-e.width,this.height-e.height)}}var xt=(0,o.aZ)({name:"BoardView",props:{pieceImageType:{type:String,required:!0},boardImageType:{type:String,required:!0},maxSize:{type:Gt,required:!0},position:{type:Object,required:!0},lastMove:{type:Ae,required:!1,default:null},flip:{type:Boolean,required:!1},allowEdit:{type:Boolean,required:!1},allowMove:{type:Boolean,required:!1},blackPlayerName:{type:String,required:!1,default:"先手"},whitePlayerName:{type:String,required:!1,default:"後手"},blackPlayerTimeMs:{type:Number,required:!1,default:void 0},blackPlayerByoyomi:{type:Number,required:!1,default:void 0},whitePlayerTimeMs:{type:Number,required:!1,default:void 0},whitePlayerByoyomi:{type:Number,required:!1,default:void 0}},emits:["move","edit"],setup(e,t){const i=(0,l.qj)({pointer:null,reservedMove:null}),n=()=>{i.pointer=null,i.reservedMove=null};(0,o.YP)([()=>e.position,()=>e.allowEdit,()=>e.allowMove],(()=>{n()}));const s=()=>{n()},r=(o,s,r)=>{const a=i.pointer;if(n(),!(o instanceof be&&a instanceof be&&o.equals(a))&&!(o instanceof he&&a instanceof he&&o.equals(a))){if(a){const n=a,s=o instanceof be?o:o.color;if(e.allowEdit&&e.position.isValidEditing(n,s))return void t.emit("edit",{move:{from:a,to:s}});if(e.allowMove&&o instanceof be){const n=a instanceof be?a:a.type,s=o,r=e.position.createMove(n,s);if(!r)return;const c=e.position.isValidMove(r),l=e.position.isValidMove(r.withPromote());if(c&&l)return void(i.reservedMove=r);if(c)return void t.emit("move",r);if(l)return void t.emit("move",r.withPromote())}}!e.allowMove&&!e.allowEdit||s||(e.allowEdit||r===e.position.color)&&(i.pointer=o)}},a=(t,i,n)=>{t.stopPropagation(),t.preventDefault();const o=new be(i,n),s=e.position.board.at(o),a=!s;r(o,a,s?.color)},c=(t,i,n)=>{t.stopPropagation(),t.preventDefault();const o=0===e.position.hand(i).count(n);r(new he(i,n),o,i)},u=(i,o,s)=>{i.stopPropagation(),i.preventDefault(),n();const r=new be(o,s);e.allowEdit&&e.position.board.at(r)&&t.emit("edit",{rotate:r})},h=o=>{o.stopPropagation(),o.preventDefault();const s=i.reservedMove;n(),s&&e.position.isValidMove(s.withPromote())&&t.emit("move",s.withPromote())},d=o=>{o.stopPropagation(),o.preventDefault();const s=i.reservedMove;n(),s&&e.position.isValidMove(s)&&t.emit("move",s)},p=(0,o.Fl)((()=>{const t=new Bt(e.pieceImageType,e.boardImageType);return t.preload(),t})),m=(0,o.Fl)((()=>p.value.build(e.maxSize.reduce(new Gt(20,20)),e.position,e.lastMove,i.pointer,i.reservedMove,e.flip))),g=(e,t)=>e?Fe(Math.ceil(e/1e3)):void 0!==t?""+t:"0:00:00",_=(e,t)=>{if(!e&&!t)return"normal";const i=(e||0)/1e3+(t||0);return i<=5?"danger":i<=10?"warning":"normal"},v=(0,o.Fl)((()=>g(e.blackPlayerTimeMs,e.blackPlayerByoyomi))),f=(0,o.Fl)((()=>_(e.blackPlayerTimeMs,e.blackPlayerByoyomi))),w=(0,o.Fl)((()=>g(e.whitePlayerTimeMs,e.whitePlayerByoyomi))),E=(0,o.Fl)((()=>_(e.whitePlayerTimeMs,e.whitePlayerByoyomi)));return{clickFrame:s,clickSquare:a,clickHand:c,clickSquareR:u,clickPromote:h,clickNotPromote:d,layout:m,blackPlayerTimeText:v,blackPlayerTimeSeverity:f,whitePlayerTimeText:w,whitePlayerTimeSeverity:E}}}),Kt=i(3744);const Wt=(0,Kt.Z)(xt,[["render",Z],["__scopeId","data-v-46c90ba8"]]);var Ft=Wt;const qt="es://human",Ut="es://usi-engine/";function Zt(e){return e.startsWith(Ut)}function jt(){const e=Date.now(),t=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16);return Ut+`${e}/${t}`}function zt(e){return void 0!==e.value?e.value:void 0!==e.default?"string"===e.type&&"<empty>"===e.default?"":e.default:void 0}function Vt(e){const t=JSON.parse(JSON.stringify(e));return t.uri=jt(),t.name+=" のコピー",t}function Yt(e,t){e.uri=t.uri,e.name=t.name,Object.keys(t.options).forEach((i=>{e.options[i]&&(e.options[i].value=t.options[i].value)}))}class Jt{constructor(e){if((0,V.Z)(this,"engines",void 0),this.engines={},e){const t=JSON.parse(e);t.engines instanceof Object&&(this.engines=t.engines)}}hasEngine(e){return!!this.engines[e]}addEngine(e){this.engines[e.uri]=e}updateEngine(e){return!!this.engines[e.uri]&&(this.engines[e.uri]=e,!0)}removeEngine(e){return!!this.engines[e]&&(delete this.engines[e],!0)}getEngine(e){return this.engines[e]}get engineList(){return Object.values(this.engines).sort(((e,t)=>e.name!==t.name?e.name>t.name?1:-1:e.defaultName!==t.defaultName?e.defaultName>t.defaultName?1:-1:e.uri>t.uri?1:-1))}get json(){return JSON.stringify(this)}get jsonWithIndent(){return JSON.stringify(this,void 0,2)}}var $t,Xt,Qt,ei;function ti(e){return{pieceImage:kt.HITOMOJI,boardImage:Ht.LIGHT,pieceVolume:30,clockVolume:30,clockPitch:500,clockSoundTarget:Qt.ONLY_USER,boardFlipping:!1,tab:Xt.RECORD_INFO,returnCode:e||"\r\n"}}function ii(){return{black:{name:"人",uri:qt},white:{name:"人",uri:qt},timeLimit:{timeSeconds:0,byoyomi:30,increment:0},enableEngineTimeout:!1,humanIsFront:!0}}function ni(e){return 0===e.timeLimit.timeSeconds&&0===e.timeLimit.byoyomi?new Error("持ち時間と秒読みが両方とも0です。"):0!==e.timeLimit.byoyomi&&0!==e.timeLimit.increment?new Error("秒読みとフィッシャールールは併用できません。"):void 0}function oi(){return{}}(function(e){e["NEW_RECORD"]="newRecord",e["OPEN_RECORD"]="openRecord",e["SAVE_RECORD"]="saveRecord",e["SAVE_RECORD_AS"]="saveRecordAs",e["COPY_RECORD"]="copyRecord",e["PASTE_RECORD"]="pasteRecord",e["INSERT_INTERRUPT"]="insertInterrupt",e["INSERT_RESIGN"]="insertResign",e["INSERT_DRAW"]="insertDraw",e["INSERT_REPETITION_DRAW"]="insertRepetitionDraw",e["INSERT_MATE"]="insertMate",e["INSERT_TIMEOUT"]="insertTimeout",e["INSERT_FOUL_WIN"]="insertFoulWin",e["INSERT_FOUL_LOSE"]="insertFoulLose",e["INSERT_ENTERING_OF_KING"]="insertEnteringOfKing",e["INSERT_WIN_BY_DEFAULT"]="insertWinByDefault",e["INSERT_LOSS_BY_DEFAULT"]="insertLossByDefault",e["REMOVE_RECORD_AFTER"]="remvoeRecordAfter",e["START_POSITION_EDITING"]="startPositionEditing",e["END_POSITION_EDITING"]="endPositionEditing",e["CHANGE_TURN"]="changeTurn",e["INIT_POSITION_STANDARD"]="initPositionStandard",e["INIT_POSITION_HANDICAP_LANCE"]="initPositionHandicapLance",e["INIT_POSITION_HANDICAP_RIGHT_LANCE"]="initPositionHandicapRightLance",e["INIT_POSITION_HANDICAP_BISHOP"]="initPositionHandicapBishop",e["INIT_POSITION_HANDICAP_ROOK"]="initPositionHandicapRook",e["INIT_POSITION_HANDICAP_ROOK_LANCE"]="initPositionHandicapRookLance",e["INIT_POSITION_HANDICAP_2PIECES"]="initPositionHandicap2Pieces",e["INIT_POSITION_HANDICAP_4PIECES"]="initPositionHandicap4Pieces",e["INIT_POSITION_HANDICAP_6PIECES"]="initPositionHandicap6Pieces",e["INIT_POSITION_HANDICAP_8PIECES"]="initPositionHandicap8Pieces",e["INIT_POSITION_TSUME_SHOGI"]="initPositionTsumeShogi",e["START_RESEARCH"]="startResearch",e["STOP_RESEARCH"]="stopResearch",e["START_GAME"]="startGame",e["STOP_GAME"]="stopGame",e["RESIGN"]="resign",e["FLIP_BOARD"]="flipBoard",e["APP_SETTING_DIALOG"]="appSetting",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSetting"})($t||($t={})),function(e){e["RECORD_INFO"]="recordInfo",e["COMMENT"]="comment",e["SEARCH"]="search",e["CHART"]="chart",e["INVISIBLE"]="invisible"}(Xt||(Xt={})),function(e){e["ALL"]="all",e["ONLY_USER"]="onlyUser"}(Qt||(Qt={})),function(e){e["APP_SETTING"]="appSetting",e["RESEARCH_SETTING"]="researchSetting",e["GAME_SETTING"]="gameSetting"}(ei||(ei={}));const si={async getRecordPathFromProcArg(){return""},updateMenuState(){},async showOpenRecordDialog(){throw"Web版では利用できない機能です。"},async openRecord(){throw"Web版では利用できない機能です。"},async showSaveRecordDialog(){throw"Web版では利用できない機能です。"},async saveRecord(){throw"Web版では利用できない機能です。"},async showSelectFileDialog(){throw"Web版では利用できない機能です。"},async loadAppSetting(){const e=localStorage.getItem(ei.APP_SETTING);return e?JSON.stringify({...ti(),...JSON.parse(e)}):JSON.stringify(ti())},async saveAppSetting(e){localStorage.setItem(ei.APP_SETTING,e)},async loadResearchSetting(){const e=localStorage.getItem(ei.RESEARCH_SETTING);return e?JSON.stringify({...oi(),...JSON.parse(e)}):JSON.stringify(oi())},async saveResearchSetting(e){localStorage.setItem(ei.RESEARCH_SETTING,e)},async loadGameSetting(){const e=localStorage.getItem(ei.GAME_SETTING);return e?JSON.stringify({...ii(),...JSON.parse(e)}):JSON.stringify(ii())},async saveGameSetting(e){localStorage.setItem(ei.GAME_SETTING,e)},async loadUSIEngineSetting(){return(new Jt).json},async saveUSIEngineSetting(){},async showSelectUSIEngineDialog(){throw"Web版では利用できない機能です。"},async getUSIEngineInfo(){throw"Web版では利用できない機能です。"},async startResearch(){throw"Web版では利用できない機能です。"},async endResearch(){throw"Web版では利用できない機能です。"},async startGame(){},async endGame(){},async updateUSIPosition(){},async stopUSI(){},async sendUSISetOption(){},onSendError(){},onMenuEvent(){},onUSIBestMove(){},onUSIInfo(){}};function ri(){return window}function ai(){return!!ri().electronShogiAPI}function ci(){return ri().electronShogiAPI||si}async function li(){return await ci().getRecordPathFromProcArg()}async function ui(){return await ci().showOpenRecordDialog()}async function hi(e){return await ci().openRecord(e)}async function di(e){return await ci().showSaveRecordDialog(e)}async function pi(e,t){await ci().saveRecord(e,t)}async function mi(){return await ci().showSelectFileDialog()}async function gi(){return JSON.parse(await ci().loadAppSetting())}async function _i(e){await ci().saveAppSetting(JSON.stringify(e))}async function vi(){return JSON.parse(await ci().loadResearchSetting())}async function fi(e){await ci().saveResearchSetting(JSON.stringify(e))}async function wi(){return JSON.parse(await ci().loadGameSetting())}async function Ei(e){await ci().saveGameSetting(JSON.stringify(e))}async function Si(){return new Jt(await ci().loadUSIEngineSetting())}async function Ii(e){await ci().saveUSIEngineSetting(e.jsonWithIndent)}async function yi(){return await ci().showSelectUSIEngineDialog()}async function Ti(e){return JSON.parse(await ci().getUSIEngineInfo(e))}async function bi(e,t){await ci().startResearch(JSON.stringify(e),t)}async function Ni(){await ci().endResearch()}async function Oi(e,t){await ci().startGame(JSON.stringify(e),t)}async function Ai(e,t){await ci().endGame(e,t)}async function Pi(e,t,i,n){await ci().updateUSIPosition(e,JSON.stringify(t),i,n)}async function Ri(e){await ci().stopUSI(e)}async function ki(e,t){await ci().sendUSISetOption(e,t)}function Hi(){const e=on(),t=ci();t.onSendError((t=>{e.pushError(t)})),t.onMenuEvent((t=>{if(!e.isBussy)switch(t){case $t.NEW_RECORD:e.newRecord();break;case $t.OPEN_RECORD:e.openRecord();break;case $t.SAVE_RECORD:e.saveRecord({overwrite:!0});break;case $t.SAVE_RECORD_AS:e.saveRecord();break;case $t.COPY_RECORD:e.copyRecord();break;case $t.PASTE_RECORD:e.showPasteDialog();break;case $t.INSERT_INTERRUPT:e.insertSpecialMove(Ze.INTERRUPT);break;case $t.INSERT_RESIGN:e.insertSpecialMove(Ze.RESIGN);break;case $t.INSERT_DRAW:e.insertSpecialMove(Ze.DRAW);break;case $t.INSERT_REPETITION_DRAW:e.insertSpecialMove(Ze.REPETITION_DRAW);break;case $t.INSERT_MATE:e.insertSpecialMove(Ze.MATE);break;case $t.INSERT_TIMEOUT:e.insertSpecialMove(Ze.TIMEOUT);break;case $t.INSERT_FOUL_WIN:e.insertSpecialMove(Ze.FOUL_WIN);break;case $t.INSERT_FOUL_LOSE:e.insertSpecialMove(Ze.FOUL_LOSE);break;case $t.INSERT_ENTERING_OF_KING:e.insertSpecialMove(Ze.ENTERING_OF_KING);break;case $t.INSERT_WIN_BY_DEFAULT:e.insertSpecialMove(Ze.WIN_BY_DEFAULT);break;case $t.INSERT_LOSS_BY_DEFAULT:e.insertSpecialMove(Ze.LOSS_BY_DEFAULT);break;case $t.REMOVE_RECORD_AFTER:e.removeRecordAfter();break;case $t.START_POSITION_EDITING:e.startPositionEditing();break;case $t.END_POSITION_EDITING:e.endPositionEditing();break;case $t.CHANGE_TURN:e.changeTurn();break;case $t.INIT_POSITION_STANDARD:e.initializePosition(Re.STANDARD);break;case $t.INIT_POSITION_HANDICAP_LANCE:e.initializePosition(Re.HANDICAP_LANCE);break;case $t.INIT_POSITION_HANDICAP_RIGHT_LANCE:e.initializePosition(Re.HANDICAP_RIGHT_LANCE);break;case $t.INIT_POSITION_HANDICAP_BISHOP:e.initializePosition(Re.HANDICAP_BISHOP);break;case $t.INIT_POSITION_HANDICAP_ROOK:e.initializePosition(Re.HANDICAP_ROOK);break;case $t.INIT_POSITION_HANDICAP_ROOK_LANCE:e.initializePosition(Re.HANDICAP_ROOK_LANCE);break;case $t.INIT_POSITION_HANDICAP_2PIECES:e.initializePosition(Re.HANDICAP_2PIECES);break;case $t.INIT_POSITION_HANDICAP_4PIECES:e.initializePosition(Re.HANDICAP_4PIECES);break;case $t.INIT_POSITION_HANDICAP_6PIECES:e.initializePosition(Re.HANDICAP_6PIECES);break;case $t.INIT_POSITION_HANDICAP_8PIECES:e.initializePosition(Re.HANDICAP_8PIECES);break;case $t.INIT_POSITION_TSUME_SHOGI:e.initializePosition(Re.TSUME_SHOGI);break;case $t.START_GAME:e.showGameDialog();break;case $t.STOP_GAME:e.stopGame();break;case $t.RESIGN:e.resignByUser();break;case $t.START_RESEARCH:e.showResearchDialog();break;case $t.STOP_RESEARCH:e.stopResearch();break;case $t.FLIP_BOARD:e.flipBoard();break;case $t.APP_SETTING_DIALOG:e.openAppSettingDialog();break;case $t.USI_ENGINE_SETTING_DIALOG:e.openUsiEngineManagementDialog();break}})),t.onUSIBestMove(((t,i,n,o)=>{e.doMoveByUsiEngine(t,i,n,o)})),t.onUSIInfo(((t,i,n,o,s)=>{e.updateUSIInfo(t,i,n,o,JSON.parse(s))})),(0,o.YP)((()=>[e.mode,e.isBussy]),(([e,i])=>{t.updateMenuState(e,i)})),t.updateMenuState(e.mode,e.isBussy)}var Ci=i(4914),Mi=i.n(Ci);function Di(e){const t=e?.type||"sine",i=e?.frequency||440,n=e?.volume||2,o=new AudioContext,s=o.createOscillator(),r=o.createGain();return s.connect(r),r.connect(o.destination),s.type=t,s.frequency.value=i,r.gain.value=.005*n,s.onended=()=>{r.disconnect(o.destination),s.disconnect(r)},s.start(o.currentTime),e?.time&&s.stop(o.currentTime+e.time),{stop:()=>{e?.time||s.stop()}}}function Li(e){Di({type:"sine",frequency:e.frequency,time:.1,volume:e.volume})}function Bi(e){return Di({type:"sine",frequency:e.frequency,volume:e.volume})}let Gi;function xi(e){const t=Date.now();if(Gi&&t<Gi+200)return;const i=new Audio("sound/piece.mp3");i.volume=.01*e,i.play(),Gi=t}var Ki;function Wi(e){switch(e){case Ki.BLACK_PLAYER:return"先手";case Ki.WHITE_PLAYER:return"後手";case Ki.RESEARCHER:return"検討"}}(function(e){e["BLACK_PLAYER"]="blackPlayer",e["WHITE_PLAYER"]="whitePlayer",e["RESEARCHER"]="researcher"})(Ki||(Ki={}));const Fi=2e3,qi=-Fi;class Ui{constructor(e){if((0,V.Z)(this,"evaluation",void 0),e){const t=JSON.parse(e);this.evaluation=t.evaluation}}updateScore(e,t,i){switch(this.evaluation||(this.evaluation={}),t){case Ki.BLACK_PLAYER:this.evaluation[Ki.BLACK_PLAYER]=i;break;case Ki.WHITE_PLAYER:this.evaluation[Ki.WHITE_PLAYER]=-i;break;case Ki.RESEARCHER:this.evaluation[Ki.RESEARCHER]=e===j.BLACK?i:-i;break}}updateUSIInfo(e,t,i){i.scoreCP?this.updateScore(e,t,Math.min(Math.max(i.scoreCP,qi),Fi)):i.scoreMate&&this.updateScore(e,t,i.scoreMate>=0?Fi:qi)}stringify(){return JSON.stringify(this)}}class Zi{constructor(){(0,V.Z)(this,"black",void 0),(0,V.Z)(this,"white",void 0),(0,V.Z)(this,"timerHandle",void 0),(0,V.Z)(this,"timerStart",void 0),(0,V.Z)(this,"lastTimeMs",void 0),(0,V.Z)(this,"_elapsedMs",void 0),(0,V.Z)(this,"_setting",void 0),this.black={timeMs:0,byoyomi:0},this.white={timeMs:0,byoyomi:0},this.timerHandle=0,this.timerStart=new Date,this.lastTimeMs=0,this._elapsedMs=0,this._setting=ii()}get blackTimeMs(){return this.black.timeMs}get blackByoyomi(){return this.black.byoyomi}get whiteTimeMs(){return this.white.timeMs}get whiteByoyomi(){return this.white.byoyomi}get elapsedMs(){return this._elapsedMs}get setting(){return this._setting}setup(e){this.black.timeMs=1e3*e.timeLimit.timeSeconds,this.black.byoyomi=e.timeLimit.byoyomi,this.white.timeMs=1e3*e.timeLimit.timeSeconds,this.white.byoyomi=e.timeLimit.byoyomi,this._setting=e}getPlayerState(e){switch(e){case j.BLACK:return this.black;case j.WHITE:return this.white}}startTimer(e,t){const i=this.getPlayerState(e);this.timerStart=new Date,this.lastTimeMs=i.timeMs,i.byoyomi=this.setting.timeLimit.byoyomi,this.timerHandle=window.setInterval((()=>{const e=i.timeMs,n=i.byoyomi,o=new Date;this._elapsedMs=o.getTime()-this.timerStart.getTime();const s=this.lastTimeMs-this._elapsedMs;if(s>=0?i.timeMs=s:(i.timeMs=0,i.byoyomi=Math.max(Math.ceil(this.setting.timeLimit.byoyomi+s/1e3),0)),0===i.timeMs&&0===i.byoyomi)return void t.timeout();const r=Math.ceil(e/1e3),a=Math.ceil(i.timeMs/1e3),c=i.byoyomi;0===a&&(e>0||c!==n)?c<=5?t.onBeepUnlimited():(c<=10||c%10===0)&&t.onBeepShort():this.setting.timeLimit.byoyomi||a===r||(a<=5?t.onBeepUnlimited():(a<=10||20===a||30===a||60===a)&&t.onBeepShort())}),100)}incrementTime(e){this.getPlayerState(e).timeMs+=1e3*this.setting.timeLimit.increment}clearTimer(){this.timerHandle&&(window.clearInterval(this.timerHandle),this.timerHandle=0),this._elapsedMs=0}}function ji(e){let t=zi(e);const i=e.getStandardMetadata(Ue.TITLE)||e.getStandardMetadata(Ue.TOURNAMENT)||e.getStandardMetadata(Ue.OPUS_NAME)||e.getStandardMetadata(Ue.OPUS_NO)||e.getStandardMetadata(Ue.PLACE)||e.getStandardMetadata(Ue.POSTED_ON)||e.getStandardMetadata(Ue.AUTHOR);i&&(t+="_"+i);const n=e.getStandardMetadata(Ue.BLACK_NAME)||e.getStandardMetadata(Ue.BLACK_SHORT_NAME);n&&(t+="_"+n);const o=e.getStandardMetadata(Ue.WHITE_NAME)||e.getStandardMetadata(Ue.WHITE_SHORT_NAME);return o&&(t+="_"+o),t+".kif"}function zi(e){const t=e.getStandardMetadata(Ue.DATE);return t?t.trim().replaceAll(" ","_").replaceAll("/","").replaceAll(":",""):(new Date).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}).replaceAll("/","")}class Vi{constructor(){(0,V.Z)(this,"count",void 0),this.count=0}get isBussy(){return 0!==this.count}retain(){this.count+=1}release(){this.count-=1}}function Yi(e,t){const i=e.clone();let n,o="";for(const s of t){const e=i.createMoveBySFEN(s);if(!e)break;i.doMove(e,{ignoreValidation:!0}),o+=e.getDisplayText(n),n=e}return o}class Ji{constructor(e){(0,V.Z)(this,"name",void 0),(0,V.Z)(this,"nodes",void 0),(0,V.Z)(this,"nps",void 0),(0,V.Z)(this,"iterates",void 0),(0,V.Z)(this,"hashfull",void 0),(0,V.Z)(this,"currentMove",void 0),(0,V.Z)(this,"currentMoveText",void 0),this.name=e,this.iterates=[]}update(e,t){const i={};if(void 0!==t.depth&&(i.depth=t.depth),void 0!==t.seldepth&&(i.selectiveDepth=t.seldepth),void 0!==t.timeMs&&(i.timeMs=t.timeMs),void 0!==t.nodes&&(this.nodes=t.nodes),t.pv&&(i.pv=t.pv,i.text=Yi(e,t.pv)),void 0!==t.multipv&&(i.multiPV=t.multipv),void 0!==t.scoreCP&&(i.score=t.scoreCP),void 0!==t.scoreMate&&(i.scoreMate=t.scoreMate),void 0!==t.lowerbound&&(i.lowerBound=t.lowerbound),void 0!==t.upperbound&&(i.upperBound=t.upperbound),void 0!==t.currmove){this.currentMove=t.currmove;const i=e.createMoveBySFEN(t.currmove);i&&(this.currentMoveText=i.getDisplayText())}void 0!==t.hashfullPerMill&&(this.hashfull=t.hashfullPerMill/1e3),void 0!==t.nps&&(this.nps=t.nps),t.string&&(i.text=t.string),0!==Object.keys(i).length&&this.iterates.unshift(i)}}class $i{constructor(){(0,V.Z)(this,"_sessionID",void 0),(0,V.Z)(this,"_blackPlayer",void 0),(0,V.Z)(this,"_blackPosition",void 0),(0,V.Z)(this,"_whitePlayer",void 0),(0,V.Z)(this,"_whitePosition",void 0),(0,V.Z)(this,"_researcher",void 0),(0,V.Z)(this,"_researchPosition",void 0)}get blackPlayer(){return this._blackPlayer}get whitePlayer(){return this._whitePlayer}get researcher(){return this._researcher}update(e,t,i,n,o){switch(this._sessionID!=e&&(this._blackPlayer=void 0,this._whitePlayer=void 0,this._researcher=void 0,this._sessionID=e),i){case Ki.BLACK_PLAYER:this._blackPlayer&&this._blackPosition===t.sfen||(this._blackPlayer=new Ji(n),this._blackPosition=t.sfen),this._blackPlayer.update(t,o);break;case Ki.WHITE_PLAYER:this._whitePlayer&&this._whitePosition===t.sfen||(this._whitePlayer=new Ji(n),this._whitePosition=t.sfen),this._whitePlayer.update(t,o);break;case Ki.RESEARCHER:this._researcher&&this._researchPosition===t.sfen||(this._researcher=new Ji(n),this._researchPosition=t.sfen),this._researcher.update(t,o);break}}}var Xi;(function(e){e["NORMAL"]="normal",e["PASTE_DIALOG"]="pasteDialog",e["POSITION_EDITING"]="positionEditing",e["GAME"]="game",e["GAME_DIALOG"]="gameDialog",e["RESEARCH"]="research",e["RESEARCH_DIALOG"]="researchDialog",e["USI_ENGINE_SETTING_DIALOG"]="usiEngineSettingDialog",e["APP_SETTING_DIALOG"]="appSettingDialog",e["TEMPORARY"]="temporary"})(Xi||(Xi={}));class Qi{constructor(){(0,V.Z)(this,"_queue",void 0),this._queue=[]}get message(){return this._queue[0]}get hasMessage(){return 0!==this._queue.length}enqueue(e){this._queue.push(e)}dequeue(){this._queue.shift()}}class en{constructor(){(0,V.Z)(this,"_queue",void 0),this._queue=[]}get errors(){return this._queue}get hasError(){return 0!==this._queue.length}push(e){e instanceof Error?this._queue.push(e):this._queue.push(new Error(""+e))}clear(){this._queue=[]}}class tn{constructor(){(0,V.Z)(this,"_bussy",void 0),(0,V.Z)(this,"_message",void 0),(0,V.Z)(this,"_error",void 0),(0,V.Z)(this,"_appSetting",void 0),(0,V.Z)(this,"_mode",void 0),(0,V.Z)(this,"lastMode",void 0),(0,V.Z)(this,"_confirmation",void 0),(0,V.Z)(this,"_usi",void 0),(0,V.Z)(this,"usiSessionID",void 0),(0,V.Z)(this,"_game",void 0),(0,V.Z)(this,"unlimitedBeepHandler",void 0),(0,V.Z)(this,"_recordFilePath",void 0),(0,V.Z)(this,"_record",void 0),this._bussy=new Vi,this._message=new Qi,this._error=new en,this._appSetting=ti(),this._mode=Xi.NORMAL,this._usi=new $i,this.usiSessionID=0,this._game=new Zi,this._record=new $e}get isBussy(){return this._bussy.isBussy}retainBussyState(){return this._bussy.retain()}releaseBussyState(){return this._bussy.release()}get message(){return this._message.message}get hasMessage(){return this._message.hasMessage}enqueueMessage(e){this._message.enqueue(e)}dequeueMessage(){this._message.dequeue()}get errors(){return this._error.errors}get hasError(){return this._error.hasError}pushError(e){this._error.push(e)}clearErrors(){this._error.clear()}get appSetting(){return this._appSetting}async updateAppSetting(e){await _i({...this.appSetting,...e}),this._appSetting={...this.appSetting,...e}}flipBoard(){this._appSetting.boardFlipping=!this.appSetting.boardFlipping,_i(this.appSetting)}get mode(){return this._mode}get confirmation(){return this._confirmation?.message}showConfirmation(e){this._confirmation=e,this.lastMode=this.mode,this._mode=Xi.TEMPORARY}confirmationOk(){const e=this._confirmation?.onOk;this._confirmation=void 0,this.lastMode&&(this._mode=this.lastMode,this.lastMode=void 0),e&&e()}confirmationCancel(){const e=this._confirmation?.onCancel;this._confirmation=void 0,this.lastMode&&(this._mode=this.lastMode,this.lastMode=void 0),e&&e()}showPasteDialog(){this.mode===Xi.NORMAL&&(this._mode=Xi.PASTE_DIALOG)}closePasteDialog(){this.mode===Xi.PASTE_DIALOG&&(this._mode=Xi.NORMAL)}showGameDialog(){this.mode===Xi.NORMAL&&(this._mode=Xi.GAME_DIALOG)}showResearchDialog(){this.mode===Xi.NORMAL&&(this._mode=Xi.RESEARCH_DIALOG)}openAppSettingDialog(){this.mode===Xi.NORMAL&&(this._mode=Xi.APP_SETTING_DIALOG)}openUsiEngineManagementDialog(){this.mode===Xi.NORMAL&&(this._mode=Xi.USI_ENGINE_SETTING_DIALOG)}closeDialog(){this.mode!==Xi.USI_ENGINE_SETTING_DIALOG&&this.mode!==Xi.APP_SETTING_DIALOG&&this.mode!==Xi.GAME_DIALOG&&this.mode!==Xi.RESEARCH_DIALOG||(this._mode=Xi.NORMAL)}get usiBlackPlayerMonitor(){return this._usi.blackPlayer}get usiWhitePlayerMonitor(){return this._usi.whitePlayer}get usiResearcherMonitor(){return this._usi.researcher}updateUSIInfo(e,t,i,n,o){if(this.usiSessionID!==e||this.record.usi!=t)return;this._usi.update(e,this.record.position,i,n,o);const s=new Ui(this.record.current.customData);s.updateUSIInfo(this.record.position.color,i,o),this.record.current.customData=s.stringify()}issueUSISessionID(){this.usiSessionID+=1}get gameSetting(){return this._game.setting}get blackTimeMs(){return this._game.blackTimeMs}get blackByoyomi(){return this._game.blackByoyomi}get whiteTimeMs(){return this._game.whiteTimeMs}get whiteByoyomi(){return this._game.whiteByoyomi}get elapsedMs(){return this._game.elapsedMs}async startGame(e){if(this.mode!==Xi.GAME_DIALOG)return!1;this.retainBussyState();try{if(await Ei(e),e.startPosition){const t=new xe;t.reset(e.startPosition),this.record.clear(t),this.clearRecordFilePath()}if(this.issueUSISessionID(),await Oi(e,this.usiSessionID),this._game.setup(e),this._mode=Xi.GAME,this.record.metadata.setStandardMetadata(Ue.BLACK_NAME,e.black.name),this.record.metadata.setStandardMetadata(Ue.WHITE_NAME,e.white.name),e.humanIsFront){let t=this.appSetting.boardFlipping;e.black.uri===qt&&e.white.uri!==qt?t=!1:e.black.uri!==qt&&e.white.uri===qt&&(t=!0),t!==this.appSetting.boardFlipping&&this.flipBoard()}return!0}catch(t){return this.pushError("対局の初期化中にエラーが出ました: "+t),!1}finally{this.releaseBussyState()}}async stopGame(e){if(this.mode!==Xi.GAME)return!1;e&&this.enqueueMessage(`対局終了（${Ye(e)})`),this.retainBussyState();try{return await Ai(this.record.usi,e),this.record.append(e||Ze.INTERRUPT),this.record.current.setElapsedMs(this.elapsedMs),this._mode=Xi.NORMAL,!0}catch(t){return this.pushError("対局の終了中にエラーが出ました: "+t),!1}finally{this.releaseBussyState()}}resetGameTimer(){const e=this.record.position.color;this._game.startTimer(e,{timeout:()=>{this.isMovableByUser||this._game.setting.enableEngineTimeout?this.stopGame(Ze.TIMEOUT):Ri(e)},onBeepShort:()=>{this.beepShort()},onBeepUnlimited:()=>{this.beepUnlimited()}})}async resignByUser(){return this.mode===Xi.GAME&&(!!this.isMovableByUser&&this.stopGame(Ze.RESIGN))}doMoveByUser(e){return!!this.isMovableByUser&&(this.mode===Xi.GAME&&this.incrementTime(),this.doMove(e),!0)}doMoveByUsiEngine(e,t,i,n){if(this.mode!==Xi.GAME)return!1;if(this.usiSessionID!==e)return!1;if(this.record.usi!==t)return!1;if(i!==this.record.position.color)return this.pushError("手番ではないエンジンから指し手を受信しました:"+n),this.stopGame(Ze.FOUL_LOSE),!1;if("resign"===n)return this.stopGame(Ze.RESIGN),!0;if("win"===n)return this.stopGame(Ze.ENTERING_OF_KING),!0;const o=this.record.position.createMoveBySFEN(n);return o&&this.record.position.isValidMove(o)?(this.incrementTime(),this.doMove(o),!0):(this.pushError("エンジンから不明な指し手を受信しました:"+n),this.stopGame(Ze.FOUL_LOSE),!1)}doMove(e){if(this.record.append(e,{ignoreValidation:!0}),this.record.current.setElapsedMs(this.elapsedMs),xi(this.appSetting.pieceVolume),this.mode!==Xi.GAME)return;const t=this.record.perpetualCheck;t?t===this.record.position.color?this.stopGame(Ze.FOUL_LOSE):this.stopGame(Ze.FOUL_WIN):this.record.repetition&&this.stopGame(Ze.REPETITION_DRAW)}incrementTime(){this._game.incrementTime(this.record.position.color)}clearGameTimer(){this._game.clearTimer(),this.stopBeep()}beepUnlimited(){(this.appSetting.clockSoundTarget!==Qt.ONLY_USER||this.isMovableByUser)&&(this.unlimitedBeepHandler||(this.unlimitedBeepHandler=Bi({frequency:this.appSetting.clockPitch,volume:this.appSetting.clockVolume})))}beepShort(){(this.appSetting.clockSoundTarget!==Qt.ONLY_USER||this.isMovableByUser)&&(this.unlimitedBeepHandler||Li({frequency:this.appSetting.clockPitch,volume:this.appSetting.clockVolume}))}async startResearch(e){if(this.mode!==Xi.RESEARCH_DIALOG)return!1;this.retainBussyState();try{return await fi(e),this.issueUSISessionID(),await bi(e,this.usiSessionID),this._mode=Xi.RESEARCH,!0}catch(t){return this.pushError("検討の初期化中にエラーが出ました: "+t),!1}finally{this.releaseBussyState()}}async stopResearch(){if(this.mode!==Xi.RESEARCH)return!1;this.retainBussyState();try{return await Ni(),this._mode=Xi.NORMAL,!0}catch(e){return this.pushError("検討の終了中にエラーが出ました: "+e),!1}finally{this.releaseBussyState()}}get recordFilePath(){return this._recordFilePath}updateRecordFilePath(e){this._recordFilePath=e}clearRecordFilePath(){this._recordFilePath=void 0}stopBeep(){this.unlimitedBeepHandler&&(this.unlimitedBeepHandler.stop(),this.unlimitedBeepHandler=void 0)}get record(){return this._record}newRecord(){this.mode==Xi.NORMAL&&(this.record.clear(new xe),this.clearRecordFilePath())}updateRecordComment(e){this.record.current.comment=e}updateStandardRecordMetadata(e){this.record.metadata.setStandardMetadata(e.key,e.value)}insertSpecialMove(e){this.mode!==Xi.NORMAL&&this.mode!==Xi.RESEARCH||this.record.append(e)}startPositionEditing(){this.mode===Xi.NORMAL&&this.showConfirmation({message:"現在の棋譜は削除されます。よろしいですか？",onOk:()=>{this._mode=Xi.POSITION_EDITING,this.record.clear(this.record.position),this.clearRecordFilePath()}})}endPositionEditing(){this.mode===Xi.POSITION_EDITING&&(this._mode=Xi.NORMAL)}initializePosition(e){this.mode==Xi.POSITION_EDITING&&this.showConfirmation({message:"現在の局面は破棄されます。よろしいですか？",onOk:()=>{const t=new xe;t.reset(e),this.record.clear(t),this.clearRecordFilePath()}})}changeTurn(){if(this.mode!=Xi.POSITION_EDITING)return;const e=this.record.position.clone();e.setColor(Y(e.color)),this.record.clear(e),this.clearRecordFilePath()}editPosition(e){if(this.mode===Xi.POSITION_EDITING){const t=this.record.position.clone();t.edit(e),this.record.clear(t),this.clearRecordFilePath()}}changeMoveNumber(e){this.mode!==Xi.NORMAL&&this.mode!==Xi.RESEARCH||this.record.goto(e)}changeBranch(e){this.mode!==Xi.NORMAL&&this.mode!==Xi.RESEARCH||this.record.current.branchIndex!==e&&this.record.switchBranchByIndex(e)}removeRecordAfter(){if(this.mode!==Xi.NORMAL&&this.mode!==Xi.RESEARCH)return;const e=this.record.current.next;e&&e.move instanceof Ae?this.showConfirmation({message:`${this.record.current.number}手目以降を削除します。よろしいですか？`,onOk:()=>{this.record.removeAfter()}}):this.record.removeAfter()}copyRecord(){const e=At(this.record,{returnCode:this.appSetting.returnCode});navigator.clipboard.writeText(e)}pasteRecord(e){if(this.mode!==Xi.NORMAL)return;const t=vt(e);t instanceof $e?(this.clearRecordFilePath(),this._record=t):this.pushError(t)}async openRecord(e){if(this.mode!==Xi.NORMAL)return!1;this.retainBussyState();try{if(!e&&(e=await ui(),!e))return!1;const t=await hi(e);if(e.match(/\.kif$/)||e.match(/\.kifu$/)){const i=e.match(/\.kif$/)?Mi().decode(t,"Shift_JIS"):t.toString(),n=vt(i);return n instanceof $e?(this.updateRecordFilePath(e),this._record=n):this.pushError(n),!0}return this.pushError("不明なファイル形式: "+e),!1}catch(t){return this.pushError("棋譜の読み込み中にエラーが出ました: "+t),!1}finally{this.releaseBussyState()}}async saveRecord(e){if(this.mode!==Xi.NORMAL)return!1;this.retainBussyState();try{let t=this.recordFilePath;if(!e?.overwrite||!t){const e=ji(this.record.metadata);if(t=await di(e),!t)return!1}if(t.match(/\.kif$/)||t.match(/\.kifu$/)){const e=At(this.record,{returnCode:this.appSetting.returnCode}),i=t.match(/\.kif$/)?Mi().encode(e,"Shift_JIS"):Buffer.from(e);return await pi(t,i),this.updateRecordFilePath(t),!0}return this.pushError("不明なファイル形式: "+t),!1}catch(t){return this.pushError("棋譜の保存中にエラーが出ました: "+t),!1}finally{this.releaseBussyState()}}get isMovableByUser(){switch(this.mode){case Xi.NORMAL:case Xi.RESEARCH:return!0;case Xi.GAME:return(this.record.position.color===j.BLACK?this.gameSetting.black.uri:this.gameSetting.white.uri)===qt}return!1}}const nn=(0,l.qj)(new tn);function on(){return nn}(0,o.YP)([()=>nn.mode,()=>nn.record.position],(()=>{nn.clearGameTimer(),nn.mode===Xi.GAME&&nn.resetGameTimer(),nn.mode!==Xi.GAME&&nn.mode!==Xi.RESEARCH||Pi(nn.record.usi,nn.gameSetting,nn.blackTimeMs,nn.whiteTimeMs)}),{deep:!0});const sn=["src"];function rn(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("img",{class:"icon",src:e.source},null,8,sn)}var an;(function(e){e["BUSSY"]="bussy",e["ERROR"]="error",e["INFO"]="info",e["GAME"]="game",e["STOP"]="stop",e["RESIGN"]="resign",e["RESEARCH"]="research",e["END"]="end",e["EDIT"]="edit",e["CHECK"]="check",e["SWAP"]="swap",e["SWAP_H"]="swap_h",e["SETTINGS"]="settings",e["ENGINE_SETTINGS"]="engineSettings",e["FLIP"]="flip",e["PASTE"]="paste",e["COPY"]="copy",e["DELETE"]="delete",e["COMMENT"]="comment",e["BRAIN"]="brain",e["CHART"]="chart",e["ARROW_DROP"]="arrowDrop",e["FIRST"]="first",e["BACK"]="back",e["NEXT"]="next",e["LAST"]="last",e["QUESTION"]="question"})(an||(an={}));const cn={[an.BUSSY]:"icon/hourglass_empty_white_24dp.svg",[an.ERROR]:"icon/error_outline_white_24dp.svg",[an.INFO]:"icon/info_white_24dp.svg",[an.GAME]:"icon/sports_esports_white_24dp.svg",[an.STOP]:"icon/block_white_24dp.svg",[an.RESIGN]:"icon/flag_white_24dp.svg",[an.RESEARCH]:"icon/science_white_24dp.svg",[an.END]:"icon/do_disturb_on_white_24dp.svg",[an.EDIT]:"icon/app_registration_white_24dp.svg",[an.CHECK]:"icon/check_circle_white_24dp.svg",[an.SWAP]:"icon/swap_vert_white_24dp.svg",[an.SWAP_H]:"icon/swap_horiz_white_24dp.svg",[an.SETTINGS]:"icon/settings_white_24dp.svg",[an.ENGINE_SETTINGS]:"icon/settings_input_component_white_24dp.svg",[an.FLIP]:"icon/flip_camera_android_white_24dp.svg",[an.PASTE]:"icon/content_paste_white_24dp.svg",[an.COPY]:"icon/content_copy_white_24dp.svg",[an.DELETE]:"icon/backspace_white_24dp.svg",[an.COMMENT]:"icon/edit_note_white_24dp.svg",[an.BRAIN]:"icon/psychology_white_24dp.svg",[an.CHART]:"icon/show_chart_white_24dp.svg",[an.ARROW_DROP]:"icon/arrow_drop_down_white_24dp.svg",[an.FIRST]:"icon/first_page_white_24dp.svg",[an.BACK]:"icon/chevron_left_white_24dp.svg",[an.NEXT]:"icon/chevron_right_white_24dp.svg",[an.LAST]:"icon/last_page_white_24dp.svg",[an.QUESTION]:"icon/help_white_24dp.svg"};Object.values(cn).forEach((e=>{Rt(e)}));var ln=(0,o.aZ)({name:"ButtonIcon",props:{icon:{type:String,required:!0}},setup(e){return{source:cn[e.icon]}}});const un=(0,Kt.Z)(ln,[["render",rn]]);var hn=un,dn=(0,o.aZ)({name:"BoardPane",components:{BoardView:Ft,ButtonIcon:hn},props:{maxSize:{type:Gt,required:!0}},setup(){const e=on(),t=t=>{e.doMoveByUser(t)},i=t=>{e.editPosition(t)},n=()=>{e.showGameDialog()},s=()=>{e.stopGame()},r=()=>{e.resignByUser()},a=()=>{e.showResearchDialog()},c=()=>{e.stopResearch()},l=()=>{e.startPositionEditing()},u=()=>{e.endPositionEditing()},h=()=>{e.initializePosition(Re.STANDARD)},d=()=>{e.initializePosition(Re.TSUME_SHOGI)},p=()=>{e.changeTurn()},m=()=>{e.openAppSettingDialog()},g=()=>{e.openUsiEngineManagementDialog()},_=()=>{on().flipBoard()},v=()=>{e.showPasteDialog()},f=()=>{e.copyRecord()},w=()=>{e.removeRecordAfter()},E=(0,o.Fl)((()=>e.mode===Xi.POSITION_EDITING)),S=(0,o.Fl)((()=>e.isMovableByUser)),I=(0,o.Fl)((()=>e.record.position)),y=(0,o.Fl)((()=>{const t=e.record.current.move;return t instanceof Ae?t:null})),T=(0,o.Fl)((()=>e.appSetting.pieceImage)),b=(0,o.Fl)((()=>e.appSetting.boardImage)),N=(0,o.Fl)((()=>e.appSetting.boardFlipping)),O=(0,o.Fl)((()=>e.record.metadata.getStandardMetadata(Ue.BLACK_NAME))),A=(0,o.Fl)((()=>e.record.metadata.getStandardMetadata(Ue.WHITE_NAME))),P=(0,o.Fl)((()=>e.mode===Xi.GAME?e.blackTimeMs:void 0)),R=(0,o.Fl)((()=>e.mode===Xi.GAME?e.blackByoyomi:void 0)),k=(0,o.Fl)((()=>e.mode===Xi.GAME?e.whiteTimeMs:void 0)),H=(0,o.Fl)((()=>e.mode===Xi.GAME?e.whiteByoyomi:void 0)),C=(0,o.Fl)((()=>({game:e.mode===Xi.NORMAL,stop:e.mode===Xi.GAME,resign:e.mode===Xi.GAME&&e.isMovableByUser,research:e.mode===Xi.NORMAL,endResearch:e.mode===Xi.RESEARCH,startEditPosition:e.mode===Xi.NORMAL,endEditPosition:e.mode===Xi.POSITION_EDITING,initPosition:e.mode===Xi.POSITION_EDITING,removeAfter:e.mode===Xi.NORMAL||e.mode===Xi.RESEARCH,paste:e.mode===Xi.NORMAL,appSettings:e.mode===Xi.NORMAL,engineSettings:e.mode===Xi.NORMAL})));return{pieceImageType:T,boardImageType:b,position:I,lastMove:y,flip:N,blackPlayerName:O,whitePlayerName:A,blackPlayerTimeMs:P,blackPlayerByoyomi:R,whitePlayerTimeMs:k,whitePlayerByoyomi:H,controlStates:C,onMove:t,onEdit:i,onGame:n,onStop:s,onResign:r,onResearch:a,onEndResearch:c,onStartEditPosition:l,onEndEditPosition:u,onInitPositionStandard:h,onInitPositionTsumeShogi:d,onChangeTurn:p,onOpenAppSettings:m,onOpenEngineSettings:g,onFlip:_,onPaste:v,onCopy:f,onRemoveAfter:w,allowEdit:E,allowMove:S}}});const pn=(0,Kt.Z)(dn,[["render",R],["__scopeId","data-v-cd0f493c"]]);var mn=pn;function gn(e,t,i,n,s,r){const a=(0,o.up)("RecordView");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(a,{class:"record",record:e.record,operational:e.isRecordOperational,onGoBegin:e.goBegin,onGoBack:e.goBack,onGoForward:e.goForward,onGoEnd:e.goEnd,onSelectMove:e.selectMove,onSelectBranch:e.selectBranch},null,8,["record","operational","onGoBegin","onGoBack","onGoForward","onGoEnd","onSelectMove","onSelectBranch"])])}const _n={class:"frame"},vn={class:"controller"},fn=["disabled"],wn=["disabled"],En=["disabled"],Sn=["disabled"],In=["disabled"],yn=["selected","value"],Tn=["disabled"],bn=["selected","value"];function Nn(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",_n,[(0,o._)("div",vn,[(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[0]||(t[0]=t=>e.goBegin())},[(0,o.Wm)(a,{class:"icon",icon:"first"})],8,fn),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[1]||(t[1]=t=>e.goBack())},[(0,o.Wm)(a,{class:"icon",icon:"back"})],8,wn),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[2]||(t[2]=t=>e.goForward())},[(0,o.Wm)(a,{class:"icon",icon:"next"})],8,En),(0,o._)("button",{class:"control-button",disabled:!e.operational,onClick:t[3]||(t[3]=t=>e.goEnd())},[(0,o.Wm)(a,{class:"icon",icon:"last"})],8,Sn)]),(0,o._)("select",{ref:"moveList",class:"move-list",size:"2",disabled:!e.operational,onChange:t[4]||(t[4]=t=>e.changeNumber())},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.moves,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.number,selected:e.selected,value:e.number},(0,k.zw)(0!==e.number?e.number+" ":"")+" "+(0,k.zw)(e.text)+" "+(0,k.zw)(e.hasBranch?" 分岐":""),9,yn)))),128))],40,In),(0,o._)("select",{ref:"branchList",class:"branch-list",size:"2",disabled:!e.operational,onChange:t[5]||(t[5]=t=>e.changeBranch())},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.branches,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.index,selected:e.selected,value:e.index},(0,k.zw)(e.text),9,bn)))),128))],40,Tn)])])}var On=(0,o.aZ)({name:"RecordView",components:{ButtonIcon:hn},props:{record:{type:$e,required:!0},operational:{type:Boolean,required:!1}},emits:["goBegin","goBack","goForward","goEnd","selectMove","selectBranch"],setup(e,t){const i=(0,l.iH)(null),n=(0,l.iH)(null),s=()=>{t.emit("goBegin")},r=()=>{t.emit("goBack")},a=()=>{t.emit("goForward")},c=()=>{t.emit("goEnd")},u=()=>{t.emit("selectMove",Number(i.value.value))},h=()=>{t.emit("selectBranch",Number(n.value.value))},d=(0,o.Fl)((()=>0===e.record.current.number)),p=(0,o.Fl)((()=>{const t=[];return e.record.moves.forEach((i=>{t.push({number:i.number,text:i.displayText,hasBranch:i.hasBranch,selected:i===e.record.current})})),t})),m=(0,o.Fl)((()=>{if(!e.record.branchBegin.branch)return null;const t=[];let i;for(i=e.record.branchBegin;i&&i.move;i=i.branch)t.push({index:t.length,text:i.displayMoveText,selected:i.activeBranch});return t}));return{beginPosSelected:d,moves:p,branches:m,moveList:i,branchList:n,goBegin:s,goBack:r,goForward:a,goEnd:c,changeNumber:u,changeBranch:h}}});const An=(0,Kt.Z)(On,[["render",Nn],["__scopeId","data-v-251a274f"]]);var Pn=An;const Rn=200;var kn=(0,o.aZ)({name:"RecordPane",components:{RecordView:Pn},setup(){const e=on(),t=t=>{e.changeMoveNumber(t)},i=()=>{t(0)},n=()=>{t(e.record.current.number-1)},s=()=>{t(e.record.current.number+1)},r=()=>{t(Number.MAX_SAFE_INTEGER)},a=e=>{t(e)},c=t=>{e.changeBranch(t)},l=(0,o.Fl)((()=>e.mode===Xi.NORMAL||e.mode===Xi.RESEARCH)),u=(0,o.Fl)((()=>e.record));return{isRecordOperational:l,record:u,goBegin:i,goBack:n,goForward:s,goEnd:r,selectMove:a,selectBranch:c}}});const Hn=(0,Kt.Z)(kn,[["render",gn],["__scopeId","data-v-7982776e"]]);var Cn=Hn;const Mn=e=>((0,o.dD)("data-v-7b261724"),e=e(),(0,o.Cn)(),e),Dn={class:"root"},Ln={class:"tabs"},Bn=(0,o.Uk)(" 棋譜情報 "),Gn=(0,o.Uk)(" 指し手コメント "),xn=(0,o.Uk)(" 思考 "),Kn=(0,o.Uk)(" 形勢グラフ "),Wn=(0,o.Uk)(" 最小化 "),Fn=Mn((()=>(0,o._)("div",{class:"tab-border"},null,-1))),qn={class:"tab-contents"};function Un(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon"),c=(0,o.up)("RecordInfo"),l=(0,o.up)("RecordComment"),u=(0,o.up)("EngineAnalytics"),h=(0,o.up)("EvaluationChart");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Dn,["invisible"===e.activeTab?((0,o.wg)(),(0,o.iD)("div",{key:0,style:(0,k.j5)(`height: calc(100% - ${e.headerHeight}px);`)},null,4)):(0,o.kq)("",!0),(0,o._)("div",Ln,[(0,o._)("span",{class:(0,k.C_)(["tab",{selected:"recordInfo"===e.activeTab}]),onClick:t[0]||(t[0]=t=>e.changeSelect("recordInfo"))},[(0,o.Wm)(a,{class:"icon",icon:"recordInfo"}),Bn],2),(0,o._)("span",{class:(0,k.C_)(["tab",{selected:"comment"===e.activeTab}]),onClick:t[1]||(t[1]=t=>e.changeSelect("comment"))},[(0,o.Wm)(a,{class:"icon",icon:"comment"}),Gn],2),(0,o._)("span",{class:(0,k.C_)(["tab",{selected:"search"===e.activeTab}]),onClick:t[2]||(t[2]=t=>e.changeSelect("search"))},[(0,o.Wm)(a,{class:"icon",icon:"brain"}),xn],2),(0,o._)("span",{class:(0,k.C_)(["tab",{selected:"chart"===e.activeTab}]),onClick:t[3]||(t[3]=t=>e.changeSelect("chart"))},[(0,o.Wm)(a,{class:"icon",icon:"chart"}),Kn],2),(0,o._)("span",{class:(0,k.C_)(["tab",{selected:"invisible"===e.activeTab}]),onClick:t[4]||(t[4]=t=>e.changeSelect("invisible"))},[(0,o.Wm)(a,{class:"icon",icon:"arrowDrop"}),Wn],2)]),Fn,(0,o._)("div",qn,[(0,o.Wm)(c,{class:(0,k.C_)(["tab-content",{selected:"recordInfo"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,o.Wm)(l,{class:(0,k.C_)(["tab-content",{selected:"comment"===e.activeTab}])},null,8,["class"]),(0,o.Wm)(u,{class:(0,k.C_)(["tab-content",{selected:"search"===e.activeTab}]),size:e.contentSize},null,8,["class","size"]),(0,o.Wm)(h,{class:(0,k.C_)(["tab-content",{selected:"chart"===e.activeTab}]),size:e.contentSize},null,8,["class","size"])])])])}const Zn={class:"root"},jn=["value","readonly"];function zn(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Zn,[(0,o._)("textarea",{ref:"textarea",class:"text",value:e.comment,readonly:!!e.readonly,onInput:t[0]||(t[0]=(...t)=>e.change&&e.change(...t))},null,40,jn)])])}var Vn=(0,o.aZ)({name:"RecordComment",setup(){const e=on(),t=(0,o.Fl)((()=>e.record.current.comment)),i=(0,o.Fl)((()=>e.mode!=Xi.NORMAL)),n=(0,l.iH)(null),s=t=>{const i=t.target.value;e.updateRecordComment(i)};return(0,o.bv)((()=>{n.value.addEventListener("copy",(e=>{e.stopPropagation()})),n.value.addEventListener("paste",(e=>{e.stopPropagation()}))})),{textarea:n,comment:t,readonly:i,change:s}}});const Yn=(0,Kt.Z)(Vn,[["render",zn],["__scopeId","data-v-16ede82d"]]);var Jn=Yn;const $n={class:"root"};function Xn(e,t,i,n,s,r){const a=(0,o.up)("EngineAnalyticsElement");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",$n,[e.blackPlayer?((0,o.wg)(),(0,o.j4)(a,{key:0,name:e.blackPlayer.name,info:e.blackPlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0),e.whitePlayer?((0,o.wg)(),(0,o.j4)(a,{key:1,name:e.whitePlayer.name,info:e.whitePlayer,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0),e.researcher?((0,o.wg)(),(0,o.j4)(a,{key:2,name:e.researcher.name,info:e.researcher,height:e.elementHeight},null,8,["name","info","height"])):(0,o.kq)("",!0)])])}const Qn=e=>((0,o.dD)("data-v-182c61be"),e=e(),(0,o.Cn)(),e),eo={class:"root"},to={class:"headers"},io={class:"header"},no=Qn((()=>(0,o._)("span",{class:"label"},"エンジン名: ",-1))),oo={class:"value"},so={class:"header"},ro=Qn((()=>(0,o._)("span",{class:"label"},"最善手: ",-1))),ao={class:"value"},co={class:"header"},lo=Qn((()=>(0,o._)("span",{class:"label"},"秒間探索ノード(NPS): ",-1))),uo={class:"value"},ho={class:"header"},po=Qn((()=>(0,o._)("span",{class:"label"},"探索ノード数: ",-1))),mo={class:"value"},go={class:"header"},_o=Qn((()=>(0,o._)("span",{class:"label"},"ハッシュ使用率: ",-1))),vo={class:"value"},fo=(0,o.uE)('<div class="list-header" data-v-182c61be><div class="list-column time" data-v-182c61be>経過時間</div><div class="list-column multipv-index" data-v-182c61be>順位</div><div class="list-column depth" data-v-182c61be>深さ</div><div class="list-column score" data-v-182c61be>評価値</div></div>',1),wo={class:"list-column time"},Eo={class:"list-column multipv-index"},So={class:"list-column depth"},Io={class:"list-column score"},yo={class:"list-column score-flag"},To={class:"list-column text"};function bo(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",eo,[(0,o._)("div",to,[(0,o._)("div",io,[no,(0,o._)("span",oo,(0,k.zw)(e.name),1)]),(0,o._)("div",so,[ro,(0,o._)("span",ao,(0,k.zw)(e.info.currentMoveText||"---"),1)]),(0,o._)("div",co,[lo,(0,o._)("span",uo,(0,k.zw)(e.info.nps||"---"),1)]),(0,o._)("div",ho,[po,(0,o._)("span",mo,(0,k.zw)(e.info.nodes||"---"),1)]),(0,o._)("div",go,[_o,(0,o._)("span",vo,(0,k.zw)(e.info.hashfull?(100*e.info.hashfull).toFixed(1):"---")+" % ",1)])]),fo,(0,o._)("div",{class:"list",style:(0,k.j5)(`height:${e.height-37}px`)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.info.iterates,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:(0,k.C_)(["list-item",{best:1===e.multiPV}])},[(0,o._)("div",wo,(0,k.zw)(e.timeMs?(e.timeMs/1e3).toFixed(1)+"s":""),1),(0,o._)("div",Eo,(0,k.zw)(e.multiPV||""),1),(0,o._)("div",So,(0,k.zw)(e.depth)+(0,k.zw)(e.selectiveDepth&&e.depth?"/":"")+(0,k.zw)(e.selectiveDepth),1),(0,o._)("div",Io,(0,k.zw)(e.score)+" "+(0,k.zw)(e.scoreMate?e.scoreMate:""),1),(0,o._)("div",yo,(0,k.zw)(e.lowerBound?"++":"")+" "+(0,k.zw)(e.upperBound?"--":"")+" "+(0,k.zw)(e.scoreMate?"詰":""),1),(0,o._)("div",To,(0,k.zw)(e.text),1)],2)))),128))],4)])])}var No=(0,o.aZ)({name:"EngineAnalyticsElement",props:{name:{type:String,required:!0},info:{type:Ji,required:!0},height:{type:Number,required:!0}}});const Oo=(0,Kt.Z)(No,[["render",bo],["__scopeId","data-v-182c61be"]]);var Ao=Oo,Po=(0,o.aZ)({name:"EngineAnalytics",components:{EngineAnalyticsElement:Ao},props:{size:{type:Gt,required:!0}},setup(e){const t=on(),i=(0,o.Fl)((()=>t.usiBlackPlayerMonitor)),n=(0,o.Fl)((()=>t.usiWhitePlayerMonitor)),s=(0,o.Fl)((()=>t.usiResearcherMonitor)),r=(0,o.Fl)((()=>{const i=(t.usiBlackPlayerMonitor?1:0)+(t.usiWhitePlayerMonitor?1:0)+(t.usiResearcherMonitor?1:0);return 0!==i?e.size.height/i:0}));return{blackPlayer:i,whitePlayer:n,researcher:s,elementHeight:r}}});const Ro=(0,Kt.Z)(Po,[["render",Xn],["__scopeId","data-v-3d2d2022"]]);var ko=Ro;const Ho={class:"root"},Co=["width","height"];function Mo(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Ho,[(0,o._)("canvas",{ref:"canvas",width:e.size.width.toFixed(0),height:e.size.height.toFixed(0)},null,8,Co)])])}var Do=i(2728),Lo=(0,o.aZ)({name:"EvaluationChart",props:{size:{type:Gt,required:!0}},setup(e){const t=(0,l.iH)(null),i=on();let n;const s=(e,t,i)=>{const n=[];return i.moves.forEach((e=>{const i=new Ui(e.customData),o=i.evaluation&&i.evaluation[t];o&&n.push({x:e.number,y:o})})),{label:Wi(t),borderColor:e,data:n,showLine:!0}},r=e=>({label:"現在の局面",borderColor:"red",data:[{x:e.current.number,y:Fi},{x:e.current.number,y:qi}],showLine:!0,pointBorderWidth:0,pointRadius:0}),a=e=>[r(e),s("royalblue",Ki.BLACK_PLAYER,e),s("darkorange",Ki.WHITE_PLAYER,e),s("darkgreen",Ki.RESEARCHER,e)],c=e=>({x:{min:0,max:e.length+10},y:{min:qi,max:Fi}}),u=(e,t,n)=>{if(null===e.x)return;const o=n.scales.x.max-n.scales.x.min,s=n.scales.x.right-n.scales.x.left,r=(e.x-n.scales.x.left)/s*o+n.scales.x.min,a=Math.round(r);i.changeMoveNumber(a)};return(0,o.bv)((()=>{const e=t.value,o=e.getContext("2d"),s=i.record;n=new Do.kL(o,{type:"scatter",data:{datasets:a(s)},options:{color:"black",animation:{duration:0},maintainAspectRatio:!1,events:["click"],onClick:u}}),n.draw()})),(0,o.Ah)((()=>{n.destroy()})),(0,o.YP)((()=>[i.record]),(([e])=>{n.data.datasets=a(e),n.options.scales=c(e),n.update()}),{deep:!0}),(0,o.YP)((()=>[e.size]),(([e])=>{n.resize(e.width,e.height)}),{deep:!0}),{canvas:t}}});const Bo=(0,Kt.Z)(Lo,[["render",Mo],["__scopeId","data-v-55fa65fc"]]);var Go=Bo;const xo={class:"key"},Ko=["value","onInput"];function Wo(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{class:"root",style:(0,k.j5)(`height:${e.size.height}px`)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.list,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.key,class:"element"},[(0,o._)("div",xo,(0,k.zw)(t.displayName),1),(0,o._)("input",{class:"value-input",value:t.value,onInput:i=>e.change(i,t.key)},null,40,Ko)])))),128))],4)])}var Fo=(0,o.aZ)({name:"RecordComment",props:{size:{type:Gt,required:!0}},setup(){const e=on(),t=(0,o.Fl)((()=>Object.values(Ue).map((t=>{const i=e.record.metadata;return{key:t,displayName:je(t),value:i.getStandardMetadata(t)||""}})))),i=(t,i)=>{const n=t.target;e.updateStandardRecordMetadata({key:i,value:n.value})};return{list:t,change:i}}});const qo=(0,Kt.Z)(Fo,[["render",Wo],["__scopeId","data-v-3b8399d9"]]);var Uo=qo;const Zo=30,jo=240+Zo;var zo=(0,o.aZ)({name:"TabPane",components:{RecordComment:Jn,EngineAnalytics:ko,EvaluationChart:Go,RecordInfo:Uo,ButtonIcon:hn},props:{size:{type:Gt,required:!0}},setup(e){const t=on(),i=e=>{t.updateAppSetting({tab:e})},n=(0,o.Fl)((()=>t.appSetting.tab)),s=(0,o.Fl)((()=>e.size.reduce(new Gt(0,Zo))));return{activeTab:n,contentSize:s,headerHeight:Zo,changeSelect:i}}});const Vo=(0,Kt.Z)(zo,[["render",Un],["__scopeId","data-v-7b261724"]]);var Yo=Vo,Jo=(0,o.aZ)({name:"StandardLayout",components:{BoardPane:mn,RecordPane:Cn,TabPane:Yo},setup(){const e=(0,l.qj)(new Gt(0,0)),t=(0,l.iH)(0),i=(0,l.iH)(null),n=()=>{e.width=window.innerWidth,e.height=window.innerHeight},s=new ResizeObserver((e=>{t.value=e[0].contentRect.height}));(0,o.bv)((()=>{n(),window.addEventListener("resize",n),s.observe(i.value)})),(0,o.Ah)((()=>{window.removeEventListener("resize",n),s.disconnect()}));const r=(0,o.Fl)((()=>{const t=on().appSetting.tab!==Xt.INVISIBLE?jo:Zo;return new Gt(e.width-Rn,e.height-t)})),a=(0,o.Fl)((()=>new Gt(e.width,e.height-t.value)));return{topPane:i,boardPaneMaxSize:r,bottomPaneSize:a}}});const $o=(0,Kt.Z)(Jo,[["render",c],["__scopeId","data-v-6355277e"]]);var Xo=$o;const Qo=e=>((0,o.dD)("data-v-48ae3ed2"),e=e(),(0,o.Cn)(),e),es={ref:"dialog"},ts=Qo((()=>(0,o._)("div",{class:"dialog-title"},"対局",-1))),is={class:"dialog-form-area"},ns={class:"players"},os={class:"player"},ss=Qo((()=>(0,o._)("div",{class:"top-label"},"先手（下手）",-1))),rs=["value"],as=["value"],cs={class:"player"},ls=Qo((()=>(0,o._)("div",{class:"top-label"},"後手（上手）",-1))),us=["value"],hs=["value"],ds={class:"players-control"},ps=(0,o.Uk)(" 先後入れ替え "),ms={class:"dialog-form-areas-h"},gs={class:"dialog-form-area time-limit"},_s={class:"dialog-form-item"},vs=Qo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"持ち時間",-1))),fs=["value"],ws=Qo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"時間",-1))),Es=["value"],Ss=Qo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"分",-1))),Is={class:"dialog-form-item"},ys=Qo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"秒読み",-1))),Ts=["value"],bs=Qo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"秒",-1))),Ns={class:"dialog-form-item"},Os=Qo((()=>(0,o._)("div",{class:"dialog-form-item-label"},"増加",-1))),As=["value"],Ps=Qo((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"秒",-1))),Rs={class:"dialog-form-area flags"},ks={class:"dialog-form-item"},Hs=["value"],Cs=(0,o.uE)('<option value="current" data-v-48ae3ed2>現在の局面</option><option value="standard" data-v-48ae3ed2>平手</option><option value="handicapLance" data-v-48ae3ed2>香落ち</option><option value="handicapRightLance" data-v-48ae3ed2>右香落ち</option><option value="handicapBishop" data-v-48ae3ed2>角落ち</option><option value="handicapRook" data-v-48ae3ed2>飛車落ち</option><option value="handicapRookLance" data-v-48ae3ed2>飛車香落ち</option><option value="handicap2Pieces" data-v-48ae3ed2>2枚落ち</option><option value="handicap4Pieces" data-v-48ae3ed2>4枚落ち</option><option value="handicap6Pieces" data-v-48ae3ed2>6枚落ち</option><option value="handicap8Pieces" data-v-48ae3ed2>8枚落ち</option>',11),Ms=[Cs],Ds={class:"dialog-form-item"},Ls=["checked"],Bs=Qo((()=>(0,o._)("label",{for:"disable-engine-timeout"},"エンジンの時間切れあり",-1))),Gs={class:"dialog-form-item"},xs=["checked"],Ks=Qo((()=>(0,o._)("label",{for:"human-is-front"},"人を手前に表示する",-1))),Ws={class:"dialog-main-buttons"};function Fs(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",es,[ts,(0,o._)("div",is,[(0,o._)("div",ns,[(0,o._)("div",os,[ss,(0,o._)("select",{ref:"blackPlayerSelect",class:"player-select",size:"1",value:e.defaultValues.black.type},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.players,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,k.zw)(e.name),9,as)))),128))],8,rs)]),(0,o._)("div",cs,[ls,(0,o._)("select",{ref:"whitePlayerSelect",class:"player-select",size:"1",value:e.defaultValues.white.type},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.players,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,k.zw)(e.name),9,hs)))),128))],8,us)])]),(0,o._)("div",ds,[(0,o._)("button",{onClick:t[0]||(t[0]=(...t)=>e.onSwapColor&&e.onSwapColor(...t))},[(0,o.Wm)(a,{class:"icon",icon:"swap_h"}),ps])])]),(0,o._)("div",ms,[(0,o._)("div",gs,[(0,o._)("div",_s,[vs,(0,o._)("input",{ref:"hours",class:"time-input",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.hours},null,8,fs),ws,(0,o._)("input",{ref:"minutes",class:"time-input",type:"number",min:"0",max:"59",step:"1",value:e.defaultValues.timeLimit.minutes},null,8,Es),Ss]),(0,o._)("div",Is,[ys,(0,o._)("input",{ref:"byoyomi",class:"time-input single",type:"number",min:"0",max:"60",step:"1",value:e.defaultValues.timeLimit.byoyomi},null,8,Ts),bs]),(0,o._)("div",Ns,[Os,(0,o._)("input",{ref:"increment",class:"time-input single",type:"number",min:"0",max:"99",step:"1",value:e.defaultValues.timeLimit.increment},null,8,As),Ps])]),(0,o._)("div",Rs,[(0,o._)("div",ks,[(0,o._)("select",{ref:"startPosition",value:e.defaultValues.startPosition},Ms,8,Hs)]),(0,o._)("div",Ds,[(0,o._)("input",{id:"disable-engine-timeout",ref:"enableEngineTimeout",type:"checkbox",checked:e.defaultValues.enableEngineTimeout},null,8,Ls),Bs]),(0,o._)("div",Gs,[(0,o._)("input",{id:"human-is-front",ref:"humanIsFront",type:"checkbox",checked:e.defaultValues.humanIsFront},null,8,xs),Ks])])]),(0,o._)("div",Ws,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.onStart())},"対局開始"),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.onCancel())},"キャンセル")])],512)])}function qs(e){e.addEventListener("cancel",(e=>{e.preventDefault(),e.stopPropagation()})),e.addEventListener("copy",(e=>{e.stopPropagation()})),e.addEventListener("paste",(e=>{e.stopPropagation()})),e.showModal()}function Us(e){return document.getElementById(e)}function Zs(e){const t=Number(e.value),i=Number(e.max),n=Number(e.min);return Math.min(Math.max(t,n),i)}var js=(0,o.aZ)({name:"GameDialog",components:{ButtonIcon:hn},setup(){const e=on(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(null),s=(0,l.iH)(null),r=(0,l.iH)(null),a=(0,l.iH)(null),c=(0,l.iH)(null),u=(0,l.iH)(null),h=(0,l.iH)(null),d=(0,l.iH)(null),p=(0,l.iH)(ii()),m=(0,l.iH)(new Jt);e.retainBussyState(),(0,o.bv)((async()=>{qs(t.value);try{p.value=await wi(),m.value=await Si(),e.releaseBussyState()}catch(i){e.pushError(i),e.closeDialog()}}));const g=e=>{if(Zt(e)){const t=m.value.getEngine(e);return{name:t.name,uri:e,usi:t}}return{name:"人",uri:qt}},_=()=>{const t={black:g(i.value.value),white:g(n.value.value),timeLimit:{timeSeconds:60*(60*Zs(s.value)+Zs(r.value)),byoyomi:Zs(a.value),increment:Zs(c.value)},startPosition:"current"!==u.value.value?u.value.value:void 0,enableEngineTimeout:h.value.checked,humanIsFront:d.value.checked},o=ni(t);o?e.pushError(o):e.startGame(t)},v=()=>{e.closeDialog()},f=()=>{[i.value.value,n.value.value]=[n.value.value,i.value.value]},w=(0,o.Fl)((()=>({black:{type:p.value.black.uri},white:{type:p.value.white.uri},timeLimit:{hours:Math.floor(p.value.timeLimit.timeSeconds/3600),minutes:Math.floor(p.value.timeLimit.timeSeconds/60)%60,byoyomi:p.value.timeLimit.byoyomi,increment:p.value.timeLimit.increment},startPosition:void 0!==p.value.startPosition?p.value.startPosition:"current",enableEngineTimeout:p.value.enableEngineTimeout,humanIsFront:p.value.humanIsFront}))),E=(0,o.Fl)((()=>[{name:"人",uri:qt},...m.value.engineList]));return{dialog:t,blackPlayerSelect:i,whitePlayerSelect:n,hours:s,minutes:r,byoyomi:a,increment:c,startPosition:u,enableEngineTimeout:h,humanIsFront:d,defaultValues:w,players:E,onStart:_,onCancel:v,onSwapColor:f}}});const zs=(0,Kt.Z)(js,[["render",Fs],["__scopeId","data-v-48ae3ed2"]]);var Vs=zs;const Ys=e=>((0,o.dD)("data-v-f5f3a750"),e=e(),(0,o.Cn)(),e),Js={ref:"dialog"},$s=Ys((()=>(0,o._)("div",{class:"dialog-title"},"検討",-1))),Xs={class:"dialog-form-area"},Qs={class:"dialog-form-item"},er=Ys((()=>(0,o._)("div",{class:"dialog-form-item-label"},"エンジン",-1))),tr={class:"dialog-form-item-unit"},ir=["value"],nr=["value"],or={class:"dialog-main-buttons"};function sr(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Js,[$s,(0,o._)("div",Xs,[(0,o._)("div",Qs,[er,(0,o._)("div",tr,[(0,o._)("select",{ref:"engineSelect",class:"engine-select",size:"1",value:e.defaultValue},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.engines,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.uri,value:e.uri},(0,k.zw)(e.name),9,nr)))),128))],8,ir)])])]),(0,o._)("div",or,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=t=>e.onStart())},"検討開始"),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.onCancel())},"キャンセル")])],512)])}var rr=(0,o.aZ)({name:"ResearchDialog",setup(){const e=on(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(oi()),s=(0,l.iH)(new Jt);e.retainBussyState(),(0,o.bv)((async()=>{qs(t.value);try{n.value=await vi(),s.value=await Si(),e.releaseBussyState()}catch(i){e.pushError(i),e.closeDialog()}}));const r=()=>{const t=i.value.value;if(!s.value.hasEngine(t))return void e.pushError("エンジンを選択してください。");const n=s.value.getEngine(t),o={usi:n};e.startResearch(o)},a=()=>{e.closeDialog()},c=(0,o.Fl)((()=>s.value.engineList)),u=(0,o.Fl)((()=>n.value.usi?n.value.usi.uri:""));return{dialog:t,engineSelect:i,engines:c,defaultValue:u,onStart:r,onCancel:a}}});const ar=(0,Kt.Z)(rr,[["render",sr],["__scopeId","data-v-f5f3a750"]]);var cr=ar;const lr=e=>((0,o.dD)("data-v-e289221a"),e=e(),(0,o.Cn)(),e),ur={ref:"dialog"},hr=lr((()=>(0,o._)("div",{class:"dialog-title"},"エンジン管理",-1))),dr={class:"dialog-form-area engine-list"},pr={key:0,class:"engine"},mr=["value"],gr={class:"engine-name"},_r=["onClick"],vr=["onClick"],fr=["onClick"],wr={class:"dialog-main-buttons"};function Er(e,t,i,n,s,r){const a=(0,o.up)("USIEngineOptionDialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",null,[(0,o._)("dialog",ur,[hr,(0,o._)("div",dr,[0===e.engines.length?((0,o.wg)(),(0,o.iD)("div",pr," エンジンが登録されていません。 ")):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.engines,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.uri,class:"engine",value:t.uri},[(0,o._)("div",gr,(0,k.zw)(t.name),1),(0,o._)("button",{class:"dialog-narrow-button",onClick:i=>e.openOptions(t.uri)}," 設定 ",8,_r),(0,o._)("button",{class:"dialog-narrow-button",onClick:i=>e.duplicate(t.uri)}," 複製 ",8,vr),(0,o._)("button",{class:"dialog-narrow-button",onClick:i=>e.remove(t.uri)}," 削除 ",8,fr)],8,mr)))),128))]),(0,o._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=t=>e.add())},"追加"),(0,o._)("div",wr,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.saveAndClose())}," 保存して閉じる "),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.cancel())},"キャンセル")])],512)]),e.optionDialog?((0,o.wg)(),(0,o.j4)(a,{key:0,"latest-engine-setting":e.optionDialog,onOk:e.optionOk,onCancel:e.optionCancel},null,8,["latest-engine-setting","onOk","onCancel"])):(0,o.kq)("",!0)],64)}const Sr=e=>((0,o.dD)("data-v-c4e7276c"),e=e(),(0,o.Cn)(),e),Ir={ref:"dialog"},yr=Sr((()=>(0,o._)("div",{class:"dialog-title"},"エンジン設定",-1))),Tr={class:"dialog-form-area option-list"},br={class:"option"},Nr=Sr((()=>(0,o._)("div",{class:"option-name"},"エンジン名",-1))),Or={class:"option-unchangeable"},Ar={class:"option"},Pr=Sr((()=>(0,o._)("div",{class:"option-name"},"作者",-1))),Rr={class:"option-unchangeable"},kr={class:"option"},Hr=Sr((()=>(0,o._)("div",{class:"option-name"},"場所",-1))),Cr={class:"option-unchangeable"},Mr={class:"option"},Dr=Sr((()=>(0,o._)("div",{class:"option-name"},"表示名",-1))),Lr={ref:"engineNameInput",class:"option-value-text",type:"text",name:"ElectronShogiEngineName"},Br={class:"option-name"},Gr=["id","min","max","name"],xr=["id","name"],Kr=["id","name"],Wr=["onClick"],Fr=["id"],qr=Sr((()=>(0,o._)("option",{value:""},"既定値",-1))),Ur=Sr((()=>(0,o._)("option",{value:"true"},"ON",-1))),Zr=Sr((()=>(0,o._)("option",{value:"false"},"OFF",-1))),jr=[qr,Ur,Zr],zr=["id"],Vr=Sr((()=>(0,o._)("option",{value:""},"既定値",-1))),Yr=["value"],Jr=["onClick"],$r={class:"dialog-main-buttons"};function Xr(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Ir,[yr,(0,o._)("div",Tr,[(0,o._)("div",br,[Nr,(0,o._)("div",Or,(0,k.zw)(e.engine.defaultName),1)]),(0,o._)("div",Ar,[Pr,(0,o._)("div",Rr,(0,k.zw)(e.engine.author),1)]),(0,o._)("div",kr,[Hr,(0,o._)("div",Cr,(0,k.zw)(e.engine.path),1)]),(0,o._)("div",Mr,[Dr,(0,o._)("input",Lr,null,512)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.options,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.name,class:"option"},[(0,o._)("div",Br,(0,k.zw)(t.name),1),"spin"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:0,id:t.inputId,class:"option-value-number",type:"number",min:t.min,max:t.max,step:"1",name:t.name},null,8,Gr)):(0,o.kq)("",!0),"string"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:1,id:t.inputId,class:"option-value-text",type:"text",name:t.name},null,8,xr)):(0,o.kq)("",!0),"filename"===t.type?((0,o.wg)(),(0,o.iD)("input",{key:2,id:t.inputId,class:"option-value-filename",type:"text",name:t.name},null,8,Kr)):(0,o.kq)("",!0),"filename"===t.type?((0,o.wg)(),(0,o.iD)("button",{key:3,class:"dialog-button",onClick:i=>e.selectFile(t.inputId)}," 選択 ",8,Wr)):(0,o.kq)("",!0),"check"===t.type?((0,o.wg)(),(0,o.iD)("select",{key:4,id:t.inputId,class:"option-value-check"},jr,8,Fr)):(0,o.kq)("",!0),"combo"===t.type?((0,o.wg)(),(0,o.iD)("select",{key:5,id:t.inputId,class:"option-value-combo"},[Vr,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.vars,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e},(0,k.zw)(e),9,Yr)))),128))],8,zr)):(0,o.kq)("",!0),"button"===t.type?((0,o.wg)(),(0,o.iD)("button",{key:6,class:"dialog-button",onClick:i=>e.sendOption(t.name)}," 実行 ",8,Jr)):(0,o.kq)("",!0)])))),128))]),(0,o._)("button",{class:"dialog-wide-button",onClick:t[0]||(t[0]=t=>e.reset())}," エンジンの既定値に戻す "),(0,o._)("div",$r,[(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.ok())},"OK"),(0,o._)("button",{class:"dialog-button",onClick:t[2]||(t[2]=t=>e.cancel())},"キャンセル")])],512)])}var Qr=(0,o.aZ)({name:"USIEngineOptionDialog",props:{latestEngineSetting:{type:Object,required:!0}},emits:["ok","cancel"],setup(e,t){const i=on(),n=(0,l.iH)(null),s=(0,l.iH)(null),r=e.latestEngineSetting;let a=(0,l.iH)(r);const c=(0,o.Fl)((()=>Object.values(a.value.options).sort(((e,t)=>{const i=e.name.startsWith("USI_"),n=t.name.startsWith("USI_");return i!==n?i?-1:1:e.name<t.name?-1:1})).map(((e,t)=>({...e,inputId:"usiEngineOptionDialogOption"+t,value:zt(e)})))));i.retainBussyState(),(0,o.bv)((async()=>{qs(n.value);try{a.value=await Ti(r.path),Yt(a.value,r),s.value.value=a.value.name;for(const e of c.value){const t=Us(e.inputId);t&&void 0!==e.value&&(t.value=e.value+"")}}catch(e){i.pushError(e)}finally{i.releaseBussyState()}}));const u=async e=>{i.retainBussyState();try{const t=await mi(),n=Us(e);t&&n&&(n.value=t)}catch(t){i.pushError(t)}finally{i.releaseBussyState()}},h=async e=>{i.retainBussyState();try{await ki(a.value.path,e)}catch(t){i.pushError(t)}finally{i.releaseBussyState()}},d=()=>{s.value.value=a.value.defaultName;for(const e of c.value){const t=Us(e.inputId);t&&(void 0!==a.value.options[e.name].default?t.value=a.value.options[e.name].default+"":t.value="")}},p=()=>{a.value.name=s.value.value;for(const e of c.value){const t=Us(e.inputId);t&&(a.value.options[e.name].value=t.value?"spin"===e.type?Zs(t):t.value:void 0)}t.emit("ok",a.value)},m=()=>{t.emit("cancel")};return{engine:a,dialog:n,engineNameInput:s,options:c,selectFile:u,sendOption:h,reset:d,ok:p,cancel:m}}});const ea=(0,Kt.Z)(Qr,[["render",Xr],["__scopeId","data-v-c4e7276c"]]);var ta=ea,ia=(0,o.aZ)({name:"USIEngineManagementDialog",components:{USIEngineOptionDialog:ta},setup(){const e=on(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(new Jt);e.retainBussyState(),(0,o.bv)((async()=>{qs(t.value);try{n.value=await Si(),e.releaseBussyState()}catch(i){e.pushError(i),e.closeDialog()}}));const s=async()=>{try{e.retainBussyState();const t=await yi();if(!t)return;n.value.addEngine(await Ti(t))}catch(t){e.pushError(t)}finally{e.releaseBussyState()}},r=e=>{n.value.removeEngine(e)},a=e=>{i.value=n.value.getEngine(e)},c=e=>{const t=n.value.getEngine(e),i=Vt(t);n.value.addEngine(i)},u=async()=>{try{e.retainBussyState(),await Ii(n.value),e.closeDialog()}catch(t){e.pushError(t)}finally{e.releaseBussyState()}},h=()=>{e.closeDialog()},d=e=>{n.value.updateEngine(e),i.value=null},p=()=>{i.value=null},m=(0,o.Fl)((()=>n.value.engineList));return{optionDialog:i,dialog:t,engines:m,add:s,remove:r,openOptions:a,duplicate:c,saveAndClose:u,cancel:h,optionOk:d,optionCancel:p}}});const na=(0,Kt.Z)(ia,[["render",Er],["__scopeId","data-v-e289221a"]]);var oa=na;const sa=e=>((0,o.dD)("data-v-3fceaa98"),e=e(),(0,o.Cn)(),e),ra={ref:"dialog"},aa=sa((()=>(0,o._)("div",{class:"dialog-title"},"アプリ設定",-1))),ca={class:"dialog-form-area settings"},la={class:"dialog-form-item"},ua=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"駒画像",-1))),ha=["value"],da=["value"],pa={class:"dialog-form-item"},ma=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"盤画像",-1))),ga=["value"],_a=["value"],va={class:"dialog-form-item"},fa=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"駒音の大きさ",-1))),wa=["value"],Ea=sa((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"%",-1))),Sa={class:"dialog-form-item"},Ia=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の大きさ",-1))),ya=["value"],Ta=sa((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"%",-1))),ba={class:"dialog-form-item"},Na=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の高さ",-1))),Oa=["value"],Aa=sa((()=>(0,o._)("div",{class:"dialog-form-item-unit"},"Hz (220 ~ 880)",-1))),Pa={class:"dialog-form-item"},Ra=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"時計音の対象",-1))),ka=["value"],Ha=sa((()=>(0,o._)("option",{value:"all"},"全ての手番",-1))),Ca=sa((()=>(0,o._)("option",{value:"onlyUser"},"人の手番のみ",-1))),Ma=[Ha,Ca],Da={class:"dialog-form-item"},La=sa((()=>(0,o._)("div",{class:"dialog-form-item-label-wide"},"改行文字",-1))),Ba=["value"],Ga=sa((()=>(0,o._)("option",{value:"crlf"},"CR + LF (Windows)",-1))),xa=sa((()=>(0,o._)("option",{value:"lf"},"LF (UNIX/Mac)",-1))),Ka=sa((()=>(0,o._)("option",{value:"cr"},"CR (90年代Mac)",-1))),Wa=[Ga,xa,Ka],Fa={class:"dialog-main-buttons"};function qa(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",ra,[aa,(0,o._)("div",ca,[(0,o._)("div",la,[ua,(0,o._)("select",{ref:"pieceImage",value:e.appSetting.pieceImage},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.pieceImageTypes,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e.value},(0,k.zw)(e.name),9,da)))),128))],8,ha)]),(0,o._)("div",pa,[ma,(0,o._)("select",{ref:"boardImage",value:e.appSetting.boardImage},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.boardImageTypes,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e.value},(0,k.zw)(e.name),9,_a)))),128))],8,ga)]),(0,o._)("div",va,[fa,(0,o._)("input",{ref:"pieceVolume",value:e.appSetting.pieceVolume,type:"number",max:"100",min:"0"},null,8,wa),Ea]),(0,o._)("div",Sa,[Ia,(0,o._)("input",{ref:"clockVolume",value:e.appSetting.clockVolume,type:"number",max:"100",min:"0"},null,8,ya),Ta]),(0,o._)("div",ba,[Na,(0,o._)("input",{ref:"clockPitch",value:e.appSetting.clockPitch,type:"number",max:"880",min:"220"},null,8,Oa),Aa]),(0,o._)("div",Pa,[Ra,(0,o._)("select",{ref:"clockSoundTarget",value:e.appSetting.clockSoundTarget},Ma,8,ka)]),(0,o._)("div",Da,[La,(0,o._)("select",{ref:"returnCode",value:e.appSetting.returnCode},Wa,8,Ba)])]),(0,o._)("div",Fa,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=t=>e.saveAndClose())}," 保存して閉じる "),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.cancel())},"キャンセル")])],512)])}const Ua={"\r\n":"crlf","\n":"lf","\r":"cr"},Za={crlf:"\r\n",lf:"\n",cr:"\r"};var ja=(0,o.aZ)({name:"AppSettingDialog",setup(){const e=on(),t=(0,l.iH)(null),i=(0,l.iH)(null),n=(0,l.iH)(null),s=(0,l.iH)(null),r=(0,l.iH)(null),a=(0,l.iH)(null),c=(0,l.iH)(null),u=(0,l.iH)(null);(0,o.bv)((()=>{qs(t.value)}));const h=async()=>{const t={pieceImage:i.value.value,boardImage:n.value.value,pieceVolume:Zs(s.value),clockVolume:Zs(r.value),clockPitch:Zs(a.value),clockSoundTarget:c.value.value,returnCode:Za[u.value.value]};e.retainBussyState();try{await e.updateAppSetting(t),e.closeDialog()}catch(o){e.pushError(o)}finally{e.releaseBussyState()}},d=()=>{e.closeDialog()},p=(0,o.Fl)((()=>({...e.appSetting,returnCode:Ua[e.appSetting.returnCode]}))),m=[{name:"一文字駒",value:kt.HITOMOJI},{name:"一文字駒（ゴシック体）",value:kt.HITOMOJI_GOTHIC}],g=[{name:"木目（明るい）",value:Ht.LIGHT},{name:"木目（暖かい）",value:Ht.WARM},{name:"塩化ビニル",value:Ht.RESIN}];return{dialog:t,pieceImage:i,boardImage:n,pieceVolume:s,clockVolume:r,clockPitch:a,clockSoundTarget:c,returnCode:u,appSetting:p,pieceImageTypes:m,boardImageTypes:g,saveAndClose:h,cancel:d}}});const za=(0,Kt.Z)(ja,[["render",qa],["__scopeId","data-v-3fceaa98"]]);var Va=za;const Ya=e=>((0,o.dD)("data-v-86898e3c"),e=e(),(0,o.Cn)(),e),Ja={ref:"dialog"},$a={ref:"content"},Xa={class:"dialog-form-area"},Qa=Ya((()=>(0,o._)("div",{class:"message"},"以下の棋譜を取り込みます。",-1))),ec={key:0,class:"message"},tc=(0,o.Uk)(" ※テキストエリアに棋譜を貼り付けてください。"),ic=Ya((()=>(0,o._)("br",null,null,-1))),nc=(0,o.Uk)(" ※インストールアプリ版では自動的に貼り付けられます。 "),oc=[tc,ic,nc],sc={ref:"textarea"},rc={class:"dialog-main-buttons"};function ac(e,t,i,n,s,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Ja,[(0,o._)("div",$a,[(0,o._)("div",Xa,[Qa,e.isNative?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",ec,oc)),(0,o._)("textarea",sc,null,512)])],512),(0,o._)("div",rc,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=(...t)=>e.onOk&&e.onOk(...t))},"取り込む"),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=(...t)=>e.onCancel&&e.onCancel(...t))},"キャンセル")])],512)])}var cc=(0,o.aZ)({name:"PasteDialog",setup(){const e=on(),t=(0,l.iH)(null),i=(0,l.iH)(null);e.retainBussyState(),(0,o.bv)((async()=>{try{qs(t.value),ai()&&(i.value.value=await navigator.clipboard.readText())}finally{e.releaseBussyState()}}));const n=()=>{const t=i.value.value;e.closePasteDialog(),t&&e.pasteRecord(t)},s=()=>{e.closePasteDialog()};return{dialog:t,textarea:i,onOk:n,onCancel:s,isNative:ai()}}});const lc=(0,Kt.Z)(cc,[["render",ac],["__scopeId","data-v-86898e3c"]]);var uc=lc;const hc=e=>((0,o.dD)("data-v-4939dcf2"),e=e(),(0,o.Cn)(),e),dc={ref:"dialog",class:"bussy"},pc={class:"content"},mc=hc((()=>(0,o._)("div",{class:"message"},"処理中です。お待ち下さい。",-1)));function gc(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",dc,[(0,o._)("div",pc,[(0,o.Wm)(a,{class:"icon",icon:"bussy"}),mc])],512)])}var _c=(0,o.aZ)({name:"BussyMessage",components:{ButtonIcon:hn},setup(){const e=(0,l.iH)(null);return(0,o.bv)((()=>{qs(e.value)})),{dialog:e}}});const vc=(0,Kt.Z)(_c,[["render",gc],["__scopeId","data-v-4939dcf2"]]);var fc=vc;const wc={ref:"dialog"},Ec={class:"content"},Sc={class:"message"},Ic={class:"dialog-main-buttons"};function yc(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",wc,[(0,o._)("div",Ec,[(0,o.Wm)(a,{class:"icon",icon:"question"}),(0,o._)("div",Sc,(0,k.zw)(e.message),1)]),(0,o._)("div",Ic,[(0,o._)("button",{class:"dialog-button",onClick:t[0]||(t[0]=t=>e.onOk())},"OK"),(0,o._)("button",{class:"dialog-button",onClick:t[1]||(t[1]=t=>e.onClose())},"キャンセル")])],512)])}var Tc=(0,o.aZ)({name:"InfoMessage",components:{ButtonIcon:hn},setup(){const e=on(),t=(0,l.iH)(null),i=(0,o.Fl)((()=>e.confirmation));(0,o.bv)((()=>{qs(t.value)}));const n=()=>{e.confirmationOk()},s=()=>{e.confirmationCancel()};return{dialog:t,message:i,onOk:n,onClose:s}}});const bc=(0,Kt.Z)(Tc,[["render",yc]]);var Nc=bc;const Oc={ref:"dialog"},Ac={class:"content"},Pc={class:"message"},Rc={class:"dialog-main-buttons"};function kc(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Oc,[(0,o._)("div",Ac,[(0,o.Wm)(a,{class:"icon",icon:"info"}),(0,o._)("div",Pc,(0,k.zw)(e.message),1)]),(0,o._)("div",Rc,[(0,o._)("button",{onClick:t[0]||(t[0]=t=>e.onClose())},"閉じる")])],512)])}var Hc=(0,o.aZ)({name:"InfoMessage",components:{ButtonIcon:hn},setup(){const e=on(),t=(0,l.iH)(null);(0,o.bv)((()=>{qs(t.value)}));const i=(0,o.Fl)((()=>e.message)),n=()=>{e.dequeueMessage()};return{dialog:t,message:i,onClose:n}}});const Cc=(0,Kt.Z)(Hc,[["render",kc]]);var Mc=Cc;const Dc={ref:"dialog",class:"error"},Lc={class:"content"},Bc={class:"items"},Gc={class:"notice"},xc={class:"index"},Kc={class:"message"},Wc={class:"dialog-main-buttons"};function Fc(e,t,i,n,s,r){const a=(0,o.up)("ButtonIcon");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("dialog",Dc,[(0,o._)("div",Lc,[(0,o.Wm)(a,{class:"icon",icon:"error"}),(0,o._)("div",Bc,[(0,o._)("div",Gc,(0,k.zw)(e.errors.length)+" 件のエラーが発生しました。 ",1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.errors,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.index,class:"item"},[(0,o._)("p",xc,(0,k.zw)(e.index+1)+" 件目",1),(0,o._)("p",Kc,(0,k.zw)(e.message),1)])))),128))])]),(0,o._)("div",Wc,[(0,o._)("button",{onClick:t[0]||(t[0]=t=>e.onClose())},"閉じる")])],512)])}var qc=(0,o.aZ)({name:"ErrorMessage",components:{ButtonIcon:hn},setup(){const e=on(),t=(0,l.iH)(null);(0,o.bv)((()=>{qs(t.value)}));const i=(0,o.Fl)((()=>e.errors.map(((e,t)=>({message:e.message,index:t}))))),n=()=>{e.clearErrors()};return{dialog:t,errors:i,onClose:n}}});const Uc=(0,Kt.Z)(qc,[["render",Fc],["__scopeId","data-v-53994b82"]]);var Zc=Uc;function jc(){const e=document.activeElement;return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement}function zc(e,t){if(!jc())switch(e){case"ArrowUp":return t.onArrowUp;case"ArrowDown":return t.onArrowDown;case"ArrowLeft":return t.onArrowLeft;case"ArrowRight":return t.onArrowRight}}function Vc(e){document.addEventListener("keydown",(t=>{const i=zc(t.key,e);i&&(t.preventDefault(),i())}))}var Yc=(0,o.aZ)({name:"App",components:{StandardLayout:Xo,GameDialog:Vs,ResearchDialog:cr,USIEngineManagementDialog:oa,AppSettingDialog:Va,PasteDialog:uc,BussyMessage:fc,ConfirmDialog:Nc,InfoMessage:Mc,ErrorMessage:Zc},setup(){const e=on(),t=(0,o.Fl)((()=>({game:e.mode===Xi.GAME_DIALOG,research:e.mode===Xi.RESEARCH_DIALOG,usiEngineSetting:e.mode===Xi.USI_ENGINE_SETTING_DIALOG,appSetting:e.mode===Xi.APP_SETTING_DIALOG,paste:e.mode===Xi.PASTE_DIALOG,bussy:e.isBussy,confirm:void 0!==e.confirmation}))),i=(0,o.Fl)((()=>e.hasMessage)),n=(0,o.Fl)((()=>e.hasError));return(0,o.bv)((()=>{const t=document.getElementsByTagName("body")[0];t.addEventListener("copy",(t=>{e.copyRecord(),t.preventDefault()})),t.addEventListener("paste",(t=>{e.showPasteDialog(),t.preventDefault()})),t.addEventListener("dragover",(e=>{e.preventDefault()})),t.addEventListener("drop",(t=>{if(t.dataTransfer&&t.dataTransfer.files[0]){const i=t.dataTransfer.files[0].path;e.openRecord(i)}t.preventDefault()})),Vc({onArrowUp(){const t=e.record.current.number;e.changeMoveNumber(t-1)},onArrowDown(){const t=e.record.current.number;e.changeMoveNumber(t+1)},onArrowLeft(){e.changeMoveNumber(0)},onArrowRight(){e.changeMoveNumber(Number.MAX_SAFE_INTEGER)}})})),{dialogVisibilities:t,hasMessage:i,hasErrors:n}}});const Jc=(0,Kt.Z)(Yc,[["render",s]]);var $c=Jc;Do.kL.register(...Do.zX),Hi();const Xc=on();Promise.allSettled([gi().then((e=>{Xc.updateAppSetting(e)})).catch((e=>{Xc.pushError(new Error("アプリ設定の読み込み中にエラーが発生しました :"+e))})),async function(){const e=await li();e&&await Xc.openRecord(e)}()]).finally((()=>{(0,n.ri)($c).mount("#app")}))},5832:function(){}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}i.m=e,function(){var e=[];i.O=function(t,n,o,s){if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],s=e[u][2];for(var a=!0,c=0;c<n.length;c++)(!1&s||r>=s)&&Object.keys(i.O).every((function(e){return i.O[e](n[c])}))?n.splice(c--,1):(a=!1,s<r&&(r=s));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,o,s]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={826:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,r=n[0],a=n[1],c=n[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(c)var u=c(i)}for(t&&t(n);l<r.length;l++)s=r[l],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(u)},n=self["webpackChunkelectron_shogi"]=self["webpackChunkelectron_shogi"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(7818)}));n=i.O(n)})();
//# sourceMappingURL=index.efc67aab.js.map